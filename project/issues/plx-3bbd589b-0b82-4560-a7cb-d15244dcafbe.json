{
  "id": "plx-3bbd589b-0b82-4560-a7cb-d15244dcafbe",
  "title": "[Snyk] SNYK-JS-INFLIGHT-6095116 in inflight@1.0.6",
  "description": "## Missing Release of Resource after Effective Lifetime\n\n**Severity:** medium\n**Package:** inflight@1.0.6\n**File:** `dashboard/package.json`\n\n**CVSS Score:** 6.2  \n**Exploit Maturity:** proof-of-concept  \n**Snyk Priority Score:** 417/1000\n\n### CVEs\nNo CVE assigned.\n\n**Fix:** No automatic fix available. Review manually.\n\n### Details\n## Overview\n\nAffected versions of this package are vulnerable to Missing Release of Resource after Effective Lifetime via the `makeres` function due to improperly deleting keys from the `reqs` object after execution of callbacks. This behavior causes the keys to remain in the `reqs` object, which leads to resource exhaustion.\r\n\r\nExploiting this vulnerability results in crashing the `node` process or in the application crash.\r\n\r\n**Note:**\r\nThis library is not maintained, and currently, there is no fix for this issue. To overcome this vulnerability, several dependent packages have eliminated the use of this library.\r\n\r\nTo trigger the memory leak, an attacker would need to have the ability to execute or influence the asynchronous operations that use the inflight module within the application. This typically requires access to the internal workings of the server or application, which is not commonly exposed to remote users. Therefore, “Attack vector” is marked as “Local”.\n## PoC\n```js\r\nconst inflight = require('inflight');\r\n\r\nfunction testInflight() {\r\n  let i = 0;\r\n  function scheduleNext() {\r\n    let key = `key-${i++}`;\r\n    const callback = () => {\r\n    };\r\n    for (let j = 0; j < 1000000; j++) {\r\n      inflight(key, callback);\r\n    }\r\n\r\n    setImmediate(scheduleNext);\r\n  }\r\n\r\n\r\n  if (i % 100 === 0) {\r\n    console.log(process.memoryUsage());\r\n  }\r\n\r\n  scheduleNext();\r\n}\r\n\r\ntestInflight();\r\n```\n## Remediation\nThere is no fixed version for `inflight`.\n## References\n- [GitHub Issue](https://github.com/isaacs/inflight/issues/5)\n- [GitHub PR](https://github.com/logdna/logdna-agent/pull/157)\n\n\n### Reference\n- [Snyk advisory](https://security.snyk.io/vuln/SNYK-JS-INFLIGHT-6095116)",
  "type": "sub-task",
  "status": "open",
  "priority": 2,
  "assignee": null,
  "creator": null,
  "parent": "plx-8a96ada3-dfbc-4807-8f82-b4cfb6e4a52a",
  "labels": [
    "security",
    "snyk"
  ],
  "dependencies": [],
  "comments": [],
  "created_at": "2026-02-26T00:13:56.241127645Z",
  "updated_at": "2026-02-26T00:13:56.241127645Z",
  "closed_at": null,
  "custom": {
    "snyk_key": "SNYK-JS-INFLIGHT-6095116",
    "snyk_severity": "medium"
  }
}