"use strict";(self.webpackChunkaws_amplify_gen2=self.webpackChunkaws_amplify_gen2||[]).push([[2982],{"./node_modules/@aws-amplify/api/dist/esm/API.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>API_generateClient});const USER_AGENT_HEADER="x-amz-user-agent";var LogType;!function(LogType){LogType.DEBUG="DEBUG",LogType.ERROR="ERROR",LogType.INFO="INFO",LogType.WARN="WARN",LogType.VERBOSE="VERBOSE",LogType.NONE="NONE"}(LogType||(LogType={}));var console=__webpack_require__("./node_modules/console-browserify/index.js");const LOG_LEVELS={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class ConsoleLogger{constructor(name,level=LogType.WARN){this.name=name,this.level=level,this._pluggables=[]}_padding(n){return n<10?"0"+n:""+n}_ts(){const dt=new Date;return[this._padding(dt.getMinutes()),this._padding(dt.getSeconds())].join(":")+"."+dt.getMilliseconds()}configure(config){return config?(this._config=config,this._config):this._config}_log(type,...msg){let loggerLevelName=this.level;ConsoleLogger.LOG_LEVEL&&(loggerLevelName=ConsoleLogger.LOG_LEVEL),"undefined"!=typeof window&&window.LOG_LEVEL&&(loggerLevelName=window.LOG_LEVEL);if(!(LOG_LEVELS[type]>=LOG_LEVELS[loggerLevelName]))return;let log=console.log.bind(console);type===LogType.ERROR&&console.error&&(log=console.error.bind(console)),type===LogType.WARN&&console.warn&&(log=console.warn.bind(console)),ConsoleLogger.BIND_ALL_LOG_LEVELS&&(type===LogType.INFO&&console.info&&(log=console.info.bind(console)),type===LogType.DEBUG&&console.debug&&(log=console.debug.bind(console)));const prefix=`[${type}] ${this._ts()} ${this.name}`;let message="";if(1===msg.length&&"string"==typeof msg[0])message=`${prefix} - ${msg[0]}`,log(message);else if(1===msg.length)message=`${prefix} ${msg[0]}`,log(prefix,msg[0]);else if("string"==typeof msg[0]){let obj=msg.slice(1);1===obj.length&&(obj=obj[0]),message=`${prefix} - ${msg[0]} ${obj}`,log(`${prefix} - ${msg[0]}`,obj)}else message=`${prefix} ${msg}`,log(prefix,msg);for(const plugin of this._pluggables){const logEvent={message,timestamp:Date.now()};plugin.pushLogs([logEvent])}}log(...msg){this._log(LogType.INFO,...msg)}info(...msg){this._log(LogType.INFO,...msg)}warn(...msg){this._log(LogType.WARN,...msg)}error(...msg){this._log(LogType.ERROR,...msg)}debug(...msg){this._log(LogType.DEBUG,...msg)}verbose(...msg){this._log(LogType.VERBOSE,...msg)}addPluggable(pluggable){pluggable&&"Logging"===pluggable.getCategoryName()&&(this._pluggables.push(pluggable),pluggable.configure(this._config))}listPluggables(){return this._pluggables}}ConsoleLogger.LOG_LEVEL=null,ConsoleLogger.BIND_ALL_LOG_LEVELS=!1;class AmplifyError_AmplifyError extends Error{constructor({message,name,recoverySuggestion,underlyingError}){super(message),this.name=name,this.underlyingError=underlyingError,this.recoverySuggestion=recoverySuggestion,this.constructor=AmplifyError_AmplifyError,Object.setPrototypeOf(this,AmplifyError_AmplifyError.prototype)}}const AMPLIFY_SYMBOL="undefined"!=typeof Symbol?Symbol("amplify_default"):"@@amplify_default",Hub_logger=new ConsoleLogger("Hub");class HubClass{constructor(name){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=name}_remove(channel,listener){const holder=this.listeners.get(channel);holder?this.listeners.set(channel,[...holder.filter((({callback})=>callback!==listener))]):Hub_logger.warn(`No listeners for ${channel}`)}dispatch(channel,payload,source,ampSymbol){if("string"==typeof channel&&this.protectedChannels.indexOf(channel)>-1){ampSymbol===AMPLIFY_SYMBOL||Hub_logger.warn(`WARNING: ${channel} is protected and dispatching on it can have unintended consequences`)}const capsule={channel,payload:{...payload},source,patternInfo:[]};try{this._toListeners(capsule)}catch(e){Hub_logger.error(e)}}listen(channel,callback,listenerName="noname"){let cb;if("function"!=typeof callback)throw new AmplifyError_AmplifyError({name:"NoHubcallbackProvidedException",message:"No callback supplied to Hub"});cb=callback;let holder=this.listeners.get(channel);return holder||(holder=[],this.listeners.set(channel,holder)),holder.push({name:listenerName,callback:cb}),()=>{this._remove(channel,cb)}}_toListeners(capsule){const{channel,payload}=capsule,holder=this.listeners.get(channel);holder&&holder.forEach((listener=>{Hub_logger.debug(`Dispatching to ${channel} with `,payload);try{listener.callback(capsule)}catch(e){Hub_logger.error(e)}}))}}const Hub=new HubClass("__default__");new HubClass("internal-hub"),Symbol();function isFunction(value){return"function"==typeof value}function operate(init){return function(source){if(function hasLift(source){return isFunction(null==source?void 0:source.lift)}(source))return source.lift((function(liftedSource){try{return init(liftedSource,this)}catch(err){this.error(err)}}));throw new TypeError("Unable to lift unknown Observable type")}}var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var UnsubscriptionError=function createErrorClass(createImpl){var ctorFunc=createImpl((function(instance){Error.call(instance),instance.stack=(new Error).stack}));return ctorFunc.prototype=Object.create(Error.prototype),ctorFunc.prototype.constructor=ctorFunc,ctorFunc}((function(_super){return function UnsubscriptionErrorImpl(errors){_super(this),this.message=errors?errors.length+" errors occurred during unsubscription:\n"+errors.map((function(err,i){return i+1+") "+err.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=errors}}));function arrRemove(arr,item){if(arr){var index=arr.indexOf(item);0<=index&&arr.splice(index,1)}}var Subscription=function(){function Subscription(initialTeardown){this.initialTeardown=initialTeardown,this.closed=!1,this._parentage=null,this._finalizers=null}var empty;return Subscription.prototype.unsubscribe=function(){var e_1,_a,e_2,_b,errors;if(!this.closed){this.closed=!0;var _parentage=this._parentage;if(_parentage)if(this._parentage=null,Array.isArray(_parentage))try{for(var _parentage_1=(0,tslib_es6.Ju)(_parentage),_parentage_1_1=_parentage_1.next();!_parentage_1_1.done;_parentage_1_1=_parentage_1.next()){_parentage_1_1.value.remove(this)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_parentage_1_1&&!_parentage_1_1.done&&(_a=_parentage_1.return)&&_a.call(_parentage_1)}finally{if(e_1)throw e_1.error}}else _parentage.remove(this);var initialFinalizer=this.initialTeardown;if(isFunction(initialFinalizer))try{initialFinalizer()}catch(e){errors=e instanceof UnsubscriptionError?e.errors:[e]}var _finalizers=this._finalizers;if(_finalizers){this._finalizers=null;try{for(var _finalizers_1=(0,tslib_es6.Ju)(_finalizers),_finalizers_1_1=_finalizers_1.next();!_finalizers_1_1.done;_finalizers_1_1=_finalizers_1.next()){var finalizer=_finalizers_1_1.value;try{execFinalizer(finalizer)}catch(err){errors=null!=errors?errors:[],err instanceof UnsubscriptionError?errors=(0,tslib_es6.fX)((0,tslib_es6.fX)([],(0,tslib_es6.zs)(errors)),(0,tslib_es6.zs)(err.errors)):errors.push(err)}}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_finalizers_1_1&&!_finalizers_1_1.done&&(_b=_finalizers_1.return)&&_b.call(_finalizers_1)}finally{if(e_2)throw e_2.error}}}if(errors)throw new UnsubscriptionError(errors)}},Subscription.prototype.add=function(teardown){var _a;if(teardown&&teardown!==this)if(this.closed)execFinalizer(teardown);else{if(teardown instanceof Subscription){if(teardown.closed||teardown._hasParent(this))return;teardown._addParent(this)}(this._finalizers=null!==(_a=this._finalizers)&&void 0!==_a?_a:[]).push(teardown)}},Subscription.prototype._hasParent=function(parent){var _parentage=this._parentage;return _parentage===parent||Array.isArray(_parentage)&&_parentage.includes(parent)},Subscription.prototype._addParent=function(parent){var _parentage=this._parentage;this._parentage=Array.isArray(_parentage)?(_parentage.push(parent),_parentage):_parentage?[_parentage,parent]:parent},Subscription.prototype._removeParent=function(parent){var _parentage=this._parentage;_parentage===parent?this._parentage=null:Array.isArray(_parentage)&&arrRemove(_parentage,parent)},Subscription.prototype.remove=function(teardown){var _finalizers=this._finalizers;_finalizers&&arrRemove(_finalizers,teardown),teardown instanceof Subscription&&teardown._removeParent(this)},Subscription.EMPTY=((empty=new Subscription).closed=!0,empty),Subscription}();Subscription.EMPTY;function isSubscription(value){return value instanceof Subscription||value&&"closed"in value&&isFunction(value.remove)&&isFunction(value.add)&&isFunction(value.unsubscribe)}function execFinalizer(finalizer){isFunction(finalizer)?finalizer():finalizer.unsubscribe()}var config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},timeoutProvider={setTimeout:function(handler,timeout){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];var delegate=timeoutProvider.delegate;return(null==delegate?void 0:delegate.setTimeout)?delegate.setTimeout.apply(delegate,(0,tslib_es6.fX)([handler,timeout],(0,tslib_es6.zs)(args))):setTimeout.apply(void 0,(0,tslib_es6.fX)([handler,timeout],(0,tslib_es6.zs)(args)))},clearTimeout:function(handle){var delegate=timeoutProvider.delegate;return((null==delegate?void 0:delegate.clearTimeout)||clearTimeout)(handle)},delegate:void 0};function reportUnhandledError(err){timeoutProvider.setTimeout((function(){var onUnhandledError=config.onUnhandledError;if(!onUnhandledError)throw err;onUnhandledError(err)}))}function noop(){}var COMPLETE_NOTIFICATION=createNotification("C",void 0,void 0);function createNotification(kind,value,error){return{kind,value,error}}var context=null;var Subscriber=function(_super){function Subscriber(destination){var _this=_super.call(this)||this;return _this.isStopped=!1,destination?(_this.destination=destination,isSubscription(destination)&&destination.add(_this)):_this.destination=EMPTY_OBSERVER,_this}return(0,tslib_es6.C6)(Subscriber,_super),Subscriber.create=function(next,error,complete){return new SafeSubscriber(next,error,complete)},Subscriber.prototype.next=function(value){this.isStopped?handleStoppedNotification(function nextNotification(value){return createNotification("N",value,void 0)}(value),this):this._next(value)},Subscriber.prototype.error=function(err){this.isStopped?handleStoppedNotification(function errorNotification(error){return createNotification("E",void 0,error)}(err),this):(this.isStopped=!0,this._error(err))},Subscriber.prototype.complete=function(){this.isStopped?handleStoppedNotification(COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},Subscriber.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,_super.prototype.unsubscribe.call(this),this.destination=null)},Subscriber.prototype._next=function(value){this.destination.next(value)},Subscriber.prototype._error=function(err){try{this.destination.error(err)}finally{this.unsubscribe()}},Subscriber.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},Subscriber}(Subscription),_bind=Function.prototype.bind;function bind(fn,thisArg){return _bind.call(fn,thisArg)}var ConsumerObserver=function(){function ConsumerObserver(partialObserver){this.partialObserver=partialObserver}return ConsumerObserver.prototype.next=function(value){var partialObserver=this.partialObserver;if(partialObserver.next)try{partialObserver.next(value)}catch(error){handleUnhandledError(error)}},ConsumerObserver.prototype.error=function(err){var partialObserver=this.partialObserver;if(partialObserver.error)try{partialObserver.error(err)}catch(error){handleUnhandledError(error)}else handleUnhandledError(err)},ConsumerObserver.prototype.complete=function(){var partialObserver=this.partialObserver;if(partialObserver.complete)try{partialObserver.complete()}catch(error){handleUnhandledError(error)}},ConsumerObserver}(),SafeSubscriber=function(_super){function SafeSubscriber(observerOrNext,error,complete){var partialObserver,context_1,_this=_super.call(this)||this;isFunction(observerOrNext)||!observerOrNext?partialObserver={next:null!=observerOrNext?observerOrNext:void 0,error:null!=error?error:void 0,complete:null!=complete?complete:void 0}:_this&&config.useDeprecatedNextContext?((context_1=Object.create(observerOrNext)).unsubscribe=function(){return _this.unsubscribe()},partialObserver={next:observerOrNext.next&&bind(observerOrNext.next,context_1),error:observerOrNext.error&&bind(observerOrNext.error,context_1),complete:observerOrNext.complete&&bind(observerOrNext.complete,context_1)}):partialObserver=observerOrNext;return _this.destination=new ConsumerObserver(partialObserver),_this}return(0,tslib_es6.C6)(SafeSubscriber,_super),SafeSubscriber}(Subscriber);function handleUnhandledError(error){config.useDeprecatedSynchronousErrorHandling?function captureError(err){config.useDeprecatedSynchronousErrorHandling&&context&&(context.errorThrown=!0,context.error=err)}(error):reportUnhandledError(error)}function handleStoppedNotification(notification,subscriber){var onStoppedNotification=config.onStoppedNotification;onStoppedNotification&&timeoutProvider.setTimeout((function(){return onStoppedNotification(notification,subscriber)}))}var EMPTY_OBSERVER={closed:!0,next:noop,error:function defaultErrorHandler(err){throw err},complete:noop};function createOperatorSubscriber(destination,onNext,onComplete,onError,onFinalize){return new OperatorSubscriber(destination,onNext,onComplete,onError,onFinalize)}var OperatorSubscriber=function(_super){function OperatorSubscriber(destination,onNext,onComplete,onError,onFinalize,shouldUnsubscribe){var _this=_super.call(this,destination)||this;return _this.onFinalize=onFinalize,_this.shouldUnsubscribe=shouldUnsubscribe,_this._next=onNext?function(value){try{onNext(value)}catch(err){destination.error(err)}}:_super.prototype._next,_this._error=onError?function(err){try{onError(err)}catch(err){destination.error(err)}finally{this.unsubscribe()}}:_super.prototype._error,_this._complete=onComplete?function(){try{onComplete()}catch(err){destination.error(err)}finally{this.unsubscribe()}}:_super.prototype._complete,_this}return(0,tslib_es6.C6)(OperatorSubscriber,_super),OperatorSubscriber.prototype.unsubscribe=function(){var _a;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var closed_1=this.closed;_super.prototype.unsubscribe.call(this),!closed_1&&(null===(_a=this.onFinalize)||void 0===_a||_a.call(this))}},OperatorSubscriber}(Subscriber);function map(project,thisArg){return operate((function(source,subscriber){var index=0;source.subscribe(createOperatorSubscriber(subscriber,(function(value){subscriber.next(project.call(thisArg,value,index++))})))}))}function resolveOwnerFields(model){const ownerFields=new Set;for(const attr of model.attributes||[])if(isAuthAttribute(attr))for(const rule of attr.properties.rules)"owner"===rule.allow?ownerFields.add(rule.ownerField||"owner"):"groups"===rule.allow&&void 0!==rule.groupsField&&ownerFields.add(rule.groupsField);return Array.from(ownerFields)}function isAuthAttribute(attribute){return!("auth"!==attribute?.type||"object"!=typeof attribute?.properties||!Array.isArray(attribute?.properties?.rules))&&(attribute?.properties?.rules).every((rule=>!!rule.allow))}function capitalize(s){return`${s[0].toUpperCase()}${s.slice(1)}`}function selfAwareAsync(resolver){let resolve,reject;const resultPromise=new Promise(((res,rej)=>{resolve=res,reject=rej}));return resolver(resultPromise).then((result=>{resolve(result)})).catch((error=>{reject(error)})),resultPromise}const promiseMap=new WeakMap;function extendCancellability(existingCancellablePromise,newPromiseToRegister){return promiseMap.set(newPromiseToRegister,existingCancellablePromise),existingCancellablePromise.finally((()=>{promiseMap.delete(newPromiseToRegister)}))}const connectionType={HAS_ONE:"HAS_ONE",HAS_MANY:"HAS_MANY",BELONGS_TO:"BELONGS_TO"},skGraphQlFieldTypeMap={ID:"ID",String:"String",AWSDate:"String",AWSTime:"String",AWSDateTime:"String",AWSTimestamp:"Int",AWSEmail:"String",AWSPhone:"String",AWSURL:"String",AWSIPAddress:"String",AWSJSON:"String",Boolean:"Boolean",Int:"Int",Float:"Float"},resolvedSkName=sk=>1===sk.length?sk[0]:sk.reduce(((acc,curr,idx)=>0===idx?curr:acc+capitalize(curr)),""),flattenItems=(modelIntrospection,modelName,modelRecord)=>{if(!modelRecord)return null;const mapped={};for(const[fieldName,value]of Object.entries(modelRecord)){const fieldDef=modelName?modelIntrospection.models[modelName]?.fields[fieldName]:void 0,dvPair={fieldDef,value};dv=dvPair,"object"==typeof dv.fieldDef?.type&&"model"in dv.fieldDef.type&&"string"==typeof dv.fieldDef.type.model&&dv.fieldDef.isArray&&Array.isArray(dv.value?.items)?mapped[fieldName]=dvPair.value.items.map((itemValue=>flattenItems(modelIntrospection,dvPair.fieldDef.type.model,itemValue))):isRelatedModelProperty(fieldDef)?mapped[fieldName]=flattenItems(modelIntrospection,fieldDef.type.model,value):mapped[fieldName]=value}var dv;return mapped};function isRelatedModelProperty(fieldDef){return"object"==typeof fieldDef?.type&&"model"in fieldDef.type&&"string"==typeof fieldDef.type.model}function initializeModel(client,modelName,result,modelIntrospection,authMode,authToken,context=!1){const introModel=modelIntrospection.models[modelName],introModelFields=introModel.fields,modelFields=Object.entries(introModelFields).filter((([_,field])=>void 0!==field?.type?.model)).map((([fieldName])=>fieldName));return result.map((record=>{if(null==record)return record;const initializedRelationshipFields={};for(const fieldName of modelFields){const modelField=introModelFields[fieldName],modelFieldType=modelField?.type,relatedModelName=modelFieldType.model,relatedModel=modelIntrospection.models[relatedModelName],relatedModelPKFieldName=relatedModel.primaryKeyInfo.primaryKeyFieldName,relatedModelSKFieldNames=relatedModel.primaryKeyInfo.sortKeyFieldNames,relationType=modelField.association?.connectionType;let connectionFields=[];modelField.association&&"associatedWith"in modelField.association&&(connectionFields=modelField.association.associatedWith);const targetNames=[];switch(modelField.association&&"targetNames"in modelField.association&&targetNames.push(...modelField.association.targetNames),relationType){case connectionType.BELONGS_TO:{const sortKeyValues=relatedModelSKFieldNames.reduce(((acc,curVal)=>{if(record[curVal])return acc[curVal]=record[curVal]}),{});if(void 0===client.models[relatedModelName]?.get)break;initializedRelationshipFields[fieldName]=context?(contextSpec,options)=>record[targetNames[0]]?client.models[relatedModelName].get(contextSpec,{[relatedModelPKFieldName]:record[targetNames[0]],...sortKeyValues},{authMode:options?.authMode||authMode,authToken:options?.authToken||authToken}):{data:null}:options=>record[targetNames[0]]?client.models[relatedModelName].get({[relatedModelPKFieldName]:record[targetNames[0]],...sortKeyValues},{authMode:options?.authMode||authMode,authToken:options?.authToken||authToken}):{data:null};break}case connectionType.HAS_ONE:case connectionType.HAS_MANY:{const mapResult=relationType===connectionType.HAS_ONE?result=>({data:result?.data.shift()||null,errors:result.errors,extensions:result.extensions}):result=>result,parentPk=introModel.primaryKeyInfo.primaryKeyFieldName,parentSK=introModel.primaryKeyInfo.sortKeyFieldNames,relatedModelField=relatedModel.fields[connectionFields[0]];if(relatedModelField.type.model){let relatedTargetNames=[];relatedModelField.association&&"targetNames"in relatedModelField.association&&(relatedTargetNames=relatedModelField.association?.targetNames);const hasManyFilter=relatedTargetNames.map(((field,idx)=>0===idx?{[field]:{eq:record[parentPk]}}:{[field]:{eq:record[parentSK[idx-1]]}}));if(void 0===client.models[relatedModelName]?.list)break;initializedRelationshipFields[fieldName]=context?(contextSpec,options)=>record[parentPk]?selfAwareAsync((async resultPromise=>{const extendedBase=extendCancellability(client.models[relatedModelName].list(contextSpec,{filter:{and:hasManyFilter},limit:options?.limit,nextToken:options?.nextToken,authMode:options?.authMode||authMode,authToken:options?.authToken||authToken}),resultPromise);return mapResult(await extendedBase)})):[]:options=>record[parentPk]?selfAwareAsync((async resultPromise=>{const extendedBase=extendCancellability(client.models[relatedModelName].list({filter:{and:hasManyFilter},limit:options?.limit,nextToken:options?.nextToken,authMode:options?.authMode||authMode,authToken:options?.authToken||authToken}),resultPromise);return mapResult(await extendedBase)})):[];break}const hasManyFilter=connectionFields.map(((field,idx)=>0===idx?{[field]:{eq:record[parentPk]}}:{[field]:{eq:record[parentSK[idx-1]]}}));if(void 0===client.models[relatedModelName]?.list)break;initializedRelationshipFields[fieldName]=context?(contextSpec,options)=>record[parentPk]?selfAwareAsync((async resultPromise=>{const extendedBase=extendCancellability(client.models[relatedModelName].list(contextSpec,{filter:{and:hasManyFilter},limit:options?.limit,nextToken:options?.nextToken,authMode:options?.authMode||authMode,authToken:options?.authToken||authToken}),resultPromise);return mapResult(await extendedBase)})):[]:options=>record[parentPk]?selfAwareAsync((async resultPromise=>{const extendedBase=extendCancellability(client.models[relatedModelName].list({filter:{and:hasManyFilter},limit:options?.limit,nextToken:options?.nextToken,authMode:options?.authMode||authMode,authToken:options?.authToken||authToken}),resultPromise);return mapResult(await extendedBase)})):[];break}}}return{...record,...initializedRelationshipFields}}))}const graphQLOperationsInfo={CREATE:{operationPrefix:"create",usePlural:!1},GET:{operationPrefix:"get",usePlural:!1},UPDATE:{operationPrefix:"update",usePlural:!1},DELETE:{operationPrefix:"delete",usePlural:!1},LIST:{operationPrefix:"list",usePlural:!0},INDEX_QUERY:{operationPrefix:"",usePlural:!1},ONCREATE:{operationPrefix:"onCreate",usePlural:!1},ONUPDATE:{operationPrefix:"onUpdate",usePlural:!1},ONDELETE:{operationPrefix:"onDelete",usePlural:!1},OBSERVEQUERY:{operationPrefix:"observeQuery",usePlural:!1}},SELECTION_SET_WILDCARD="*",getDefaultSelectionSetForNonModelWithIR=(nonModelDefinition,modelIntrospection)=>{const{fields}=nonModelDefinition,mappedFields=Object.values(fields).map((({type,name})=>"string"==typeof type.enum?[name,FIELD_IR]:"string"==typeof type.nonModel?[name,getDefaultSelectionSetForNonModelWithIR(modelIntrospection.nonModels[type.nonModel],modelIntrospection)]:"string"==typeof type?[name,FIELD_IR]:void 0)).filter((pair=>void 0!==pair));return Object.fromEntries(mappedFields)},getDefaultSelectionSetForModelWithIR=(modelDefinition,modelIntrospection)=>{const{fields}=modelDefinition,mappedFields=Object.values(fields).map((({type,name})=>"string"==typeof type.enum||"string"==typeof type?[name,FIELD_IR]:"string"==typeof type.nonModel?[name,getDefaultSelectionSetForNonModelWithIR(modelIntrospection.nonModels[type.nonModel],modelIntrospection)]:void 0)).filter((pair=>void 0!==pair)),ownerFields=resolveOwnerFields(modelDefinition).map((field=>[field,FIELD_IR]));return Object.fromEntries(mappedFields.concat(ownerFields))};const FIELD_IR="";function customSelectionSetToIR(modelIntrospection,modelName,selectionSet){const dotNotationToObject=(path,modelOrNonModelName)=>{const[fieldName,...rest]=path.split("."),nested=rest[0],modelOrNonModelDefinition=modelIntrospection.models[modelOrNonModelName]??modelIntrospection.nonModels[modelOrNonModelName],modelOrNonModelFields=modelOrNonModelDefinition?.fields,relatedModel=modelOrNonModelFields?.[fieldName]?.type?.model,relatedModelDefinition=modelIntrospection.models[relatedModel],relatedNonModel=modelOrNonModelFields?.[fieldName]?.type?.nonModel,relatedNonModelDefinition=modelIntrospection.nonModels[relatedNonModel],isModelOrNonModelOrFieldType=relatedModelDefinition?"model":relatedNonModelDefinition?"nonModel":"field";if("nonModel"===isModelOrNonModelOrFieldType){let result={};if(!nested)throw Error(`${fieldName} must declare a wildcard (*) or a field of custom type ${relatedNonModel}`);return result=nested===SELECTION_SET_WILDCARD?{[fieldName]:getDefaultSelectionSetForNonModelWithIR(relatedNonModelDefinition,modelIntrospection)}:{[fieldName]:dotNotationToObject(rest.join("."),relatedNonModel)},result}if("model"===isModelOrNonModelOrFieldType){let result={};if(!nested)throw Error(`${fieldName} must declare a wildcard (*) or a field of model ${relatedModel}`);if(nested===SELECTION_SET_WILDCARD){const nestedRelatedModelDefinition=modelIntrospection.models[relatedModel];result={[fieldName]:getDefaultSelectionSetForModelWithIR(nestedRelatedModelDefinition,modelIntrospection)}}else result={[fieldName]:dotNotationToObject(rest.join("."),relatedModel)};return modelOrNonModelFields[fieldName]?.isArray&&(result={[fieldName]:{items:result[fieldName]}}),result}{const modelField=modelOrNonModelFields?.[fieldName],nonModelDefinition=modelIntrospection.nonModels[modelOrNonModelName],nonModelField=nonModelDefinition?.fields?.[fieldName];if(nonModelDefinition){if(!nonModelField)throw Error(`${fieldName} is not a field of custom type ${modelOrNonModelName}`)}else{const isOwnerField=resolveOwnerFields(modelOrNonModelDefinition).includes(fieldName);if(!modelField&&!isOwnerField)throw Error(`${fieldName} is not a field of model ${modelOrNonModelName}`)}return{[fieldName]:FIELD_IR}}};return selectionSet.reduce(((resultObj,path)=>deepMergeSelectionSetObjects(dotNotationToObject(path,modelName),resultObj)),{})}function selectionSetIRToString(obj){const res=[];return Object.entries(obj).forEach((([fieldName,value])=>{value===FIELD_IR?res.push(fieldName):"object"==typeof value&&null!==value&&(value?.items?res.push(fieldName,"{","items","{",selectionSetIRToString(value.items),"}","}"):res.push(fieldName,"{",selectionSetIRToString(value),"}"))})),res.join(" ")}function deepMergeSelectionSetObjects(source,target){for(const key in source)Object.prototype.hasOwnProperty.call(source,key)&&(Object.prototype.hasOwnProperty.call(target,key)&&((obj=target[key])&&"object"==typeof obj)?deepMergeSelectionSetObjects(source[key],target[key]):target[key]=source[key]);var obj;return target}function generateSelectionSet(modelIntrospection,modelName,selectionSet){const modelDefinition=modelIntrospection.models[modelName],selSetIr=customSelectionSetToIR(modelIntrospection,modelName,selectionSet??function defaultSelectionSetForModel(modelDefinition){const{fields}=modelDefinition,explicitFields=Object.values(fields).map((({type,name})=>{if("string"==typeof type)return name;if("object"==typeof type){if("string"==typeof type?.enum)return name;if("string"==typeof type?.nonModel)return`${name}.${SELECTION_SET_WILDCARD}`}})).filter(Boolean),ownerFields=resolveOwnerFields(modelDefinition);return Array.from(new Set(explicitFields.concat(ownerFields)))}(modelDefinition));return selectionSetIRToString(selSetIr)}function generateGraphQLDocument(modelIntrospection,modelName,modelOperation,listArgs,indexMeta){const modelDefinition=modelIntrospection.models[modelName],{name,pluralName,fields,primaryKeyInfo:{isCustomPrimaryKey,primaryKeyFieldName,sortKeyFieldNames},attributes}=modelDefinition,namePascalCase=name.charAt(0).toUpperCase()+name.slice(1),pluralNamePascalCase=pluralName.charAt(0).toUpperCase()+pluralName.slice(1),{operationPrefix,usePlural}=graphQLOperationsInfo[modelOperation],{selectionSet}=listArgs||{};let graphQLFieldName,indexQueryArgs,graphQLOperationType,graphQLSelectionSet,graphQLArguments;if(operationPrefix)graphQLFieldName=`${operationPrefix}${usePlural?pluralNamePascalCase:namePascalCase}`;else{if(!indexMeta)throw new Error("Error generating GraphQL Document - invalid operation name");{const{queryField,pk,sk=[]}=indexMeta;graphQLFieldName=queryField;let skQueryArgs={};if(1===sk.length){const[skField]=sk,type="string"==typeof fields[skField].type?fields[skField].type:"String",normalizedType=skGraphQlFieldTypeMap[type];skQueryArgs={[skField]:`Model${normalizedType}KeyConditionInput`}}else if(sk.length>1){const compositeSkArgName=resolvedSkName(sk),keyName=attributes?.find((attr=>attr?.properties?.queryField===queryField))?.properties?.name;skQueryArgs={[compositeSkArgName]:`Model${capitalize(modelName)}${capitalize(keyName)}CompositeKeyConditionInput`}}indexQueryArgs={[pk]:`${Object.prototype.hasOwnProperty.call(fields[pk].type,"enum")?fields[pk].type.enum:fields[pk].type}!`,...skQueryArgs}}}const selectionSetFields=generateSelectionSet(modelIntrospection,modelName,selectionSet),getPkArgs={[primaryKeyFieldName]:`${fields[primaryKeyFieldName].type}!`},listPkArgs={},generateSkArgs=op=>{if(0===sortKeyFieldNames.length)return{};if("get"===op)return sortKeyFieldNames.reduce(((acc,fieldName)=>{const fieldType=fields[fieldName].type;return"get"===op&&(acc[fieldName]=`${fieldType}!`),acc}),{});if(1===sortKeyFieldNames.length){const[sk]=sortKeyFieldNames,type="string"==typeof fields[sk].type?fields[sk].type:"String",normalizedType=skGraphQlFieldTypeMap[type];return{[sk]:`Model${normalizedType}KeyConditionInput`}}{const compositeSkArgName=resolvedSkName(sortKeyFieldNames);return{[compositeSkArgName]:`Model${capitalize(modelName)}PrimaryCompositeKeyConditionInput`}}};switch(isCustomPrimaryKey&&(Object.assign(getPkArgs,generateSkArgs("get")),Object.assign(listPkArgs,{[primaryKeyFieldName]:`${fields[primaryKeyFieldName].type}`,sortDirection:"ModelSortDirection"},generateSkArgs("list"))),modelOperation){case"CREATE":case"UPDATE":case"DELETE":graphQLArguments??(graphQLArguments={input:`${operationPrefix.charAt(0).toLocaleUpperCase()+operationPrefix.slice(1)}${namePascalCase}Input!`}),graphQLOperationType??(graphQLOperationType="mutation");case"GET":graphQLArguments??(graphQLArguments=getPkArgs),graphQLSelectionSet??(graphQLSelectionSet=selectionSetFields);case"LIST":graphQLArguments??(graphQLArguments={...listPkArgs,filter:`Model${namePascalCase}FilterInput`,limit:"Int",nextToken:"String"}),graphQLOperationType??(graphQLOperationType="query"),graphQLSelectionSet??(graphQLSelectionSet=`items { ${selectionSetFields} } nextToken __typename`);case"INDEX_QUERY":graphQLArguments??(graphQLArguments={...indexQueryArgs,filter:`Model${namePascalCase}FilterInput`,sortDirection:"ModelSortDirection",limit:"Int",nextToken:"String"}),graphQLOperationType??(graphQLOperationType="query"),graphQLSelectionSet??(graphQLSelectionSet=`items { ${selectionSetFields} } nextToken __typename`);case"ONCREATE":case"ONUPDATE":case"ONDELETE":graphQLArguments??(graphQLArguments={filter:`ModelSubscription${namePascalCase}FilterInput`}),graphQLOperationType??(graphQLOperationType="subscription"),graphQLSelectionSet??(graphQLSelectionSet=selectionSetFields);break;default:throw new Error("Internal error: Attempted to generate graphql document for observeQuery. Please report this error.")}return`${graphQLOperationType}${graphQLArguments?`(${Object.entries(graphQLArguments).map((([fieldName,type])=>`$${fieldName}: ${type}`))})`:""} { ${graphQLFieldName}${graphQLArguments?`(${Object.keys(graphQLArguments).map((fieldName=>`${fieldName}: $${fieldName}`))})`:""} { ${graphQLSelectionSet} } }`}function buildGraphQLVariables(modelDefinition,operation,arg,modelIntrospection,indexMeta){const{fields,primaryKeyInfo:{isCustomPrimaryKey,primaryKeyFieldName,sortKeyFieldNames}}=modelDefinition,skName=sortKeyFieldNames?.length&&resolvedSkName(sortKeyFieldNames);let variables={};switch(operation){case"CREATE":variables={input:arg?normalizeMutationInput(arg,modelDefinition,modelIntrospection):{}};break;case"UPDATE":variables={input:arg?Object.fromEntries(Object.entries(normalizeMutationInput(arg,modelDefinition,modelIntrospection)).filter((([fieldName])=>{const{isReadOnly}=fields[fieldName];return!isReadOnly}))):{}};break;case"GET":case"DELETE":arg&&(variables=isCustomPrimaryKey?[primaryKeyFieldName,...sortKeyFieldNames].reduce(((acc,fieldName)=>(acc[fieldName]=arg[fieldName],acc)),{}):{[primaryKeyFieldName]:arg[primaryKeyFieldName]}),"DELETE"===operation&&(variables={input:variables});break;case"LIST":arg?.filter&&(variables.filter=arg.filter),arg?.sortDirection&&(variables.sortDirection=arg.sortDirection),arg&&arg[primaryKeyFieldName]&&(variables[primaryKeyFieldName]=arg[primaryKeyFieldName]),skName&&arg&&arg[skName]&&(variables[skName]=arg[skName]),arg?.nextToken&&(variables.nextToken=arg.nextToken),arg?.limit&&(variables.limit=arg.limit);break;case"INDEX_QUERY":{const{pk,sk=[]}=indexMeta,indexQuerySkName=sk?.length&&resolvedSkName(sk);variables[pk]=arg[pk],indexQuerySkName&&arg&&arg[indexQuerySkName]&&(variables[indexQuerySkName]=arg[indexQuerySkName]),arg?.filter&&(variables.filter=arg.filter),arg?.sortDirection&&(variables.sortDirection=arg.sortDirection),arg?.nextToken&&(variables.nextToken=arg.nextToken),arg?.limit&&(variables.limit=arg.limit);break}case"ONCREATE":case"ONUPDATE":case"ONDELETE":arg?.filter&&(variables={filter:arg.filter});break;case"OBSERVEQUERY":throw new Error("Internal error: Attempted to build variables for observeQuery. Please report this error.");default:throw new Error(`Unhandled operation case: ${operation}`)}return variables}function normalizeMutationInput(mutationInput,model,modelIntrospection){const{fields}=model,normalized={};return Object.entries(mutationInput).forEach((([inputFieldName,inputValue])=>{const fieldType=fields[inputFieldName]?.type,relatedModelName=fieldType?.model;if(relatedModelName){const association=fields[inputFieldName]?.association,relatedModelPkInfo=modelIntrospection.models[relatedModelName].primaryKeyInfo;if(association?.connectionType===connectionType.HAS_ONE){const associationHasOne=association;associationHasOne.targetNames.forEach(((targetName,idx)=>{const associatedFieldName=associationHasOne.associatedWith[idx];normalized[targetName]=inputValue[associatedFieldName]}))}if(association?.connectionType===connectionType.BELONGS_TO){association.targetNames.forEach(((targetName,idx)=>{if(0===idx){const associatedFieldName=relatedModelPkInfo.primaryKeyFieldName;normalized[targetName]=inputValue[associatedFieldName]}else{const associatedFieldName=relatedModelPkInfo.sortKeyFieldNames[idx-1];normalized[targetName]=inputValue[associatedFieldName]}}))}}else normalized[inputFieldName]=inputValue})),normalized}function authModeParams(client,getInternals,options={}){const internals=getInternals(client);return{authMode:options.authMode||internals.authMode,authToken:options.authToken||internals.authToken}}function getCustomHeaders(client,getInternals,requestHeaders){let headers=getInternals(client).headers||{};return requestHeaders&&(headers=requestHeaders),headers}function handleListGraphQlError(error){if(error?.errors)return{...error,data:[]};throw error}function handleSingularGraphQlError(error){if(error.errors)return{...error,data:null};throw error}const INTERNAL_USER_AGENT_OVERRIDE=Symbol("INTERNAL_USER_AGENT_OVERRIDE");var AiAction;!function(AiAction){AiAction.CreateConversation="1",AiAction.GetConversation="2",AiAction.ListConversations="3",AiAction.DeleteConversation="4",AiAction.SendMessage="5",AiAction.ListMessages="6",AiAction.OnStreamEvent="7",AiAction.Generation="8",AiAction.UpdateConversation="9"}(AiAction||(AiAction={}));const getCustomUserAgentDetails=action=>({category:"ai",action});function createUserAgentOverride(customUserAgentDetails){return customUserAgentDetails?{[INTERNAL_USER_AGENT_OVERRIDE]:customUserAgentDetails}:void 0}const argIsContextSpec=arg=>"symbol"==typeof arg?.token?.value;function customOpFactory(client,modelIntrospection,operationType,operation,useContext,getInternals,customUserAgentDetails){const argsDefined=void 0!==operation.arguments;return(...args)=>{const options=args[args.length-1];let contextSpec,arg;if(useContext){if(!argIsContextSpec(args[0]))throw new Error(`Invalid first argument passed to ${operation.name}. Expected contextSpec`);contextSpec=args[0]}return argsDefined&&(arg=useContext?args[1]:args[0]),"subscription"===operationType?function _opSubscription(client,modelIntrospection,operation,getInternals,args,options,customUserAgentDetails){const operationType="subscription",{name:operationName}=operation,auth=authModeParams(client,getInternals,options),headers=getCustomHeaders(client,getInternals,options?.headers),outerArgsString=outerArguments(operation),innerArgsString=innerArguments(operation),selectionSet=operationSelectionSet(modelIntrospection,operation),returnTypeModelName=hasStringField(operation.type,"model")?operation.type.model:void 0,query=`\n    ${operationType.toLocaleLowerCase()}${outerArgsString} {\n      ${operationName}${innerArgsString} ${selectionSet}\n    }\n  `,variables=operationVariables(operation,args),userAgentOverride=createUserAgentOverride(customUserAgentDetails),observable=client.graphql({...auth,query,variables,...userAgentOverride},headers);return observable.pipe(map((value=>{const[key]=Object.keys(value.data),data=value.data[key],[initialized]=returnTypeModelName?initializeModel(client,returnTypeModelName,[data],modelIntrospection,auth.authMode,auth.authToken):[data];return initialized})))}(client,modelIntrospection,operation,getInternals,arg,options,customUserAgentDetails):function _op(client,modelIntrospection,operationType,operation,getInternals,args,options,context,customUserAgentDetails){return selfAwareAsync((async resultPromise=>{const{name:operationName}=operation,auth=authModeParams(client,getInternals,options),headers=getCustomHeaders(client,getInternals,options?.headers),outerArgsString=outerArguments(operation),innerArgsString=innerArguments(operation),selectionSet=operationSelectionSet(modelIntrospection,operation),returnTypeModelName=hasStringField(operation.type,"model")?operation.type.model:void 0,query=`\n    ${operationType.toLocaleLowerCase()}${outerArgsString} {\n      ${operationName}${innerArgsString} ${selectionSet}\n    }\n  `,variables=operationVariables(operation,args),userAgentOverride=createUserAgentOverride(customUserAgentDetails);try{const extendedPromise=extendCancellability(context?client.graphql(context,{...auth,query,variables},headers):client.graphql({...auth,query,variables,...userAgentOverride},headers),resultPromise),{data,extensions}=await extendedPromise;if(data){const[key]=Object.keys(data),isArrayResult=Array.isArray(data[key]),flattenedResult=isArrayResult?data[key].filter((x=>x)):data[key],initialized=returnTypeModelName?initializeModel(client,returnTypeModelName,isArrayResult?flattenedResult:[flattenedResult],modelIntrospection,auth.authMode,auth.authToken,!!context):flattenedResult;return{data:!isArrayResult&&Array.isArray(initialized)?initialized.shift():initialized,extensions}}return{data:null,extensions}}catch(error){const{data,errors}=error;if(data&&0!==Object.keys(data).length&&errors){const[key]=Object.keys(data),isArrayResult=Array.isArray(data[key]),flattenedResult=isArrayResult?data[key].filter((x=>x)):data[key];if(flattenedResult){const initialized=returnTypeModelName?initializeModel(client,returnTypeModelName,isArrayResult?flattenedResult:[flattenedResult],modelIntrospection,auth.authMode,auth.authToken,!!context):flattenedResult;return{data:!isArrayResult&&Array.isArray(initialized)?initialized.shift():initialized,errors}}return handleSingularGraphQlError(error)}return handleSingularGraphQlError(error)}}))}(client,modelIntrospection,operationType,operation,getInternals,arg,options,contextSpec,customUserAgentDetails)}}function hasStringField(o,field){return"string"==typeof o[field]}function argumentBaseTypeString({type,isRequired}){const requiredFlag=isRequired?"!":"";return function isEnumType(type){return type instanceof Object&&"enum"in type}(type)?`${type.enum}${requiredFlag}`:function isInputType(type){return type instanceof Object&&"input"in type}(type)?`${type.input}${requiredFlag}`:`${type}${requiredFlag}`}function outerArguments(operation){if(void 0===operation.arguments)return"";const args=Object.entries(operation.arguments).map((([k,argument])=>{const baseType=argumentBaseTypeString(argument);return`$${k}: ${argument.isArray?`[${baseType}]${argument.isArrayNullable?"":"!"}`:baseType}`})).join(", ");return args.length>0?`(${args})`:""}function innerArguments(operation){if(void 0===operation.arguments)return"";const args=Object.keys(operation.arguments).map((k=>`${k}: $${k}`)).join(", ");return args.length>0?`(${args})`:""}function operationSelectionSet(modelIntrospection,operation){if(hasStringField(operation,"type")||hasStringField(operation.type,"enum"))return"";if(hasStringField(operation.type,"nonModel")){const nonModel=modelIntrospection.nonModels[operation.type.nonModel];return`{${selectionSetIRToString(getDefaultSelectionSetForNonModelWithIR(nonModel,modelIntrospection))}}`}return hasStringField(operation.type,"model")?`{${generateSelectionSet(modelIntrospection,operation.type.model)}}`:""}function operationVariables(operation,args={}){const variables={};if(void 0===operation.arguments)return variables;for(const argDef of Object.values(operation.arguments))if(void 0!==args[argDef.name])variables[argDef.name]=args[argDef.name];else if(argDef.isRequired)throw new Error(`${operation.name} requires arguments '${argDef.name}'`);return variables}const operationTypeMap={queries:"query",mutations:"mutation",subscriptions:"subscription"};function generateCustomOperationsProperty(client,config,operationsType,getInternals){if(!config)return{};const modelIntrospection=config.modelIntrospection;if(!modelIntrospection)return{};const operations=modelIntrospection[operationsType];if(!operations)return{};const ops={},useContext=null===getInternals(client).amplify;for(const operation of Object.values(operations))ops[operation.name]=customOpFactory(client,modelIntrospection,operationTypeMap[operationsType],operation,useContext,getInternals);return ops}function get_getFactory(client,modelIntrospection,model,operation,getInternals,useContext=!1,customUserAgentDetails){return useContext?(contextSpec,arg,options)=>_get(client,modelIntrospection,model,arg,options,operation,getInternals,contextSpec,customUserAgentDetails):(arg,options)=>_get(client,modelIntrospection,model,arg,options,operation,getInternals,void 0,customUserAgentDetails)}function _get(client,modelIntrospection,model,arg,options,operation,getInternals,context,customUserAgentDetails){return selfAwareAsync((async resultPromise=>{const{name}=model,query=generateGraphQLDocument(modelIntrospection,name,operation,options),variables=buildGraphQLVariables(model,operation,arg,modelIntrospection),auth=authModeParams(client,getInternals,options),headers=getCustomHeaders(client,getInternals,options?.headers),userAgentOverride=createUserAgentOverride(customUserAgentDetails);try{const extendedPromise=extendCancellability(context?client.graphql(context,{...auth,query,variables},headers):client.graphql({...auth,query,variables,...userAgentOverride},headers),resultPromise),{data,extensions}=await extendedPromise;if(data){const[key]=Object.keys(data),flattenedResult=flattenItems(modelIntrospection,name,data[key]);if(null===flattenedResult)return{data:null,extensions};if(options?.selectionSet)return{data:flattenedResult,extensions};{const[initialized]=initializeModel(client,name,[flattenedResult],modelIntrospection,auth.authMode,auth.authToken,!!context);return{data:initialized,extensions}}}return{data:null,extensions}}catch(error){const{data,errors}=error;if(data&&0!==Object.keys(data).length&&errors){const[key]=Object.keys(data),flattenedResult=flattenItems(modelIntrospection,name,data[key]);if(flattenedResult){if(options?.selectionSet)return{data:flattenedResult,errors};{const[initialized]=initializeModel(client,name,[flattenedResult],modelIntrospection,auth.authMode,auth.authToken,!!context);return{data:initialized,errors}}}return handleSingularGraphQlError(error)}return handleSingularGraphQlError(error)}}))}function list_listFactory(client,modelIntrospection,model,getInternals,context=!1,customUserAgentDetails){return context?(contextSpec,args)=>_list(client,modelIntrospection,model,getInternals,args,contextSpec,customUserAgentDetails):args=>_list(client,modelIntrospection,model,getInternals,args,void 0,customUserAgentDetails)}function _list(client,modelIntrospection,model,getInternals,args,contextSpec,customUserAgentDetails){return selfAwareAsync((async resultPromise=>{const{name}=model,query=generateGraphQLDocument(modelIntrospection,name,"LIST",args),variables=buildGraphQLVariables(model,"LIST",args,modelIntrospection),auth=authModeParams(client,getInternals,args),headers=getCustomHeaders(client,getInternals,args?.headers),userAgentOverride=createUserAgentOverride(customUserAgentDetails);try{const extendedPromise=extendCancellability(contextSpec?client.graphql(contextSpec,{...auth,query,variables},headers):client.graphql({...auth,query,variables,...userAgentOverride},headers),resultPromise),{data,extensions}=await extendedPromise;if(void 0!==data){const[key]=Object.keys(data);if(data[key].items){const flattenedResult=data[key].items.map((value=>flattenItems(modelIntrospection,name,value)));if(args?.selectionSet)return{data:flattenedResult,nextToken:data[key].nextToken,extensions};return{data:initializeModel(client,name,flattenedResult,modelIntrospection,auth.authMode,auth.authToken,!!contextSpec),nextToken:data[key].nextToken,extensions}}return{data:data[key],nextToken:data[key].nextToken,extensions}}}catch(error){const{data,errors}=error;if(null!=data&&0!==Object.keys(data).length&&errors){const[key]=Object.keys(data);if(data[key]?.items){const flattenedResult=data[key].items.map((value=>flattenItems(modelIntrospection,name,value)));if(flattenedResult){if(args?.selectionSet)return{data:flattenedResult,nextToken:data[key]?.nextToken,errors};return{data:initializeModel(client,name,flattenedResult,modelIntrospection,auth.authMode,auth.authToken,!!contextSpec),nextToken:data[key]?.nextToken,errors}}return{data:data[key],nextToken:data[key]?.nextToken,errors}}return handleListGraphQlError(error)}return handleListGraphQlError(error)}}))}const alphabetByEncoding={},alphabetByValue=new Array(64);for(let i=0,start="A".charCodeAt(0),limit="Z".charCodeAt(0);i+start<=limit;i++){const char=String.fromCharCode(i+start);alphabetByEncoding[char]=i,alphabetByValue[i]=char}for(let i=0,start="a".charCodeAt(0),limit="z".charCodeAt(0);i+start<=limit;i++){const char=String.fromCharCode(i+start),index=i+26;alphabetByEncoding[char]=index,alphabetByValue[index]=char}for(let i=0;i<10;i++){alphabetByEncoding[i.toString(10)]=i+52;const char=i.toString(10),index=i+52;alphabetByEncoding[char]=index,alphabetByValue[index]=char}alphabetByEncoding["+"]=62,alphabetByValue[62]="+",alphabetByEncoding["/"]=63,alphabetByValue[63]="/";const fromBase64=input=>{let totalByteLength=input.length/4*3;"=="===input.slice(-2)?totalByteLength-=2:"="===input.slice(-1)&&totalByteLength--;const out=new ArrayBuffer(totalByteLength),dataView=new DataView(out);for(let i=0;i<input.length;i+=4){let bits=0,bitLength=0;for(let j=i,limit=i+3;j<=limit;j++)if("="!==input[j]){if(!(input[j]in alphabetByEncoding))throw new TypeError(`Invalid character ${input[j]} in base64 string.`);bits|=alphabetByEncoding[input[j]]<<6*(limit-j),bitLength+=6}else bits>>=6;const chunkOffset=i/4*3;bits>>=bitLength%8;const byteLength=Math.floor(bitLength/8);for(let k=0;k<byteLength;k++){const offset=8*(byteLength-k-1);dataView.setUint8(chunkOffset+k,(bits&255<<offset)>>offset)}}return new Uint8Array(out)};function toBase64(_input){let input;input="string"==typeof _input?(input=>(new TextEncoder).encode(input))(_input):_input;const isArrayLike="object"==typeof input&&"number"==typeof input.length,isUint8Array="object"==typeof input&&"number"==typeof input.byteOffset&&"number"==typeof input.byteLength;if(!isArrayLike&&!isUint8Array)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let str="";for(let i=0;i<input.length;i+=3){let bits=0,bitLength=0;for(let j=i,limit=Math.min(i+3,input.length);j<limit;j++)bits|=input[j]<<8*(limit-j-1),bitLength+=8;const bitClusterCount=Math.ceil(bitLength/6);bits<<=6*bitClusterCount-bitLength;for(let k=1;k<=bitClusterCount;k++){const offset=6*(bitClusterCount-k);str+=alphabetByValue[(bits&63<<offset)>>offset]}str+="==".slice(0,4-bitClusterCount)}return str}const deserializeContent=content=>content.map((block=>block.image?deserializeImageBlock(block):block.toolUse?deserializeToolUseBlock(block):block.toolResult?deserializeToolResultBlock(block):removeNullsFromBlock(block))),deserializeImageBlock=({image})=>({image:{...image,source:{...image.source,bytes:fromBase64(image.source.bytes)}}}),deserializeToolUseBlock=({toolUse})=>({toolUse:{...toolUse,input:JSON.parse(toolUse.input)}}),deserializeToolResultBlock=({toolResult})=>({toolResult:{toolUseId:toolResult.toolUseId,content:toolResult.content.map((toolResultBlock=>toolResultBlock.image?deserializeImageBlock(toolResultBlock):toolResultBlock.json?(({json})=>({json:JSON.parse(json)}))(toolResultBlock):removeNullsFromBlock(toolResultBlock)))}}),removeNullsFromBlock=block=>Object.fromEntries(Object.entries(block).filter((([_,v])=>null!==v))),convertItemToConversationMessage=({content,createdAt,id,conversationId,role})=>({content:deserializeContent(content??[]),conversationId,createdAt,id,role}),createListMessagesFunction=(client,modelIntrospection,conversationId,conversationMessageModel,getInternals)=>async input=>{const list=list_listFactory(client,modelIntrospection,conversationMessageModel,getInternals,!1,getCustomUserAgentDetails(AiAction.ListMessages)),{data,nextToken,errors}=await list({...input,filter:{conversationId:{eq:conversationId}}});return{data:data.map((item=>convertItemToConversationMessage(item))),nextToken,errors}},conversationStreamEventDeserializers_deserializeToolUseBlock=contentBlockToolUse=>{if(contentBlockToolUse){return{...contentBlockToolUse,input:JSON.parse(contentBlockToolUse.input)}}},removeNullsFromConversationStreamEvent=block=>Object.fromEntries(Object.entries(block).filter((([_,v])=>null!==v))),createOnStreamEventFunction=(client,modelIntrospection,conversationId,conversationRouteName,getInternals)=>handler=>{const{conversations}=modelIntrospection;if(!conversations)return{};const subscribeSchema=conversations[conversationRouteName].message.subscribe;return customOpFactory(client,modelIntrospection,"subscription",subscribeSchema,!1,getInternals,getCustomUserAgentDetails(AiAction.OnStreamEvent))({conversationId}).subscribe((data=>{const{next,error}=(({id,conversationId,associatedUserMessageId,contentBlockIndex,contentBlockDoneAtIndex,contentBlockDeltaIndex,contentBlockText,contentBlockToolUse,stopReason,errors})=>{if(errors)return{error:{id,conversationId,associatedUserMessageId,errors}};return{next:removeNullsFromConversationStreamEvent({id,conversationId,associatedUserMessageId,contentBlockIndex,contentBlockDoneAtIndex,contentBlockDeltaIndex,text:contentBlockText,toolUse:conversationStreamEventDeserializers_deserializeToolUseBlock(contentBlockToolUse),stopReason})}})(data);error&&handler.error(error),next&&handler.next(next)}))},serializeAiContext=aiContext=>JSON.stringify(aiContext),serializeContent=content=>content.map((block=>block.image?serializeImageBlock(block):block.toolResult?serializeToolResultBlock(block):block)),serializeToolConfiguration=({tools})=>({tools:Object.entries(tools).map((([name,tool])=>({toolSpec:{name,description:tool.description,inputSchema:{json:JSON.stringify(tool.inputSchema.json)}}})))}),serializeImageBlock=({image})=>({image:{...image,source:{...image.source,bytes:toBase64(image.source.bytes)}}}),serializeToolResultBlock=({toolResult})=>({toolResult:{...toolResult,content:toolResult.content.map((toolResultBlock=>toolResultBlock.image?serializeImageBlock(toolResultBlock):toolResultBlock.json?(({json})=>({json:JSON.stringify(json)}))(toolResultBlock):toolResultBlock))}}),createSendMessageFunction=(client,modelIntrospection,conversationId,conversationRouteName,getInternals)=>async input=>{const{conversations}=modelIntrospection;if(!conversations)return{};const processedInput="string"==typeof input?{content:[{text:input}]}:input,{content,aiContext,toolConfiguration}=processedInput,sendSchema=conversations[conversationRouteName].message.send,sendOperation=customOpFactory(client,modelIntrospection,"mutation",sendSchema,!1,getInternals,getCustomUserAgentDetails(AiAction.SendMessage)),{data,errors}=await sendOperation({conversationId,content:serializeContent(content),...aiContext&&{aiContext:serializeAiContext(aiContext)},...toolConfiguration&&{toolConfiguration:serializeToolConfiguration(toolConfiguration)}});return{data:data?convertItemToConversationMessage(data):data,errors}},convertItemToConversation=(client,modelIntrospection,conversationId,conversationCreatedAt,conversationUpdatedAt,conversationRouteName,conversationMessageModel,getInternals,conversationMetadata,conversationName)=>{if(!conversationId)throw new Error(`An error occurred converting a ${conversationRouteName} conversation: Missing ID`);return{id:conversationId,createdAt:conversationCreatedAt,updatedAt:conversationUpdatedAt,metadata:conversationMetadata,name:conversationName,onStreamEvent:createOnStreamEventFunction(client,modelIntrospection,conversationId,conversationRouteName,getInternals),sendMessage:createSendMessageFunction(client,modelIntrospection,conversationId,conversationRouteName,getInternals),listMessages:createListMessagesFunction(client,modelIntrospection,conversationId,conversationMessageModel,getInternals)}},createCreateConversationFunction=(client,modelIntrospection,conversationRouteName,conversationModel,conversationMessageModel,getInternals)=>async input=>{const{name,metadata:metadataObject}=input??{},metadata=JSON.stringify(metadataObject),createOperation=get_getFactory(client,modelIntrospection,conversationModel,"CREATE",getInternals,!1,getCustomUserAgentDetails(AiAction.CreateConversation)),{data,errors}=await createOperation({name,metadata});return{data:convertItemToConversation(client,modelIntrospection,data?.id,data?.createdAt,data?.updatedAt,conversationRouteName,conversationMessageModel,getInternals,data?.metadata,data?.name),errors}},createGetConversationFunction=(client,modelIntrospection,conversationRouteName,conversationModel,conversationMessageModel,getInternals)=>async({id})=>{const get=get_getFactory(client,modelIntrospection,conversationModel,"GET",getInternals,!1,getCustomUserAgentDetails(AiAction.GetConversation)),{data,errors}=await get({id});return{data:data?convertItemToConversation(client,modelIntrospection,data.id,data.createdAt,data.updatedAt,conversationRouteName,conversationMessageModel,getInternals,data?.metadata,data?.name):data,errors}},createListConversationsFunction=(client,modelIntrospection,conversationRouteName,conversationModel,conversationMessageModel,getInternals)=>async input=>{const list=list_listFactory(client,modelIntrospection,conversationModel,getInternals,!1,getCustomUserAgentDetails(AiAction.ListConversations)),{data,nextToken,errors}=await list(input);return{data:data.map((datum=>convertItemToConversation(client,modelIntrospection,datum.id,datum.createdAt,datum.updatedAt,conversationRouteName,conversationMessageModel,getInternals,datum?.metadata,datum?.name))),nextToken,errors}},createDeleteConversationFunction=(client,modelIntrospection,conversationRouteName,conversationModel,conversationMessageModel,getInternals)=>async({id})=>{const deleteOperation=get_getFactory(client,modelIntrospection,conversationModel,"DELETE",getInternals,!1,getCustomUserAgentDetails(AiAction.DeleteConversation)),{data,errors}=await deleteOperation({id});return{data:data?convertItemToConversation(client,modelIntrospection,data?.id,data?.createdAt,data?.updatedAt,conversationRouteName,conversationMessageModel,getInternals,data?.metadata,data?.name):data,errors}},createUpdateConversationFunction=(client,modelIntrospection,conversationRouteName,conversationModel,conversationMessageModel,getInternals)=>async({id,metadata:metadataObject,name})=>{const metadata=JSON.stringify(metadataObject),updateOperation=get_getFactory(client,modelIntrospection,conversationModel,"UPDATE",getInternals,!1,getCustomUserAgentDetails(AiAction.UpdateConversation)),{data,errors}=await updateOperation({id,metadata,name});return{data:data?convertItemToConversation(client,modelIntrospection,data?.id,data?.createdAt,data?.updatedAt,conversationRouteName,conversationMessageModel,getInternals,data?.metadata,data?.name):data,errors}};const generateEnumsProperty_generateEnumsProperty=graphqlConfig=>{const modelIntrospection=graphqlConfig.modelIntrospection;if(!modelIntrospection)return{};const enums={};for(const[_,enumData]of Object.entries(modelIntrospection.enums))enums[enumData.name]={values:()=>enumData.values};return enums};function indexQuery_indexQueryFactory(client,modelIntrospection,model,indexMeta,getInternals,context=!1){return context?(contextSpec,args,options)=>_indexQuery(client,modelIntrospection,model,indexMeta,getInternals,{...args,...options},contextSpec):(args,options)=>_indexQuery(client,modelIntrospection,model,indexMeta,getInternals,{...args,...options})}function _indexQuery(client,modelIntrospection,model,indexMeta,getInternals,args,contextSpec){return selfAwareAsync((async resultPromise=>{const{name}=model,query=generateGraphQLDocument(modelIntrospection,name,"INDEX_QUERY",args,indexMeta),variables=buildGraphQLVariables(model,"INDEX_QUERY",args,modelIntrospection,indexMeta),auth=authModeParams(client,getInternals,args),modelInitializer=flattenedResult=>initializeModel(client,name,flattenedResult,modelIntrospection,auth.authMode,auth.authToken,!!contextSpec);try{const headers=getCustomHeaders(client,getInternals,args?.headers),requestArgs=[{...auth,query,variables},headers];void 0!==contextSpec&&requestArgs.unshift(contextSpec);const extendedPromise=extendCancellability(client.graphql(...requestArgs),resultPromise),response=await extendedPromise;if(void 0!==response.data)return function processGraphQlResponse(modelIntroSchema,modelName,result,selectionSet,modelInitializer){const{data,extensions}=result,[key]=Object.keys(data);if(data[key].items){const flattenedResult=data[key].items.map((value=>flattenItems(modelIntroSchema,modelName,value)));return{data:selectionSet?flattenedResult:modelInitializer(flattenedResult),nextToken:data[key].nextToken,extensions}}return{data:data[key],nextToken:data[key].nextToken,extensions}}(modelIntrospection,name,response,args?.selectionSet,modelInitializer)}catch(error){const{data,errors}=error;if(null!=data&&0!==Object.keys(data).length&&errors){const[key]=Object.keys(data);if(data[key]?.items){const flattenedResult=data[key]?.items.map((value=>flattenItems(modelIntrospection,name,value)));if(flattenedResult)return{data:args?.selectionSet?flattenedResult:modelInitializer(flattenedResult),nextToken:data[key]?.nextToken}}return{data:data[key],nextToken:data[key]?.nextToken}}return handleListGraphQlError(error)}}))}function subscriptionFactory(client,modelIntrospection,model,operation,getInternals){const{name}=model;return args=>{const query=generateGraphQLDocument(modelIntrospection,name,operation,args),variables=buildGraphQLVariables(model,operation,args,modelIntrospection),auth=authModeParams(client,getInternals,args),headers=getCustomHeaders(client,getInternals,args?.headers);return client.graphql({...auth,query,variables},headers).pipe(map((value=>{const[key]=Object.keys(value.data),data=value.data[key],flattenedResult=flattenItems(modelIntrospection,name,data);if(null===flattenedResult)return null;if(args?.selectionSet)return flattenedResult;{const[initialized]=initializeModel(client,name,[flattenedResult],modelIntrospection,auth.authMode,auth.authToken);return initialized}})))}}var observable="function"==typeof Symbol&&Symbol.observable||"@@observable";function identity(x){return x}function pipeFromArray(fns){return 0===fns.length?identity:1===fns.length?fns[0]:function piped(input){return fns.reduce((function(prev,fn){return fn(prev)}),input)}}var Observable=function(){function Observable(subscribe){subscribe&&(this._subscribe=subscribe)}return Observable.prototype.lift=function(operator){var observable=new Observable;return observable.source=this,observable.operator=operator,observable},Observable.prototype.subscribe=function(observerOrNext,error,complete){var _this=this,subscriber=function isSubscriber(value){return value&&value instanceof Subscriber||function isObserver(value){return value&&isFunction(value.next)&&isFunction(value.error)&&isFunction(value.complete)}(value)&&isSubscription(value)}(observerOrNext)?observerOrNext:new SafeSubscriber(observerOrNext,error,complete);return function errorContext(cb){if(config.useDeprecatedSynchronousErrorHandling){var isRoot=!context;if(isRoot&&(context={errorThrown:!1,error:null}),cb(),isRoot){var _a=context,errorThrown=_a.errorThrown,error=_a.error;if(context=null,errorThrown)throw error}}else cb()}((function(){var _a=_this,operator=_a.operator,source=_a.source;subscriber.add(operator?operator.call(subscriber,source):source?_this._subscribe(subscriber):_this._trySubscribe(subscriber))})),subscriber},Observable.prototype._trySubscribe=function(sink){try{return this._subscribe(sink)}catch(err){sink.error(err)}},Observable.prototype.forEach=function(next,promiseCtor){var _this=this;return new(promiseCtor=getPromiseCtor(promiseCtor))((function(resolve,reject){var subscriber=new SafeSubscriber({next:function(value){try{next(value)}catch(err){reject(err),subscriber.unsubscribe()}},error:reject,complete:resolve});_this.subscribe(subscriber)}))},Observable.prototype._subscribe=function(subscriber){var _a;return null===(_a=this.source)||void 0===_a?void 0:_a.subscribe(subscriber)},Observable.prototype[observable]=function(){return this},Observable.prototype.pipe=function(){for(var operations=[],_i=0;_i<arguments.length;_i++)operations[_i]=arguments[_i];return pipeFromArray(operations)(this)},Observable.prototype.toPromise=function(promiseCtor){var _this=this;return new(promiseCtor=getPromiseCtor(promiseCtor))((function(resolve,reject){var value;_this.subscribe((function(x){return value=x}),(function(err){return reject(err)}),(function(){return resolve(value)}))}))},Observable.create=function(subscribe){return new Observable(subscribe)},Observable}();function getPromiseCtor(promiseCtor){var _a;return null!==(_a=null!=promiseCtor?promiseCtor:config.Promise)&&void 0!==_a?_a:Promise}function findIndexByFields(needle,haystack,keyFields){const searchObject=Object.fromEntries(keyFields.map((fieldName=>[fieldName,needle[fieldName]])));for(let i=0;i<haystack.length;i++)if(Object.keys(searchObject).every((k=>searchObject[k]===haystack[i][k])))return i;return-1}var observeQuery_console=__webpack_require__("./node_modules/console-browserify/index.js");function observeQueryFactory(models,model){const{name}=model;return arg=>new Observable((subscriber=>{const items=[],messageQueue=[];let receiveMessages=(...messages)=>messageQueue.push(...messages);const onCreateSub=models[name].onCreate(arg).subscribe({next(item){receiveMessages({item,type:"create"})},error(error){subscriber.error({type:"onCreate",error})}}),onUpdateSub=models[name].onUpdate(arg).subscribe({next(item){receiveMessages({item,type:"update"})},error(error){subscriber.error({type:"onUpdate",error})}}),onDeleteSub=models[name].onDelete(arg).subscribe({next(item){receiveMessages({item,type:"delete"})},error(error){subscriber.error({type:"onDelete",error})}});function ingestMessages(messages){for(const message of messages){const idx=findIndexByFields(message.item,items,pkFields);switch(message.type){case"create":idx<0&&items.push(message.item);break;case"update":idx>=0&&(items[idx]=message.item);break;case"delete":idx>=0&&items.splice(idx,1);break;default:observeQuery_console.error("Unrecognized message in observeQuery.",message)}}subscriber.next({items,isSynced:!0})}const pkFields=function resolvePKFields(model){const{primaryKeyFieldName,sortKeyFieldNames}=model.primaryKeyInfo;return[primaryKeyFieldName,...sortKeyFieldNames]}(model);return(async()=>{let firstPage=!0,nextToken=null;for(;!subscriber.closed&&(firstPage||nextToken);){firstPage=!1;const{data:page,errors,nextToken:_nextToken}=await models[name].list({...arg,nextToken});nextToken=_nextToken,items.push(...page);const isSynced=0===messageQueue.length&&null==nextToken;if(subscriber.next({items,isSynced}),Array.isArray(errors))for(const error of errors)subscriber.error(error)}messageQueue.length>0&&ingestMessages(messageQueue),receiveMessages=(...messages)=>(ingestMessages(messages),items.length)})(),()=>{onCreateSub.unsubscribe(),onUpdateSub.unsubscribe(),onDeleteSub.unsubscribe()}}))}const attributeIsSecondaryIndex=attr=>"key"===attr.type&&attr.properties?.name&&attr.properties?.queryField&&attr.properties?.fields.length>0,clientUtils_getSecondaryIndexesFromSchemaModel=model=>{const idxs=model.attributes?.filter(attributeIsSecondaryIndex).map((attr=>{const queryField=attr.properties.queryField,[pk,...sk]=attr.properties.fields;return{queryField,pk,sk}}));return idxs||[]},clientUtils_excludeDisabledOps=(mis,modelName)=>{const modelAttrs=mis.models[modelName].attributes?.find((attr=>"model"===attr.type)),coarseToFineDict={queries:["list","get","observeQuery"],mutations:["create","update","delete"],subscriptions:["onCreate","onUpdate","onDelete"]},disabledOps=[];if(!modelAttrs)return graphQLOperationsInfo;if(modelAttrs.properties)for(const[key,value]of Object.entries(modelAttrs.properties))key in coarseToFineDict&&(null===value?disabledOps.push(...coarseToFineDict[key]):value instanceof Object&&disabledOps.push(...Object.keys(value)));disabledOps.includes("list")&&disabledOps.push("observeQuery");const disabledOpsUpper=disabledOps.map((op=>op.toUpperCase()));return Object.fromEntries(Object.entries(graphQLOperationsInfo).filter((([key])=>!disabledOpsUpper.includes(key))))};function addSchemaToClient(client,apiGraphqlConfig,getInternals){return function cancellation_upgradeClientCancellation(client){const innerCancel=client.cancel.bind(client);client.cancel=function(promise,message){const visited=new Set;let targetPromise=promise;for(;targetPromise&&promiseMap.has(targetPromise);){if(visited.has(targetPromise))throw new Error("A cycle was detected in the modeled graphql cancellation chain. This is a bug. Please report it!");visited.add(targetPromise),targetPromise=promiseMap.get(targetPromise)}return innerCancel(targetPromise,message)}}(client),client.models=function generateModelsProperty_generateModelsProperty(client,apiGraphQLConfig,getInternals){const models={},modelIntrospection=apiGraphQLConfig.modelIntrospection;if(!modelIntrospection)return{};const SUBSCRIPTION_OPS=["ONCREATE","ONUPDATE","ONDELETE"];for(const model of Object.values(modelIntrospection.models)){const{name}=model;models[name]={};const enabledModelOps=clientUtils_excludeDisabledOps(modelIntrospection,name);Object.entries(enabledModelOps).forEach((([key,{operationPrefix}])=>{const operation=key;"LIST"===operation?models[name][operationPrefix]=list_listFactory(client,modelIntrospection,model,getInternals):SUBSCRIPTION_OPS.includes(operation)?models[name][operationPrefix]=subscriptionFactory(client,modelIntrospection,model,operation,getInternals):models[name][operationPrefix]="OBSERVEQUERY"===operation?observeQueryFactory(models,model):get_getFactory(client,modelIntrospection,model,operation,getInternals)}));const secondaryIdxs=clientUtils_getSecondaryIndexesFromSchemaModel(model);for(const idx of secondaryIdxs)models[name][idx.queryField]=indexQuery_indexQueryFactory(client,modelIntrospection,model,idx,getInternals)}return models}(client,apiGraphqlConfig,getInternals),client.enums=generateEnumsProperty_generateEnumsProperty(apiGraphqlConfig),client.queries=function generateCustomOperationsProperty_generateCustomQueriesProperty(client,config,getInternals){return generateCustomOperationsProperty(client,config,"queries",getInternals)}(client,apiGraphqlConfig,getInternals),client.mutations=function generateCustomOperationsProperty_generateCustomMutationsProperty(client,config,getInternals){return generateCustomOperationsProperty(client,config,"mutations",getInternals)}(client,apiGraphqlConfig,getInternals),client.subscriptions=function generateCustomSubscriptionsProperty(client,config,getInternals){return generateCustomOperationsProperty(client,config,"subscriptions",getInternals)}(client,apiGraphqlConfig,getInternals),client.conversations=function generateConversationsProperty(client,apiGraphQLConfig,getInternals){const modelIntrospection=apiGraphQLConfig?.modelIntrospection;if(!modelIntrospection?.conversations)return{};const conversations={};for(const{name,conversation,message,models,nonModels,enums}of Object.values(modelIntrospection.conversations)){const conversationModel=models[conversation.modelName],conversationMessageModel=models[message.modelName];if(!conversationModel||!conversationMessageModel)return{};const conversationModelIntrospection={...modelIntrospection,models:{...modelIntrospection.models,...models},nonModels:{...modelIntrospection.nonModels,...nonModels},enums:{...modelIntrospection.enums,...enums}};conversations[name]={update:createUpdateConversationFunction(client,conversationModelIntrospection,name,conversationModel,conversationMessageModel,getInternals),create:createCreateConversationFunction(client,conversationModelIntrospection,name,conversationModel,conversationMessageModel,getInternals),get:createGetConversationFunction(client,conversationModelIntrospection,name,conversationModel,conversationMessageModel,getInternals),delete:createDeleteConversationFunction(client,conversationModelIntrospection,name,conversationModel,conversationMessageModel,getInternals),list:createListConversationsFunction(client,conversationModelIntrospection,name,conversationModel,conversationMessageModel,getInternals)}}return conversations}(client,apiGraphqlConfig,getInternals),client.generations=function generateGenerationsProperty(client,apiGraphQLConfig,getInternals){const modelIntrospection=apiGraphQLConfig?.modelIntrospection;if(!modelIntrospection?.generations)return{};const generations={};for(const generation of Object.values(modelIntrospection.generations))generations[generation.name]=customOpFactory(client,modelIntrospection,"query",generation,!1,getInternals,getCustomUserAgentDetails(AiAction.Generation));return generations}(client,apiGraphqlConfig,getInternals),client}var GraphQLAuthError;!function(GraphQLAuthError){GraphQLAuthError.NO_API_KEY="No api-key configured",GraphQLAuthError.NO_CURRENT_USER="No current user",GraphQLAuthError.NO_CREDENTIALS="No credentials",GraphQLAuthError.NO_FEDERATED_JWT="No federated jwt",GraphQLAuthError.NO_AUTH_TOKEN="No auth token specified"}(GraphQLAuthError||(GraphQLAuthError={}));const __amplify=Symbol("amplify"),__authMode=Symbol("authMode"),__authToken=Symbol("authToken"),__headers=Symbol("headers");function getInternals(client){const c=client;return{amplify:c[__amplify],authMode:c[__authMode],authToken:c[__authToken],headers:c[__headers]}}function isApiGraphQLProviderConfig_isApiGraphQLConfig(apiGraphQLConfig){return void 0!==apiGraphQLConfig}var Framework,Category,types_AiAction,AnalyticsAction,ApiAction,AuthAction,DataStoreAction,GeoAction,InAppMessagingAction,InteractionsAction,PredictionsAction,PubSubAction,PushNotificationAction,StorageAction;function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}!function(Framework){Framework.WebUnknown="0",Framework.React="1",Framework.NextJs="2",Framework.Angular="3",Framework.VueJs="4",Framework.Nuxt="5",Framework.Svelte="6",Framework.ServerSideUnknown="100",Framework.ReactSSR="101",Framework.NextJsSSR="102",Framework.AngularSSR="103",Framework.VueJsSSR="104",Framework.NuxtSSR="105",Framework.SvelteSSR="106",Framework.ReactNative="201",Framework.Expo="202"}(Framework||(Framework={})),function(Category){Category.AI="ai",Category.API="api",Category.Auth="auth",Category.Analytics="analytics",Category.DataStore="datastore",Category.Geo="geo",Category.InAppMessaging="inappmessaging",Category.Interactions="interactions",Category.Predictions="predictions",Category.PubSub="pubsub",Category.PushNotification="pushnotification",Category.Storage="storage"}(Category||(Category={})),function(AiAction){AiAction.CreateConversation="1",AiAction.GetConversation="2",AiAction.ListConversations="3",AiAction.DeleteConversation="4",AiAction.SendMessage="5",AiAction.ListMessages="6",AiAction.OnMessage="7",AiAction.Generation="8",AiAction.UpdateConversation="9"}(types_AiAction||(types_AiAction={})),function(AnalyticsAction){AnalyticsAction.Record="1",AnalyticsAction.IdentifyUser="2"}(AnalyticsAction||(AnalyticsAction={})),function(ApiAction){ApiAction.GraphQl="1",ApiAction.Get="2",ApiAction.Post="3",ApiAction.Put="4",ApiAction.Patch="5",ApiAction.Del="6",ApiAction.Head="7"}(ApiAction||(ApiAction={})),function(AuthAction){AuthAction.SignUp="1",AuthAction.ConfirmSignUp="2",AuthAction.ResendSignUpCode="3",AuthAction.SignIn="4",AuthAction.FetchMFAPreference="6",AuthAction.UpdateMFAPreference="7",AuthAction.SetUpTOTP="10",AuthAction.VerifyTOTPSetup="11",AuthAction.ConfirmSignIn="12",AuthAction.DeleteUserAttributes="15",AuthAction.DeleteUser="16",AuthAction.UpdateUserAttributes="17",AuthAction.FetchUserAttributes="18",AuthAction.ConfirmUserAttribute="22",AuthAction.SignOut="26",AuthAction.UpdatePassword="27",AuthAction.ResetPassword="28",AuthAction.ConfirmResetPassword="29",AuthAction.FederatedSignIn="30",AuthAction.RememberDevice="32",AuthAction.ForgetDevice="33",AuthAction.FetchDevices="34",AuthAction.SendUserAttributeVerificationCode="35",AuthAction.SignInWithRedirect="36"}(AuthAction||(AuthAction={})),function(DataStoreAction){DataStoreAction.Subscribe="1",DataStoreAction.GraphQl="2"}(DataStoreAction||(DataStoreAction={})),function(GeoAction){GeoAction.SearchByText="0",GeoAction.SearchByCoordinates="1",GeoAction.SearchForSuggestions="2",GeoAction.SearchByPlaceId="3",GeoAction.SaveGeofences="4",GeoAction.GetGeofence="5",GeoAction.ListGeofences="6",GeoAction.DeleteGeofences="7"}(GeoAction||(GeoAction={})),function(InAppMessagingAction){InAppMessagingAction.SyncMessages="1",InAppMessagingAction.IdentifyUser="2",InAppMessagingAction.NotifyMessageInteraction="3"}(InAppMessagingAction||(InAppMessagingAction={})),function(InteractionsAction){InteractionsAction.None="0"}(InteractionsAction||(InteractionsAction={})),function(PredictionsAction){PredictionsAction.Convert="1",PredictionsAction.Identify="2",PredictionsAction.Interpret="3"}(PredictionsAction||(PredictionsAction={})),function(PubSubAction){PubSubAction.Subscribe="1"}(PubSubAction||(PubSubAction={})),function(PushNotificationAction){PushNotificationAction.InitializePushNotifications="1",PushNotificationAction.IdentifyUser="2"}(PushNotificationAction||(PushNotificationAction={})),function(StorageAction){StorageAction.UploadData="1",StorageAction.DownloadData="2",StorageAction.List="3",StorageAction.Copy="4",StorageAction.Remove="5",StorageAction.GetProperties="6",StorageAction.GetUrl="7"}(StorageAction||(StorageAction={}));"function"==typeof Symbol&&null!=Symbol.iterator&&Symbol.iterator,"function"==typeof Symbol&&null!=Symbol.asyncIterator&&Symbol.asyncIterator;var SYMBOL_TO_STRING_TAG="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag";function getLocation(source,position){for(var match,lineRegexp=/\r\n|[\n\r]/g,line=1,column=position+1;(match=lineRegexp.exec(source.body))&&match.index<position;)line+=1,column=position+1-(match.index+match[0].length);return{line,column}}function printLocation(location){return printSourceLocation(location.source,getLocation(location.source,location.start))}function printSourceLocation(source,sourceLocation){var firstLineColumnOffset=source.locationOffset.column-1,body=whitespace(firstLineColumnOffset)+source.body,lineIndex=sourceLocation.line-1,lineOffset=source.locationOffset.line-1,lineNum=sourceLocation.line+lineOffset,columnOffset=1===sourceLocation.line?firstLineColumnOffset:0,columnNum=sourceLocation.column+columnOffset,locationStr="".concat(source.name,":").concat(lineNum,":").concat(columnNum,"\n"),lines=body.split(/\r\n|[\n\r]/g),locationLine=lines[lineIndex];if(locationLine.length>120){for(var subLineIndex=Math.floor(columnNum/80),subLineColumnNum=columnNum%80,subLines=[],i=0;i<locationLine.length;i+=80)subLines.push(locationLine.slice(i,i+80));return locationStr+printPrefixedLines([["".concat(lineNum),subLines[0]]].concat(subLines.slice(1,subLineIndex+1).map((function(subLine){return["",subLine]})),[[" ",whitespace(subLineColumnNum-1)+"^"],["",subLines[subLineIndex+1]]]))}return locationStr+printPrefixedLines([["".concat(lineNum-1),lines[lineIndex-1]],["".concat(lineNum),locationLine],["",whitespace(columnNum-1)+"^"],["".concat(lineNum+1),lines[lineIndex+1]]])}function printPrefixedLines(lines){var existingLines=lines.filter((function(_ref){_ref[0];return void 0!==_ref[1]})),padLen=Math.max.apply(Math,existingLines.map((function(_ref2){return _ref2[0].length})));return existingLines.map((function(_ref3){var prefix=_ref3[0],line=_ref3[1];return function leftPad(len,str){return whitespace(len-str.length)+str}(padLen,prefix)+(line?" | "+line:" |")})).join("\n")}function whitespace(len){return Array(len+1).join(" ")}function GraphQLError_typeof(obj){return GraphQLError_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},GraphQLError_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _possibleConstructorReturn(self,call){return!call||"object"!==GraphQLError_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)},_wrapNativeSuper(Class)}function _construct(Parent,args,Class){return _construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var GraphQLError=function(_Error){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(GraphQLError,_Error);var _super=function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}(GraphQLError);function GraphQLError(message,nodes,source,positions,path,originalError,extensions){var _nodeLocations,_nodeLocations2,_nodeLocations3,_this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GraphQLError),(_this=_super.call(this,message)).name="GraphQLError",_this.originalError=null!=originalError?originalError:void 0,_this.nodes=undefinedIfEmpty(Array.isArray(nodes)?nodes:nodes?[nodes]:void 0);for(var nodeLocations=[],_i2=0,_ref3=null!==(_this$nodes=_this.nodes)&&void 0!==_this$nodes?_this$nodes:[];_i2<_ref3.length;_i2++){var _this$nodes,loc=_ref3[_i2].loc;null!=loc&&nodeLocations.push(loc)}nodeLocations=undefinedIfEmpty(nodeLocations),_this.source=null!=source?source:null===(_nodeLocations=nodeLocations)||void 0===_nodeLocations?void 0:_nodeLocations[0].source,_this.positions=null!=positions?positions:null===(_nodeLocations2=nodeLocations)||void 0===_nodeLocations2?void 0:_nodeLocations2.map((function(loc){return loc.start})),_this.locations=positions&&source?positions.map((function(pos){return getLocation(source,pos)})):null===(_nodeLocations3=nodeLocations)||void 0===_nodeLocations3?void 0:_nodeLocations3.map((function(loc){return getLocation(loc.source,loc.start)})),_this.path=null!=path?path:void 0;var originalExtensions=null==originalError?void 0:originalError.extensions;return null==extensions&&function isObjectLike(value){return"object"==_typeof(value)&&null!==value}(originalExtensions)?_this.extensions=function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},originalExtensions):_this.extensions=null!=extensions?extensions:{},Object.defineProperties(_assertThisInitialized(_this),{message:{enumerable:!0},locations:{enumerable:null!=_this.locations},path:{enumerable:null!=_this.path},extensions:{enumerable:null!=_this.extensions&&Object.keys(_this.extensions).length>0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!=originalError&&originalError.stack?(Object.defineProperty(_assertThisInitialized(_this),"stack",{value:originalError.stack,writable:!0,configurable:!0}),_possibleConstructorReturn(_this)):(Error.captureStackTrace?Error.captureStackTrace(_assertThisInitialized(_this),GraphQLError):Object.defineProperty(_assertThisInitialized(_this),"stack",{value:Error().stack,writable:!0,configurable:!0}),_this)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(GraphQLError,[{key:"toString",value:function toString(){return function printError(error){var output=error.message;if(error.nodes)for(var _i4=0,_error$nodes2=error.nodes;_i4<_error$nodes2.length;_i4++){var node=_error$nodes2[_i4];node.loc&&(output+="\n\n"+printLocation(node.loc))}else if(error.source&&error.locations)for(var _i6=0,_error$locations2=error.locations;_i6<_error$locations2.length;_i6++){var location=_error$locations2[_i6];output+="\n\n"+printSourceLocation(error.source,location)}return output}(this)}},{key:SYMBOL_TO_STRING_TAG,get:function get(){return"Object"}}]),GraphQLError}(_wrapNativeSuper(Error));function undefinedIfEmpty(array){return void 0===array||0===array.length?void 0:array}function syntaxError(source,position,description){return new GraphQLError("Syntax Error: ".concat(description),void 0,source,[position])}var Kind=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"});const jsutils_nodejsCustomInspectSymbol="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):void 0;function defineInspect(classObject){var fn=classObject.prototype.toJSON;"function"==typeof fn||function invariant(condition,message){if(!Boolean(condition))throw new Error(null!=message?message:"Unexpected invariant triggered.")}(0),classObject.prototype.inspect=fn,jsutils_nodejsCustomInspectSymbol&&(classObject.prototype[jsutils_nodejsCustomInspectSymbol]=fn)}var Location=function(){function Location(startToken,endToken,source){this.start=startToken.start,this.end=endToken.end,this.startToken=startToken,this.endToken=endToken,this.source=source}return Location.prototype.toJSON=function toJSON(){return{start:this.start,end:this.end}},Location}();defineInspect(Location);var Token=function(){function Token(kind,start,end,line,column,prev,value){this.kind=kind,this.start=start,this.end=end,this.line=line,this.column=column,this.value=value,this.prev=prev,this.next=null}return Token.prototype.toJSON=function toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},Token}();function isNode(maybeNode){return null!=maybeNode&&"string"==typeof maybeNode.kind}defineInspect(Token);var tokenKind_TokenKind=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"});function inspect_typeof(obj){return inspect_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},inspect_typeof(obj)}function inspect(value){return formatValue(value,[])}function formatValue(value,seenValues){switch(inspect_typeof(value)){case"string":return JSON.stringify(value);case"function":return value.name?"[function ".concat(value.name,"]"):"[function]";case"object":return null===value?"null":function formatObjectValue(value,previouslySeenValues){if(-1!==previouslySeenValues.indexOf(value))return"[Circular]";var seenValues=[].concat(previouslySeenValues,[value]),customInspectFn=function getCustomFn(object){var customInspectFn=object[String(jsutils_nodejsCustomInspectSymbol)];if("function"==typeof customInspectFn)return customInspectFn;if("function"==typeof object.inspect)return object.inspect}(value);if(void 0!==customInspectFn){var customValue=customInspectFn.call(value);if(customValue!==value)return"string"==typeof customValue?customValue:formatValue(customValue,seenValues)}else if(Array.isArray(value))return function formatArray(array,seenValues){if(0===array.length)return"[]";if(seenValues.length>2)return"[Array]";for(var len=Math.min(10,array.length),remaining=array.length-len,items=[],i=0;i<len;++i)items.push(formatValue(array[i],seenValues));1===remaining?items.push("... 1 more item"):remaining>1&&items.push("... ".concat(remaining," more items"));return"["+items.join(", ")+"]"}(value,seenValues);return function formatObject(object,seenValues){var keys=Object.keys(object);if(0===keys.length)return"{}";if(seenValues.length>2)return"["+function getObjectTag(object){var tag=Object.prototype.toString.call(object).replace(/^\[object /,"").replace(/]$/,"");if("Object"===tag&&"function"==typeof object.constructor){var name=object.constructor.name;if("string"==typeof name&&""!==name)return name}return tag}(object)+"]";var properties=keys.map((function(key){return key+": "+formatValue(object[key],seenValues)}));return"{ "+properties.join(", ")+" }"}(value,seenValues)}(value,seenValues);default:return String(value)}}function devAssert(condition,message){if(!Boolean(condition))throw new Error(message)}const instanceOf=function instanceOf(value,constructor){return value instanceof constructor};function source_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Source=function(){function Source(body){var name=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GraphQL request",locationOffset=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{line:1,column:1};"string"==typeof body||devAssert(0,"Body must be a string. Received: ".concat(inspect(body),".")),this.body=body,this.name=name,this.locationOffset=locationOffset,this.locationOffset.line>0||devAssert(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||devAssert(0,"column in locationOffset is 1-indexed and must be positive.")}return function source_createClass(Constructor,protoProps,staticProps){return protoProps&&source_defineProperties(Constructor.prototype,protoProps),staticProps&&source_defineProperties(Constructor,staticProps),Constructor}(Source,[{key:SYMBOL_TO_STRING_TAG,get:function get(){return"Source"}}]),Source}();var DirectiveLocation=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"});function dedentBlockStringValue(rawString){var lines=rawString.split(/\r\n|[\n\r]/g),commonIndent=function getBlockStringIndentation(value){for(var _commonIndent,isFirstLine=!0,isEmptyLine=!0,indent=0,commonIndent=null,i=0;i<value.length;++i)switch(value.charCodeAt(i)){case 13:10===value.charCodeAt(i+1)&&++i;case 10:isFirstLine=!1,isEmptyLine=!0,indent=0;break;case 9:case 32:++indent;break;default:isEmptyLine&&!isFirstLine&&(null===commonIndent||indent<commonIndent)&&(commonIndent=indent),isEmptyLine=!1}return null!==(_commonIndent=commonIndent)&&void 0!==_commonIndent?_commonIndent:0}(rawString);if(0!==commonIndent)for(var i=1;i<lines.length;i++)lines[i]=lines[i].slice(commonIndent);for(var startLine=0;startLine<lines.length&&isBlank(lines[startLine]);)++startLine;for(var endLine=lines.length;endLine>startLine&&isBlank(lines[endLine-1]);)--endLine;return lines.slice(startLine,endLine).join("\n")}function isBlank(str){for(var i=0;i<str.length;++i)if(" "!==str[i]&&"\t"!==str[i])return!1;return!0}var Lexer=function(){function Lexer(source){var startOfFileToken=new Token(tokenKind_TokenKind.SOF,0,0,0,0,null);this.source=source,this.lastToken=startOfFileToken,this.token=startOfFileToken,this.line=1,this.lineStart=0}var _proto=Lexer.prototype;return _proto.advance=function advance(){return this.lastToken=this.token,this.token=this.lookahead()},_proto.lookahead=function lookahead(){var token=this.token;if(token.kind!==tokenKind_TokenKind.EOF)do{var _token$next;token=null!==(_token$next=token.next)&&void 0!==_token$next?_token$next:token.next=readToken(this,token)}while(token.kind===tokenKind_TokenKind.COMMENT);return token},Lexer}();function printCharCode(code){return isNaN(code)?tokenKind_TokenKind.EOF:code<127?JSON.stringify(String.fromCharCode(code)):'"\\u'.concat(("00"+code.toString(16).toUpperCase()).slice(-4),'"')}function readToken(lexer,prev){for(var source=lexer.source,body=source.body,bodyLength=body.length,pos=prev.end;pos<bodyLength;){var code=body.charCodeAt(pos),_line=lexer.line,_col=1+pos-lexer.lineStart;switch(code){case 65279:case 9:case 32:case 44:++pos;continue;case 10:++pos,++lexer.line,lexer.lineStart=pos;continue;case 13:10===body.charCodeAt(pos+1)?pos+=2:++pos,++lexer.line,lexer.lineStart=pos;continue;case 33:return new Token(tokenKind_TokenKind.BANG,pos,pos+1,_line,_col,prev);case 35:return readComment(source,pos,_line,_col,prev);case 36:return new Token(tokenKind_TokenKind.DOLLAR,pos,pos+1,_line,_col,prev);case 38:return new Token(tokenKind_TokenKind.AMP,pos,pos+1,_line,_col,prev);case 40:return new Token(tokenKind_TokenKind.PAREN_L,pos,pos+1,_line,_col,prev);case 41:return new Token(tokenKind_TokenKind.PAREN_R,pos,pos+1,_line,_col,prev);case 46:if(46===body.charCodeAt(pos+1)&&46===body.charCodeAt(pos+2))return new Token(tokenKind_TokenKind.SPREAD,pos,pos+3,_line,_col,prev);break;case 58:return new Token(tokenKind_TokenKind.COLON,pos,pos+1,_line,_col,prev);case 61:return new Token(tokenKind_TokenKind.EQUALS,pos,pos+1,_line,_col,prev);case 64:return new Token(tokenKind_TokenKind.AT,pos,pos+1,_line,_col,prev);case 91:return new Token(tokenKind_TokenKind.BRACKET_L,pos,pos+1,_line,_col,prev);case 93:return new Token(tokenKind_TokenKind.BRACKET_R,pos,pos+1,_line,_col,prev);case 123:return new Token(tokenKind_TokenKind.BRACE_L,pos,pos+1,_line,_col,prev);case 124:return new Token(tokenKind_TokenKind.PIPE,pos,pos+1,_line,_col,prev);case 125:return new Token(tokenKind_TokenKind.BRACE_R,pos,pos+1,_line,_col,prev);case 34:return 34===body.charCodeAt(pos+1)&&34===body.charCodeAt(pos+2)?readBlockString(source,pos,_line,_col,prev,lexer):readString(source,pos,_line,_col,prev);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return readNumber(source,pos,code,_line,_col,prev);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return readName(source,pos,_line,_col,prev)}throw syntaxError(source,pos,unexpectedCharacterMessage(code))}var line=lexer.line,col=1+pos-lexer.lineStart;return new Token(tokenKind_TokenKind.EOF,bodyLength,bodyLength,line,col,prev)}function unexpectedCharacterMessage(code){return code<32&&9!==code&&10!==code&&13!==code?"Cannot contain the invalid character ".concat(printCharCode(code),"."):39===code?"Unexpected single quote character ('), did you mean to use a double quote (\")?":"Cannot parse the unexpected character ".concat(printCharCode(code),".")}function readComment(source,start,line,col,prev){var code,body=source.body,position=start;do{code=body.charCodeAt(++position)}while(!isNaN(code)&&(code>31||9===code));return new Token(tokenKind_TokenKind.COMMENT,start,position,line,col,prev,body.slice(start+1,position))}function readNumber(source,start,firstCode,line,col,prev){var body=source.body,code=firstCode,position=start,isFloat=!1;if(45===code&&(code=body.charCodeAt(++position)),48===code){if((code=body.charCodeAt(++position))>=48&&code<=57)throw syntaxError(source,position,"Invalid number, unexpected digit after 0: ".concat(printCharCode(code),"."))}else position=readDigits(source,position,code),code=body.charCodeAt(position);if(46===code&&(isFloat=!0,code=body.charCodeAt(++position),position=readDigits(source,position,code),code=body.charCodeAt(position)),69!==code&&101!==code||(isFloat=!0,43!==(code=body.charCodeAt(++position))&&45!==code||(code=body.charCodeAt(++position)),position=readDigits(source,position,code),code=body.charCodeAt(position)),46===code||function isNameStart(code){return 95===code||code>=65&&code<=90||code>=97&&code<=122}(code))throw syntaxError(source,position,"Invalid number, expected digit but got: ".concat(printCharCode(code),"."));return new Token(isFloat?tokenKind_TokenKind.FLOAT:tokenKind_TokenKind.INT,start,position,line,col,prev,body.slice(start,position))}function readDigits(source,start,firstCode){var body=source.body,position=start,code=firstCode;if(code>=48&&code<=57){do{code=body.charCodeAt(++position)}while(code>=48&&code<=57);return position}throw syntaxError(source,position,"Invalid number, expected digit but got: ".concat(printCharCode(code),"."))}function readString(source,start,line,col,prev){for(var a,b,c,d,body=source.body,position=start+1,chunkStart=position,code=0,value="";position<body.length&&!isNaN(code=body.charCodeAt(position))&&10!==code&&13!==code;){if(34===code)return value+=body.slice(chunkStart,position),new Token(tokenKind_TokenKind.STRING,start,position+1,line,col,prev,value);if(code<32&&9!==code)throw syntaxError(source,position,"Invalid character within String: ".concat(printCharCode(code),"."));if(++position,92===code){switch(value+=body.slice(chunkStart,position-1),code=body.charCodeAt(position)){case 34:value+='"';break;case 47:value+="/";break;case 92:value+="\\";break;case 98:value+="\b";break;case 102:value+="\f";break;case 110:value+="\n";break;case 114:value+="\r";break;case 116:value+="\t";break;case 117:var charCode=(a=body.charCodeAt(position+1),b=body.charCodeAt(position+2),c=body.charCodeAt(position+3),d=body.charCodeAt(position+4),char2hex(a)<<12|char2hex(b)<<8|char2hex(c)<<4|char2hex(d));if(charCode<0){var invalidSequence=body.slice(position+1,position+5);throw syntaxError(source,position,"Invalid character escape sequence: \\u".concat(invalidSequence,"."))}value+=String.fromCharCode(charCode),position+=4;break;default:throw syntaxError(source,position,"Invalid character escape sequence: \\".concat(String.fromCharCode(code),"."))}chunkStart=++position}}throw syntaxError(source,position,"Unterminated string.")}function readBlockString(source,start,line,col,prev,lexer){for(var body=source.body,position=start+3,chunkStart=position,code=0,rawValue="";position<body.length&&!isNaN(code=body.charCodeAt(position));){if(34===code&&34===body.charCodeAt(position+1)&&34===body.charCodeAt(position+2))return rawValue+=body.slice(chunkStart,position),new Token(tokenKind_TokenKind.BLOCK_STRING,start,position+3,line,col,prev,dedentBlockStringValue(rawValue));if(code<32&&9!==code&&10!==code&&13!==code)throw syntaxError(source,position,"Invalid character within String: ".concat(printCharCode(code),"."));10===code?(++position,++lexer.line,lexer.lineStart=position):13===code?(10===body.charCodeAt(position+1)?position+=2:++position,++lexer.line,lexer.lineStart=position):92===code&&34===body.charCodeAt(position+1)&&34===body.charCodeAt(position+2)&&34===body.charCodeAt(position+3)?(rawValue+=body.slice(chunkStart,position)+'"""',chunkStart=position+=4):++position}throw syntaxError(source,position,"Unterminated string.")}function char2hex(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:-1}function readName(source,start,line,col,prev){for(var body=source.body,bodyLength=body.length,position=start+1,code=0;position!==bodyLength&&!isNaN(code=body.charCodeAt(position))&&(95===code||code>=48&&code<=57||code>=65&&code<=90||code>=97&&code<=122);)++position;return new Token(tokenKind_TokenKind.NAME,start,position,line,col,prev,body.slice(start,position))}function parse(source,options){return new Parser(source,options).parseDocument()}var Parser=function(){function Parser(source,options){var sourceObj=function isSource(source){return instanceOf(source,Source)}(source)?source:new Source(source);this._lexer=new Lexer(sourceObj),this._options=options}var _proto=Parser.prototype;return _proto.parseName=function parseName(){var token=this.expectToken(tokenKind_TokenKind.NAME);return{kind:Kind.NAME,value:token.value,loc:this.loc(token)}},_proto.parseDocument=function parseDocument(){var start=this._lexer.token;return{kind:Kind.DOCUMENT,definitions:this.many(tokenKind_TokenKind.SOF,this.parseDefinition,tokenKind_TokenKind.EOF),loc:this.loc(start)}},_proto.parseDefinition=function parseDefinition(){if(this.peek(tokenKind_TokenKind.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(tokenKind_TokenKind.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},_proto.parseOperationDefinition=function parseOperationDefinition(){var start=this._lexer.token;if(this.peek(tokenKind_TokenKind.BRACE_L))return{kind:Kind.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(start)};var name,operation=this.parseOperationType();return this.peek(tokenKind_TokenKind.NAME)&&(name=this.parseName()),{kind:Kind.OPERATION_DEFINITION,operation,name,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(start)}},_proto.parseOperationType=function parseOperationType(){var operationToken=this.expectToken(tokenKind_TokenKind.NAME);switch(operationToken.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(operationToken)},_proto.parseVariableDefinitions=function parseVariableDefinitions(){return this.optionalMany(tokenKind_TokenKind.PAREN_L,this.parseVariableDefinition,tokenKind_TokenKind.PAREN_R)},_proto.parseVariableDefinition=function parseVariableDefinition(){var start=this._lexer.token;return{kind:Kind.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(tokenKind_TokenKind.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(tokenKind_TokenKind.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(start)}},_proto.parseVariable=function parseVariable(){var start=this._lexer.token;return this.expectToken(tokenKind_TokenKind.DOLLAR),{kind:Kind.VARIABLE,name:this.parseName(),loc:this.loc(start)}},_proto.parseSelectionSet=function parseSelectionSet(){var start=this._lexer.token;return{kind:Kind.SELECTION_SET,selections:this.many(tokenKind_TokenKind.BRACE_L,this.parseSelection,tokenKind_TokenKind.BRACE_R),loc:this.loc(start)}},_proto.parseSelection=function parseSelection(){return this.peek(tokenKind_TokenKind.SPREAD)?this.parseFragment():this.parseField()},_proto.parseField=function parseField(){var alias,name,start=this._lexer.token,nameOrAlias=this.parseName();return this.expectOptionalToken(tokenKind_TokenKind.COLON)?(alias=nameOrAlias,name=this.parseName()):name=nameOrAlias,{kind:Kind.FIELD,alias,name,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(tokenKind_TokenKind.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(start)}},_proto.parseArguments=function parseArguments(isConst){var item=isConst?this.parseConstArgument:this.parseArgument;return this.optionalMany(tokenKind_TokenKind.PAREN_L,item,tokenKind_TokenKind.PAREN_R)},_proto.parseArgument=function parseArgument(){var start=this._lexer.token,name=this.parseName();return this.expectToken(tokenKind_TokenKind.COLON),{kind:Kind.ARGUMENT,name,value:this.parseValueLiteral(!1),loc:this.loc(start)}},_proto.parseConstArgument=function parseConstArgument(){var start=this._lexer.token;return{kind:Kind.ARGUMENT,name:this.parseName(),value:(this.expectToken(tokenKind_TokenKind.COLON),this.parseValueLiteral(!0)),loc:this.loc(start)}},_proto.parseFragment=function parseFragment(){var start=this._lexer.token;this.expectToken(tokenKind_TokenKind.SPREAD);var hasTypeCondition=this.expectOptionalKeyword("on");return!hasTypeCondition&&this.peek(tokenKind_TokenKind.NAME)?{kind:Kind.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(start)}:{kind:Kind.INLINE_FRAGMENT,typeCondition:hasTypeCondition?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(start)}},_proto.parseFragmentDefinition=function parseFragmentDefinition(){var _this$_options,start=this._lexer.token;return this.expectKeyword("fragment"),!0===(null===(_this$_options=this._options)||void 0===_this$_options?void 0:_this$_options.experimentalFragmentVariables)?{kind:Kind.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(start)}:{kind:Kind.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(start)}},_proto.parseFragmentName=function parseFragmentName(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()},_proto.parseValueLiteral=function parseValueLiteral(isConst){var token=this._lexer.token;switch(token.kind){case tokenKind_TokenKind.BRACKET_L:return this.parseList(isConst);case tokenKind_TokenKind.BRACE_L:return this.parseObject(isConst);case tokenKind_TokenKind.INT:return this._lexer.advance(),{kind:Kind.INT,value:token.value,loc:this.loc(token)};case tokenKind_TokenKind.FLOAT:return this._lexer.advance(),{kind:Kind.FLOAT,value:token.value,loc:this.loc(token)};case tokenKind_TokenKind.STRING:case tokenKind_TokenKind.BLOCK_STRING:return this.parseStringLiteral();case tokenKind_TokenKind.NAME:switch(this._lexer.advance(),token.value){case"true":return{kind:Kind.BOOLEAN,value:!0,loc:this.loc(token)};case"false":return{kind:Kind.BOOLEAN,value:!1,loc:this.loc(token)};case"null":return{kind:Kind.NULL,loc:this.loc(token)};default:return{kind:Kind.ENUM,value:token.value,loc:this.loc(token)}}case tokenKind_TokenKind.DOLLAR:if(!isConst)return this.parseVariable()}throw this.unexpected()},_proto.parseStringLiteral=function parseStringLiteral(){var token=this._lexer.token;return this._lexer.advance(),{kind:Kind.STRING,value:token.value,block:token.kind===tokenKind_TokenKind.BLOCK_STRING,loc:this.loc(token)}},_proto.parseList=function parseList(isConst){var _this=this,start=this._lexer.token;return{kind:Kind.LIST,values:this.any(tokenKind_TokenKind.BRACKET_L,(function item(){return _this.parseValueLiteral(isConst)}),tokenKind_TokenKind.BRACKET_R),loc:this.loc(start)}},_proto.parseObject=function parseObject(isConst){var _this2=this,start=this._lexer.token;return{kind:Kind.OBJECT,fields:this.any(tokenKind_TokenKind.BRACE_L,(function item(){return _this2.parseObjectField(isConst)}),tokenKind_TokenKind.BRACE_R),loc:this.loc(start)}},_proto.parseObjectField=function parseObjectField(isConst){var start=this._lexer.token,name=this.parseName();return this.expectToken(tokenKind_TokenKind.COLON),{kind:Kind.OBJECT_FIELD,name,value:this.parseValueLiteral(isConst),loc:this.loc(start)}},_proto.parseDirectives=function parseDirectives(isConst){for(var directives=[];this.peek(tokenKind_TokenKind.AT);)directives.push(this.parseDirective(isConst));return directives},_proto.parseDirective=function parseDirective(isConst){var start=this._lexer.token;return this.expectToken(tokenKind_TokenKind.AT),{kind:Kind.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(isConst),loc:this.loc(start)}},_proto.parseTypeReference=function parseTypeReference(){var type,start=this._lexer.token;return this.expectOptionalToken(tokenKind_TokenKind.BRACKET_L)?(type=this.parseTypeReference(),this.expectToken(tokenKind_TokenKind.BRACKET_R),type={kind:Kind.LIST_TYPE,type,loc:this.loc(start)}):type=this.parseNamedType(),this.expectOptionalToken(tokenKind_TokenKind.BANG)?{kind:Kind.NON_NULL_TYPE,type,loc:this.loc(start)}:type},_proto.parseNamedType=function parseNamedType(){var start=this._lexer.token;return{kind:Kind.NAMED_TYPE,name:this.parseName(),loc:this.loc(start)}},_proto.parseTypeSystemDefinition=function parseTypeSystemDefinition(){var keywordToken=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(keywordToken.kind===tokenKind_TokenKind.NAME)switch(keywordToken.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(keywordToken)},_proto.peekDescription=function peekDescription(){return this.peek(tokenKind_TokenKind.STRING)||this.peek(tokenKind_TokenKind.BLOCK_STRING)},_proto.parseDescription=function parseDescription(){if(this.peekDescription())return this.parseStringLiteral()},_proto.parseSchemaDefinition=function parseSchemaDefinition(){var start=this._lexer.token,description=this.parseDescription();this.expectKeyword("schema");var directives=this.parseDirectives(!0),operationTypes=this.many(tokenKind_TokenKind.BRACE_L,this.parseOperationTypeDefinition,tokenKind_TokenKind.BRACE_R);return{kind:Kind.SCHEMA_DEFINITION,description,directives,operationTypes,loc:this.loc(start)}},_proto.parseOperationTypeDefinition=function parseOperationTypeDefinition(){var start=this._lexer.token,operation=this.parseOperationType();this.expectToken(tokenKind_TokenKind.COLON);var type=this.parseNamedType();return{kind:Kind.OPERATION_TYPE_DEFINITION,operation,type,loc:this.loc(start)}},_proto.parseScalarTypeDefinition=function parseScalarTypeDefinition(){var start=this._lexer.token,description=this.parseDescription();this.expectKeyword("scalar");var name=this.parseName(),directives=this.parseDirectives(!0);return{kind:Kind.SCALAR_TYPE_DEFINITION,description,name,directives,loc:this.loc(start)}},_proto.parseObjectTypeDefinition=function parseObjectTypeDefinition(){var start=this._lexer.token,description=this.parseDescription();this.expectKeyword("type");var name=this.parseName(),interfaces=this.parseImplementsInterfaces(),directives=this.parseDirectives(!0),fields=this.parseFieldsDefinition();return{kind:Kind.OBJECT_TYPE_DEFINITION,description,name,interfaces,directives,fields,loc:this.loc(start)}},_proto.parseImplementsInterfaces=function parseImplementsInterfaces(){var _this$_options2;if(!this.expectOptionalKeyword("implements"))return[];if(!0===(null===(_this$_options2=this._options)||void 0===_this$_options2?void 0:_this$_options2.allowLegacySDLImplementsInterfaces)){var types=[];this.expectOptionalToken(tokenKind_TokenKind.AMP);do{types.push(this.parseNamedType())}while(this.expectOptionalToken(tokenKind_TokenKind.AMP)||this.peek(tokenKind_TokenKind.NAME));return types}return this.delimitedMany(tokenKind_TokenKind.AMP,this.parseNamedType)},_proto.parseFieldsDefinition=function parseFieldsDefinition(){var _this$_options3;return!0===(null===(_this$_options3=this._options)||void 0===_this$_options3?void 0:_this$_options3.allowLegacySDLEmptyFields)&&this.peek(tokenKind_TokenKind.BRACE_L)&&this._lexer.lookahead().kind===tokenKind_TokenKind.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(tokenKind_TokenKind.BRACE_L,this.parseFieldDefinition,tokenKind_TokenKind.BRACE_R)},_proto.parseFieldDefinition=function parseFieldDefinition(){var start=this._lexer.token,description=this.parseDescription(),name=this.parseName(),args=this.parseArgumentDefs();this.expectToken(tokenKind_TokenKind.COLON);var type=this.parseTypeReference(),directives=this.parseDirectives(!0);return{kind:Kind.FIELD_DEFINITION,description,name,arguments:args,type,directives,loc:this.loc(start)}},_proto.parseArgumentDefs=function parseArgumentDefs(){return this.optionalMany(tokenKind_TokenKind.PAREN_L,this.parseInputValueDef,tokenKind_TokenKind.PAREN_R)},_proto.parseInputValueDef=function parseInputValueDef(){var start=this._lexer.token,description=this.parseDescription(),name=this.parseName();this.expectToken(tokenKind_TokenKind.COLON);var defaultValue,type=this.parseTypeReference();this.expectOptionalToken(tokenKind_TokenKind.EQUALS)&&(defaultValue=this.parseValueLiteral(!0));var directives=this.parseDirectives(!0);return{kind:Kind.INPUT_VALUE_DEFINITION,description,name,type,defaultValue,directives,loc:this.loc(start)}},_proto.parseInterfaceTypeDefinition=function parseInterfaceTypeDefinition(){var start=this._lexer.token,description=this.parseDescription();this.expectKeyword("interface");var name=this.parseName(),interfaces=this.parseImplementsInterfaces(),directives=this.parseDirectives(!0),fields=this.parseFieldsDefinition();return{kind:Kind.INTERFACE_TYPE_DEFINITION,description,name,interfaces,directives,fields,loc:this.loc(start)}},_proto.parseUnionTypeDefinition=function parseUnionTypeDefinition(){var start=this._lexer.token,description=this.parseDescription();this.expectKeyword("union");var name=this.parseName(),directives=this.parseDirectives(!0),types=this.parseUnionMemberTypes();return{kind:Kind.UNION_TYPE_DEFINITION,description,name,directives,types,loc:this.loc(start)}},_proto.parseUnionMemberTypes=function parseUnionMemberTypes(){return this.expectOptionalToken(tokenKind_TokenKind.EQUALS)?this.delimitedMany(tokenKind_TokenKind.PIPE,this.parseNamedType):[]},_proto.parseEnumTypeDefinition=function parseEnumTypeDefinition(){var start=this._lexer.token,description=this.parseDescription();this.expectKeyword("enum");var name=this.parseName(),directives=this.parseDirectives(!0),values=this.parseEnumValuesDefinition();return{kind:Kind.ENUM_TYPE_DEFINITION,description,name,directives,values,loc:this.loc(start)}},_proto.parseEnumValuesDefinition=function parseEnumValuesDefinition(){return this.optionalMany(tokenKind_TokenKind.BRACE_L,this.parseEnumValueDefinition,tokenKind_TokenKind.BRACE_R)},_proto.parseEnumValueDefinition=function parseEnumValueDefinition(){var start=this._lexer.token,description=this.parseDescription(),name=this.parseName(),directives=this.parseDirectives(!0);return{kind:Kind.ENUM_VALUE_DEFINITION,description,name,directives,loc:this.loc(start)}},_proto.parseInputObjectTypeDefinition=function parseInputObjectTypeDefinition(){var start=this._lexer.token,description=this.parseDescription();this.expectKeyword("input");var name=this.parseName(),directives=this.parseDirectives(!0),fields=this.parseInputFieldsDefinition();return{kind:Kind.INPUT_OBJECT_TYPE_DEFINITION,description,name,directives,fields,loc:this.loc(start)}},_proto.parseInputFieldsDefinition=function parseInputFieldsDefinition(){return this.optionalMany(tokenKind_TokenKind.BRACE_L,this.parseInputValueDef,tokenKind_TokenKind.BRACE_R)},_proto.parseTypeSystemExtension=function parseTypeSystemExtension(){var keywordToken=this._lexer.lookahead();if(keywordToken.kind===tokenKind_TokenKind.NAME)switch(keywordToken.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(keywordToken)},_proto.parseSchemaExtension=function parseSchemaExtension(){var start=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var directives=this.parseDirectives(!0),operationTypes=this.optionalMany(tokenKind_TokenKind.BRACE_L,this.parseOperationTypeDefinition,tokenKind_TokenKind.BRACE_R);if(0===directives.length&&0===operationTypes.length)throw this.unexpected();return{kind:Kind.SCHEMA_EXTENSION,directives,operationTypes,loc:this.loc(start)}},_proto.parseScalarTypeExtension=function parseScalarTypeExtension(){var start=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var name=this.parseName(),directives=this.parseDirectives(!0);if(0===directives.length)throw this.unexpected();return{kind:Kind.SCALAR_TYPE_EXTENSION,name,directives,loc:this.loc(start)}},_proto.parseObjectTypeExtension=function parseObjectTypeExtension(){var start=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var name=this.parseName(),interfaces=this.parseImplementsInterfaces(),directives=this.parseDirectives(!0),fields=this.parseFieldsDefinition();if(0===interfaces.length&&0===directives.length&&0===fields.length)throw this.unexpected();return{kind:Kind.OBJECT_TYPE_EXTENSION,name,interfaces,directives,fields,loc:this.loc(start)}},_proto.parseInterfaceTypeExtension=function parseInterfaceTypeExtension(){var start=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var name=this.parseName(),interfaces=this.parseImplementsInterfaces(),directives=this.parseDirectives(!0),fields=this.parseFieldsDefinition();if(0===interfaces.length&&0===directives.length&&0===fields.length)throw this.unexpected();return{kind:Kind.INTERFACE_TYPE_EXTENSION,name,interfaces,directives,fields,loc:this.loc(start)}},_proto.parseUnionTypeExtension=function parseUnionTypeExtension(){var start=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var name=this.parseName(),directives=this.parseDirectives(!0),types=this.parseUnionMemberTypes();if(0===directives.length&&0===types.length)throw this.unexpected();return{kind:Kind.UNION_TYPE_EXTENSION,name,directives,types,loc:this.loc(start)}},_proto.parseEnumTypeExtension=function parseEnumTypeExtension(){var start=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var name=this.parseName(),directives=this.parseDirectives(!0),values=this.parseEnumValuesDefinition();if(0===directives.length&&0===values.length)throw this.unexpected();return{kind:Kind.ENUM_TYPE_EXTENSION,name,directives,values,loc:this.loc(start)}},_proto.parseInputObjectTypeExtension=function parseInputObjectTypeExtension(){var start=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var name=this.parseName(),directives=this.parseDirectives(!0),fields=this.parseInputFieldsDefinition();if(0===directives.length&&0===fields.length)throw this.unexpected();return{kind:Kind.INPUT_OBJECT_TYPE_EXTENSION,name,directives,fields,loc:this.loc(start)}},_proto.parseDirectiveDefinition=function parseDirectiveDefinition(){var start=this._lexer.token,description=this.parseDescription();this.expectKeyword("directive"),this.expectToken(tokenKind_TokenKind.AT);var name=this.parseName(),args=this.parseArgumentDefs(),repeatable=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var locations=this.parseDirectiveLocations();return{kind:Kind.DIRECTIVE_DEFINITION,description,name,arguments:args,repeatable,locations,loc:this.loc(start)}},_proto.parseDirectiveLocations=function parseDirectiveLocations(){return this.delimitedMany(tokenKind_TokenKind.PIPE,this.parseDirectiveLocation)},_proto.parseDirectiveLocation=function parseDirectiveLocation(){var start=this._lexer.token,name=this.parseName();if(void 0!==DirectiveLocation[name.value])return name;throw this.unexpected(start)},_proto.loc=function loc(startToken){var _this$_options4;if(!0!==(null===(_this$_options4=this._options)||void 0===_this$_options4?void 0:_this$_options4.noLocation))return new Location(startToken,this._lexer.lastToken,this._lexer.source)},_proto.peek=function peek(kind){return this._lexer.token.kind===kind},_proto.expectToken=function expectToken(kind){var token=this._lexer.token;if(token.kind===kind)return this._lexer.advance(),token;throw syntaxError(this._lexer.source,token.start,"Expected ".concat(getTokenKindDesc(kind),", found ").concat(getTokenDesc(token),"."))},_proto.expectOptionalToken=function expectOptionalToken(kind){var token=this._lexer.token;if(token.kind===kind)return this._lexer.advance(),token},_proto.expectKeyword=function expectKeyword(value){var token=this._lexer.token;if(token.kind!==tokenKind_TokenKind.NAME||token.value!==value)throw syntaxError(this._lexer.source,token.start,'Expected "'.concat(value,'", found ').concat(getTokenDesc(token),"."));this._lexer.advance()},_proto.expectOptionalKeyword=function expectOptionalKeyword(value){var token=this._lexer.token;return token.kind===tokenKind_TokenKind.NAME&&token.value===value&&(this._lexer.advance(),!0)},_proto.unexpected=function unexpected(atToken){var token=null!=atToken?atToken:this._lexer.token;return syntaxError(this._lexer.source,token.start,"Unexpected ".concat(getTokenDesc(token),"."))},_proto.any=function any(openKind,parseFn,closeKind){this.expectToken(openKind);for(var nodes=[];!this.expectOptionalToken(closeKind);)nodes.push(parseFn.call(this));return nodes},_proto.optionalMany=function optionalMany(openKind,parseFn,closeKind){if(this.expectOptionalToken(openKind)){var nodes=[];do{nodes.push(parseFn.call(this))}while(!this.expectOptionalToken(closeKind));return nodes}return[]},_proto.many=function many(openKind,parseFn,closeKind){this.expectToken(openKind);var nodes=[];do{nodes.push(parseFn.call(this))}while(!this.expectOptionalToken(closeKind));return nodes},_proto.delimitedMany=function delimitedMany(delimiterKind,parseFn){this.expectOptionalToken(delimiterKind);var nodes=[];do{nodes.push(parseFn.call(this))}while(this.expectOptionalToken(delimiterKind));return nodes},Parser}();function getTokenDesc(token){var value=token.value;return getTokenKindDesc(token.kind)+(null!=value?' "'.concat(value,'"'):"")}function getTokenKindDesc(kind){return function isPunctuatorTokenKind(kind){return kind===tokenKind_TokenKind.BANG||kind===tokenKind_TokenKind.DOLLAR||kind===tokenKind_TokenKind.AMP||kind===tokenKind_TokenKind.PAREN_L||kind===tokenKind_TokenKind.PAREN_R||kind===tokenKind_TokenKind.SPREAD||kind===tokenKind_TokenKind.COLON||kind===tokenKind_TokenKind.EQUALS||kind===tokenKind_TokenKind.AT||kind===tokenKind_TokenKind.BRACKET_L||kind===tokenKind_TokenKind.BRACKET_R||kind===tokenKind_TokenKind.BRACE_L||kind===tokenKind_TokenKind.PIPE||kind===tokenKind_TokenKind.BRACE_R}(kind)?'"'.concat(kind,'"'):kind}var QueryDocumentKeys={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},BREAK=Object.freeze({});function getVisitFn(visitor,kind,isLeaving){var kindVisitor=visitor[kind];if(kindVisitor){if(!isLeaving&&"function"==typeof kindVisitor)return kindVisitor;var kindSpecificVisitor=isLeaving?kindVisitor.leave:kindVisitor.enter;if("function"==typeof kindSpecificVisitor)return kindSpecificVisitor}else{var specificVisitor=isLeaving?visitor.leave:visitor.enter;if(specificVisitor){if("function"==typeof specificVisitor)return specificVisitor;var specificKindVisitor=specificVisitor[kind];if("function"==typeof specificKindVisitor)return specificKindVisitor}}}function print(ast){return function visit(root,visitor){var visitorKeys=arguments.length>2&&void 0!==arguments[2]?arguments[2]:QueryDocumentKeys,stack=void 0,inArray=Array.isArray(root),keys=[root],index=-1,edits=[],node=void 0,key=void 0,parent=void 0,path=[],ancestors=[],newRoot=root;do{var isLeaving=++index===keys.length,isEdited=isLeaving&&0!==edits.length;if(isLeaving){if(key=0===ancestors.length?void 0:path[path.length-1],node=parent,parent=ancestors.pop(),isEdited){if(inArray)node=node.slice();else{for(var clone={},_i2=0,_Object$keys2=Object.keys(node);_i2<_Object$keys2.length;_i2++){var k=_Object$keys2[_i2];clone[k]=node[k]}node=clone}for(var editOffset=0,ii=0;ii<edits.length;ii++){var editKey=edits[ii][0],editValue=edits[ii][1];inArray&&(editKey-=editOffset),inArray&&null===editValue?(node.splice(editKey,1),editOffset++):node[editKey]=editValue}}index=stack.index,keys=stack.keys,edits=stack.edits,inArray=stack.inArray,stack=stack.prev}else{if(key=parent?inArray?index:keys[index]:void 0,null==(node=parent?parent[key]:newRoot))continue;parent&&path.push(key)}var _visitorKeys$node$kin,result=void 0;if(!Array.isArray(node)){if(!isNode(node))throw new Error("Invalid AST Node: ".concat(inspect(node),"."));var visitFn=getVisitFn(visitor,node.kind,isLeaving);if(visitFn){if((result=visitFn.call(visitor,node,key,parent,path,ancestors))===BREAK)break;if(!1===result){if(!isLeaving){path.pop();continue}}else if(void 0!==result&&(edits.push([key,result]),!isLeaving)){if(!isNode(result)){path.pop();continue}node=result}}}void 0===result&&isEdited&&edits.push([key,node]),isLeaving?path.pop():(stack={inArray,index,keys,edits,prev:stack},keys=(inArray=Array.isArray(node))?node:null!==(_visitorKeys$node$kin=visitorKeys[node.kind])&&void 0!==_visitorKeys$node$kin?_visitorKeys$node$kin:[],index=-1,edits=[],parent&&ancestors.push(parent),parent=node)}while(void 0!==stack);return 0!==edits.length&&(newRoot=edits[edits.length-1][1]),newRoot}(ast,{leave:printDocASTReducer})}var printDocASTReducer={Name:function Name(node){return node.value},Variable:function Variable(node){return"$"+node.name},Document:function Document(node){return join(node.definitions,"\n\n")+"\n"},OperationDefinition:function OperationDefinition(node){var op=node.operation,name=node.name,varDefs=wrap("(",join(node.variableDefinitions,", "),")"),directives=join(node.directives," "),selectionSet=node.selectionSet;return name||directives||varDefs||"query"!==op?join([op,join([name,varDefs]),directives,selectionSet]," "):selectionSet},VariableDefinition:function VariableDefinition(_ref){var variable=_ref.variable,type=_ref.type,defaultValue=_ref.defaultValue,directives=_ref.directives;return variable+": "+type+wrap(" = ",defaultValue)+wrap(" ",join(directives," "))},SelectionSet:function SelectionSet(_ref2){return block(_ref2.selections)},Field:function Field(_ref3){var alias=_ref3.alias,name=_ref3.name,args=_ref3.arguments,directives=_ref3.directives,selectionSet=_ref3.selectionSet,prefix=wrap("",alias,": ")+name,argsLine=prefix+wrap("(",join(args,", "),")");return argsLine.length>80&&(argsLine=prefix+wrap("(\n",indent(join(args,"\n")),"\n)")),join([argsLine,join(directives," "),selectionSet]," ")},Argument:function Argument(_ref4){return _ref4.name+": "+_ref4.value},FragmentSpread:function FragmentSpread(_ref5){return"..."+_ref5.name+wrap(" ",join(_ref5.directives," "))},InlineFragment:function InlineFragment(_ref6){var typeCondition=_ref6.typeCondition,directives=_ref6.directives,selectionSet=_ref6.selectionSet;return join(["...",wrap("on ",typeCondition),join(directives," "),selectionSet]," ")},FragmentDefinition:function FragmentDefinition(_ref7){var name=_ref7.name,typeCondition=_ref7.typeCondition,variableDefinitions=_ref7.variableDefinitions,directives=_ref7.directives,selectionSet=_ref7.selectionSet;return"fragment ".concat(name).concat(wrap("(",join(variableDefinitions,", "),")")," ")+"on ".concat(typeCondition," ").concat(wrap("",join(directives," ")," "))+selectionSet},IntValue:function IntValue(_ref8){return _ref8.value},FloatValue:function FloatValue(_ref9){return _ref9.value},StringValue:function StringValue(_ref10,key){var value=_ref10.value;return _ref10.block?function printBlockString(value){var indentation=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",preferMultipleLines=arguments.length>2&&void 0!==arguments[2]&&arguments[2],isSingleLine=-1===value.indexOf("\n"),hasLeadingSpace=" "===value[0]||"\t"===value[0],hasTrailingQuote='"'===value[value.length-1],hasTrailingSlash="\\"===value[value.length-1],printAsMultipleLines=!isSingleLine||hasTrailingQuote||hasTrailingSlash||preferMultipleLines,result="";return!printAsMultipleLines||isSingleLine&&hasLeadingSpace||(result+="\n"+indentation),result+=indentation?value.replace(/\n/g,"\n"+indentation):value,printAsMultipleLines&&(result+="\n"),'"""'+result.replace(/"""/g,'\\"""')+'"""'}(value,"description"===key?"":"  "):JSON.stringify(value)},BooleanValue:function BooleanValue(_ref11){return _ref11.value?"true":"false"},NullValue:function NullValue(){return"null"},EnumValue:function EnumValue(_ref12){return _ref12.value},ListValue:function ListValue(_ref13){return"["+join(_ref13.values,", ")+"]"},ObjectValue:function ObjectValue(_ref14){return"{"+join(_ref14.fields,", ")+"}"},ObjectField:function ObjectField(_ref15){return _ref15.name+": "+_ref15.value},Directive:function Directive(_ref16){return"@"+_ref16.name+wrap("(",join(_ref16.arguments,", "),")")},NamedType:function NamedType(_ref17){return _ref17.name},ListType:function ListType(_ref18){return"["+_ref18.type+"]"},NonNullType:function NonNullType(_ref19){return _ref19.type+"!"},SchemaDefinition:addDescription((function(_ref20){var directives=_ref20.directives,operationTypes=_ref20.operationTypes;return join(["schema",join(directives," "),block(operationTypes)]," ")})),OperationTypeDefinition:function OperationTypeDefinition(_ref21){return _ref21.operation+": "+_ref21.type},ScalarTypeDefinition:addDescription((function(_ref22){return join(["scalar",_ref22.name,join(_ref22.directives," ")]," ")})),ObjectTypeDefinition:addDescription((function(_ref23){var name=_ref23.name,interfaces=_ref23.interfaces,directives=_ref23.directives,fields=_ref23.fields;return join(["type",name,wrap("implements ",join(interfaces," & ")),join(directives," "),block(fields)]," ")})),FieldDefinition:addDescription((function(_ref24){var name=_ref24.name,args=_ref24.arguments,type=_ref24.type,directives=_ref24.directives;return name+(hasMultilineItems(args)?wrap("(\n",indent(join(args,"\n")),"\n)"):wrap("(",join(args,", "),")"))+": "+type+wrap(" ",join(directives," "))})),InputValueDefinition:addDescription((function(_ref25){var name=_ref25.name,type=_ref25.type,defaultValue=_ref25.defaultValue,directives=_ref25.directives;return join([name+": "+type,wrap("= ",defaultValue),join(directives," ")]," ")})),InterfaceTypeDefinition:addDescription((function(_ref26){var name=_ref26.name,interfaces=_ref26.interfaces,directives=_ref26.directives,fields=_ref26.fields;return join(["interface",name,wrap("implements ",join(interfaces," & ")),join(directives," "),block(fields)]," ")})),UnionTypeDefinition:addDescription((function(_ref27){var name=_ref27.name,directives=_ref27.directives,types=_ref27.types;return join(["union",name,join(directives," "),types&&0!==types.length?"= "+join(types," | "):""]," ")})),EnumTypeDefinition:addDescription((function(_ref28){var name=_ref28.name,directives=_ref28.directives,values=_ref28.values;return join(["enum",name,join(directives," "),block(values)]," ")})),EnumValueDefinition:addDescription((function(_ref29){return join([_ref29.name,join(_ref29.directives," ")]," ")})),InputObjectTypeDefinition:addDescription((function(_ref30){var name=_ref30.name,directives=_ref30.directives,fields=_ref30.fields;return join(["input",name,join(directives," "),block(fields)]," ")})),DirectiveDefinition:addDescription((function(_ref31){var name=_ref31.name,args=_ref31.arguments,repeatable=_ref31.repeatable,locations=_ref31.locations;return"directive @"+name+(hasMultilineItems(args)?wrap("(\n",indent(join(args,"\n")),"\n)"):wrap("(",join(args,", "),")"))+(repeatable?" repeatable":"")+" on "+join(locations," | ")})),SchemaExtension:function SchemaExtension(_ref32){var directives=_ref32.directives,operationTypes=_ref32.operationTypes;return join(["extend schema",join(directives," "),block(operationTypes)]," ")},ScalarTypeExtension:function ScalarTypeExtension(_ref33){return join(["extend scalar",_ref33.name,join(_ref33.directives," ")]," ")},ObjectTypeExtension:function ObjectTypeExtension(_ref34){var name=_ref34.name,interfaces=_ref34.interfaces,directives=_ref34.directives,fields=_ref34.fields;return join(["extend type",name,wrap("implements ",join(interfaces," & ")),join(directives," "),block(fields)]," ")},InterfaceTypeExtension:function InterfaceTypeExtension(_ref35){var name=_ref35.name,interfaces=_ref35.interfaces,directives=_ref35.directives,fields=_ref35.fields;return join(["extend interface",name,wrap("implements ",join(interfaces," & ")),join(directives," "),block(fields)]," ")},UnionTypeExtension:function UnionTypeExtension(_ref36){var name=_ref36.name,directives=_ref36.directives,types=_ref36.types;return join(["extend union",name,join(directives," "),types&&0!==types.length?"= "+join(types," | "):""]," ")},EnumTypeExtension:function EnumTypeExtension(_ref37){var name=_ref37.name,directives=_ref37.directives,values=_ref37.values;return join(["extend enum",name,join(directives," "),block(values)]," ")},InputObjectTypeExtension:function InputObjectTypeExtension(_ref38){var name=_ref38.name,directives=_ref38.directives,fields=_ref38.fields;return join(["extend input",name,join(directives," "),block(fields)]," ")}};function addDescription(cb){return function(node){return join([node.description,cb(node)],"\n")}}function join(maybeArray){var _maybeArray$filter$jo,separator=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null!==(_maybeArray$filter$jo=null==maybeArray?void 0:maybeArray.filter((function(x){return x})).join(separator))&&void 0!==_maybeArray$filter$jo?_maybeArray$filter$jo:""}function block(array){return wrap("{\n",indent(join(array,"\n")),"\n}")}function wrap(start,maybeString){return null!=maybeString&&""!==maybeString?start+maybeString+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:""):""}function indent(str){return wrap("  ",str.replace(/\n/g,"\n  "))}function isMultiline(str){return-1!==str.indexOf("\n")}function hasMultilineItems(maybeArray){return null!=maybeArray&&maybeArray.some(isMultiline)}var isArrayLike=function(x){return x&&"number"==typeof x.length&&"function"!=typeof x};function isPromise(value){return isFunction(null==value?void 0:value.then)}function isInteropObservable(input){return isFunction(input[observable])}function isAsyncIterable(obj){return Symbol.asyncIterator&&isFunction(null==obj?void 0:obj[Symbol.asyncIterator])}function createInvalidObservableTypeError(input){return new TypeError("You provided "+(null!==input&&"object"==typeof input?"an invalid object":"'"+input+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var iterator_iterator=function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function isIterable(input){return isFunction(null==input?void 0:input[iterator_iterator])}function readableStreamLikeToAsyncGenerator(readableStream){return(0,tslib_es6.AQ)(this,arguments,(function readableStreamLikeToAsyncGenerator_1(){var reader,_a,value;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:reader=readableStream.getReader(),_b.label=1;case 1:_b.trys.push([1,,9,10]),_b.label=2;case 2:return[4,(0,tslib_es6.N3)(reader.read())];case 3:return _a=_b.sent(),value=_a.value,_a.done?[4,(0,tslib_es6.N3)(void 0)]:[3,5];case 4:return[2,_b.sent()];case 5:return[4,(0,tslib_es6.N3)(value)];case 6:return[4,_b.sent()];case 7:return _b.sent(),[3,2];case 8:return[3,10];case 9:return reader.releaseLock(),[7];case 10:return[2]}}))}))}function isReadableStreamLike(obj){return isFunction(null==obj?void 0:obj.getReader)}function innerFrom(input){if(input instanceof Observable)return input;if(null!=input){if(isInteropObservable(input))return function fromInteropObservable(obj){return new Observable((function(subscriber){var obs=obj[observable]();if(isFunction(obs.subscribe))return obs.subscribe(subscriber);throw new TypeError("Provided object does not correctly implement Symbol.observable")}))}(input);if(isArrayLike(input))return function fromArrayLike(array){return new Observable((function(subscriber){for(var i=0;i<array.length&&!subscriber.closed;i++)subscriber.next(array[i]);subscriber.complete()}))}(input);if(isPromise(input))return function fromPromise(promise){return new Observable((function(subscriber){promise.then((function(value){subscriber.closed||(subscriber.next(value),subscriber.complete())}),(function(err){return subscriber.error(err)})).then(null,reportUnhandledError)}))}(input);if(isAsyncIterable(input))return fromAsyncIterable(input);if(isIterable(input))return function fromIterable(iterable){return new Observable((function(subscriber){var e_1,_a;try{for(var iterable_1=(0,tslib_es6.Ju)(iterable),iterable_1_1=iterable_1.next();!iterable_1_1.done;iterable_1_1=iterable_1.next()){var value=iterable_1_1.value;if(subscriber.next(value),subscriber.closed)return}}catch(e_1_1){e_1={error:e_1_1}}finally{try{iterable_1_1&&!iterable_1_1.done&&(_a=iterable_1.return)&&_a.call(iterable_1)}finally{if(e_1)throw e_1.error}}subscriber.complete()}))}(input);if(isReadableStreamLike(input))return function fromReadableStreamLike(readableStream){return fromAsyncIterable(readableStreamLikeToAsyncGenerator(readableStream))}(input)}throw createInvalidObservableTypeError(input)}function fromAsyncIterable(asyncIterable){return new Observable((function(subscriber){(function process(asyncIterable,subscriber){var asyncIterable_1,asyncIterable_1_1,e_2,_a;return(0,tslib_es6.sH)(this,void 0,void 0,(function(){var value,e_2_1;return(0,tslib_es6.YH)(this,(function(_b){switch(_b.label){case 0:_b.trys.push([0,5,6,11]),asyncIterable_1=(0,tslib_es6.xN)(asyncIterable),_b.label=1;case 1:return[4,asyncIterable_1.next()];case 2:if((asyncIterable_1_1=_b.sent()).done)return[3,4];if(value=asyncIterable_1_1.value,subscriber.next(value),subscriber.closed)return[2];_b.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return e_2_1=_b.sent(),e_2={error:e_2_1},[3,11];case 6:return _b.trys.push([6,,9,10]),asyncIterable_1_1&&!asyncIterable_1_1.done&&(_a=asyncIterable_1.return)?[4,_a.call(asyncIterable_1)]:[3,8];case 7:_b.sent(),_b.label=8;case 8:return[3,10];case 9:if(e_2)throw e_2.error;return[7];case 10:return[7];case 11:return subscriber.complete(),[2]}}))}))})(asyncIterable,subscriber).catch((function(err){return subscriber.error(err)}))}))}function catchError(selector){return operate((function(source,subscriber){var handledResult,innerSub=null,syncUnsub=!1;innerSub=source.subscribe(createOperatorSubscriber(subscriber,void 0,void 0,(function(err){handledResult=innerFrom(selector(err,catchError(selector)(source))),innerSub?(innerSub.unsubscribe(),innerSub=null,handledResult.subscribe(subscriber)):syncUnsub=!0}))),syncUnsub&&(innerSub.unsubscribe(),innerSub=null,handledResult.subscribe(subscriber))}))}const amplifyUrl_AmplifyUrl=URL,amplifyUrl_AmplifyUrlSearchParams=URLSearchParams;var helpers_process=__webpack_require__("./node_modules/process/browser.js");const globalExists=()=>void 0!==__webpack_require__.g,windowExists=()=>"undefined"!=typeof window,documentExists=()=>"undefined"!=typeof document,processExists=()=>void 0!==helpers_process,keyPrefixMatch=(object,prefix)=>!!Object.keys(object).find((key=>key.startsWith(prefix)));var React_process=__webpack_require__("./node_modules/process/browser.js");var Svelte_process=__webpack_require__("./node_modules/process/browser.js");var Angular_process=__webpack_require__("./node_modules/process/browser.js");const detectionMap=[{platform:Framework.Expo,detectionMethod:function expoDetect(){return globalExists()&&void 0!==__webpack_require__.g.expo}},{platform:Framework.ReactNative,detectionMethod:function reactNativeDetect(){return"undefined"!=typeof navigator&&void 0!==navigator.product&&"ReactNative"===navigator.product}},{platform:Framework.NextJs,detectionMethod:function nextWebDetect(){return windowExists()&&window.next&&"object"==typeof window.next}},{platform:Framework.Nuxt,detectionMethod:function nuxtWebDetect(){return windowExists()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:Framework.Angular,detectionMethod:function angularWebDetect(){const angularVersionSetInDocument=Boolean(documentExists()&&document.querySelector("[ng-version]")),angularContentSetInWindow=Boolean(windowExists()&&void 0!==window.ng);return angularVersionSetInDocument||angularContentSetInWindow}},{platform:Framework.React,detectionMethod:function reactWebDetect(){const elementKeyPrefixedWithReact=key=>key.startsWith("_react")||key.startsWith("__react");return documentExists()&&Array.from(document.querySelectorAll("[id]")).some((element=>Object.keys(element).find(elementKeyPrefixedWithReact)))}},{platform:Framework.VueJs,detectionMethod:function vueWebDetect(){return windowExists()&&keyPrefixMatch(window,"__VUE")}},{platform:Framework.Svelte,detectionMethod:function svelteWebDetect(){return windowExists()&&keyPrefixMatch(window,"__SVELTE")}},{platform:Framework.WebUnknown,detectionMethod:function webDetect(){return windowExists()}},{platform:Framework.NextJsSSR,detectionMethod:function nextSSRDetect(){return globalExists()&&(keyPrefixMatch(__webpack_require__.g,"__next")||keyPrefixMatch(__webpack_require__.g,"__NEXT"))}},{platform:Framework.NuxtSSR,detectionMethod:function nuxtSSRDetect(){return globalExists()&&void 0!==__webpack_require__.g.__NUXT_PATHS__}},{platform:Framework.ReactSSR,detectionMethod:function reactSSRDetect(){return processExists()&&void 0!==React_process.env&&!!Object.keys(React_process.env).find((key=>key.includes("react")))}},{platform:Framework.VueJsSSR,detectionMethod:function vueSSRDetect(){return globalExists()&&keyPrefixMatch(__webpack_require__.g,"__VUE")}},{platform:Framework.AngularSSR,detectionMethod:function angularSSRDetect(){return processExists()&&"object"==typeof Angular_process.env&&Angular_process.env.npm_lifecycle_script?.startsWith("ng ")||!1}},{platform:Framework.SvelteSSR,detectionMethod:function svelteSSRDetect(){return processExists()&&void 0!==Svelte_process.env&&!!Object.keys(Svelte_process.env).find((key=>key.includes("svelte")))}}];let frameworkCache;const frameworkChangeObservers=[];let resetTriggered=!1;const detectFramework=()=>{if(!frameworkCache){if(frameworkCache=function detect(){return detectionMap.find((detectionEntry=>detectionEntry.detectionMethod()))?.platform||Framework.ServerSideUnknown}(),resetTriggered)for(;frameworkChangeObservers.length;)frameworkChangeObservers.pop()?.();else frameworkChangeObservers.forEach((fcn=>{fcn()}));resetTimeout(Framework.ServerSideUnknown,10),resetTimeout(Framework.WebUnknown,10)}return frameworkCache};function resetTimeout(framework,delay){frameworkCache!==framework||resetTriggered||setTimeout((()=>{!function clearCache(){frameworkCache=void 0}(),resetTriggered=!0,setTimeout(detectFramework,1e3)}),delay)}const customUserAgentState={},sanitizeAmplifyVersion=amplifyVersion=>amplifyVersion.replace(/\+.*/,"");new class PlatformBuilder{constructor(){this.userAgent=`aws-amplify/${sanitizeAmplifyVersion("6.8.2")}`}get framework(){return detectFramework()}get isReactNative(){return this.framework===Framework.ReactNative||this.framework===Framework.Expo}observeFrameworkChanges(fcn){(fcn=>{resetTriggered||frameworkChangeObservers.push(fcn)})(fcn)}};const getAmplifyUserAgentObject=({category,action}={})=>{const userAgent=[["aws-amplify",sanitizeAmplifyVersion("6.8.2")]];if(category&&userAgent.push([category,action]),userAgent.push(["framework",detectFramework()]),category&&action){const customState=((category,api)=>customUserAgentState[category]?.[api]?.additionalDetails)(category,action);customState&&customState.forEach((state=>{userAgent.push(state)}))}return userAgent},getAmplifyUserAgent=customUserAgentDetails=>getAmplifyUserAgentObject(customUserAgentDetails).map((([agentKey,agentValue])=>agentKey&&agentValue?`${agentKey}/${agentValue}`:agentKey)).join(" ");class ApiError extends AmplifyError_AmplifyError{get response(){return this._response?replicateApiErrorResponse(this._response):void 0}constructor(params){super(params),this.constructor=ApiError,Object.setPrototypeOf(this,ApiError.prototype),params.response&&(this._response=params.response)}}const replicateApiErrorResponse=response=>({...response,headers:{...response.headers}});class RestApiError_RestApiError extends ApiError{constructor(params){super(params),this.constructor=RestApiError_RestApiError,Object.setPrototypeOf(this,RestApiError_RestApiError.prototype)}}class CanceledError extends RestApiError_RestApiError{constructor(params={}){super({name:"CanceledError",message:"Request is canceled by user",...params}),this.constructor=CanceledError,Object.setPrototypeOf(this,CanceledError.prototype)}}const isCancelError=error=>!!error&&error instanceof CanceledError;var validation_RestApiValidationErrorCode;!function(RestApiValidationErrorCode){RestApiValidationErrorCode.InvalidApiName="InvalidApiName"}(validation_RestApiValidationErrorCode||(validation_RestApiValidationErrorCode={}));validation_RestApiValidationErrorCode.InvalidApiName;const parseMetadata=response=>{const{headers,statusCode}=response;return{...isMetadataBearer(response)?response.$metadata:{},httpStatusCode:statusCode,requestId:headers["x-amzn-requestid"]??headers["x-amzn-request-id"]??headers["x-amz-request-id"],extendedRequestId:headers["x-amz-id-2"],cfId:headers["x-amz-cf-id"]}},isMetadataBearer=response=>"object"==typeof response?.$metadata,parseJsonBody=async response=>{if(!response.body)throw new Error("Missing response payload");const output=await response.body.json();return Object.assign(output,{$metadata:parseMetadata(response)})},parseRestApiServiceError=async response=>{if(!response)return;const parsedAwsError=await(async response=>{if(!response||response.statusCode<300)return;const body=await parseJsonBody(response),code=(rawValue=>{const[cleanValue]=rawValue.toString().split(/[,:]+/);return cleanValue.includes("#")?cleanValue.split("#")[1]:cleanValue})(response.headers["x-amzn-errortype"]??body.code??body.__type??"UnknownError"),message=body.message??body.Message??"Unknown error",error=new Error(message);return Object.assign(error,{name:code,$metadata:parseMetadata(response)})})(stubErrorResponse(response));if(parsedAwsError){const bodyText=await(response.body?.text());return buildRestApiError(parsedAwsError,{statusCode:response.statusCode,headers:response.headers,body:bodyText})}},stubErrorResponse=response=>{let bodyTextPromise;const bodyProxy=new Proxy(response.body,{get:(target,prop,receiver)=>"json"===prop?async()=>{bodyTextPromise||(bodyTextPromise=target.text());try{return JSON.parse(await bodyTextPromise)}catch(error){return{}}}:"text"===prop?async()=>(bodyTextPromise||(bodyTextPromise=target.text()),bodyTextPromise):Reflect.get(target,prop,receiver)});return new Proxy(response,{get:(target,prop,receiver)=>"body"===prop?bodyProxy:Reflect.get(target,prop,receiver)})},buildRestApiError=(error,response)=>{const restApiError=new RestApiError_RestApiError({name:error?.name,message:error.message,underlyingError:error,response});return Object.assign(restApiError,{$metadata:error.$metadata})},logger_logger=new ConsoleLogger("RestApis");var AmplifyErrorCode;!function(AmplifyErrorCode){AmplifyErrorCode.NoEndpointId="NoEndpointId",AmplifyErrorCode.PlatformNotSupported="PlatformNotSupported",AmplifyErrorCode.Unknown="Unknown",AmplifyErrorCode.NetworkError="NetworkError"}(AmplifyErrorCode||(AmplifyErrorCode={}));const CLOCK_SKEW_ERROR_CODES=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],getRetryDecider=errorParser=>async(response,error)=>{const parsedError=error??await errorParser(response)??void 0,errorCode=parsedError?.code||parsedError?.name,statusCode=response?.statusCode;return isConnectionError(error)||isThrottlingError(statusCode,errorCode)||(errorCode=>!!errorCode&&CLOCK_SKEW_ERROR_CODES.includes(errorCode))(errorCode)||isServerSideError(statusCode,errorCode)},THROTTLING_ERROR_CODES=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],TIMEOUT_ERROR_CODES=["TimeoutError","RequestTimeout","RequestTimeoutException"],isThrottlingError=(statusCode,errorCode)=>429===statusCode||!!errorCode&&THROTTLING_ERROR_CODES.includes(errorCode),isConnectionError=error=>[AmplifyErrorCode.NetworkError,"ERR_NETWORK"].includes(error?.name),isServerSideError=(statusCode,errorCode)=>!!statusCode&&[500,502,503,504].includes(statusCode)||!!errorCode&&TIMEOUT_ERROR_CODES.includes(errorCode);function jitteredBackoff(maxDelayMs=3e5){return attempt=>{const delay=2**attempt*100+100*Math.random();return!(delay>maxDelayMs)&&delay}}const jitteredBackoff_jitteredBackoff=attempt=>{const delay=jitteredBackoff(3e5)(attempt);return!1===delay?3e5:delay},retryMiddlewareFactory=({maxAttempts=3,retryDecider,computeDelay,abortSignal})=>{if(maxAttempts<1)throw new Error("maxAttempts must be greater than 0");return(next,context)=>async function retryMiddleware(request){let error,response,attemptsCount=context.attemptsCount??0;const handleTerminalErrorOrResponse=()=>{if(response)return addOrIncrementMetadataAttempts(response,attemptsCount),response;throw addOrIncrementMetadataAttempts(error,attemptsCount),error};for(;!abortSignal?.aborted&&attemptsCount<maxAttempts;){try{response=await next(request),error=void 0}catch(e){error=e,response=void 0}if(attemptsCount=(context.attemptsCount??0)>attemptsCount?context.attemptsCount??0:attemptsCount+1,context.attemptsCount=attemptsCount,!await retryDecider(response,error))return handleTerminalErrorOrResponse();if(!abortSignal?.aborted&&attemptsCount<maxAttempts){const delay=computeDelay(attemptsCount);await cancellableSleep(delay,abortSignal)}}if(abortSignal?.aborted)throw new Error("Request aborted.");return handleTerminalErrorOrResponse()}},cancellableSleep=(timeoutMs,abortSignal)=>{if(abortSignal?.aborted)return Promise.resolve();let timeoutId,sleepPromiseResolveFn;const sleepPromise=new Promise((resolve=>{sleepPromiseResolveFn=resolve,timeoutId=setTimeout(resolve,timeoutMs)}));return abortSignal?.addEventListener("abort",(function cancelSleep(_){clearTimeout(timeoutId),abortSignal?.removeEventListener("abort",cancelSleep),sleepPromiseResolveFn()})),sleepPromise},addOrIncrementMetadataAttempts=(nextHandlerOutput,attempts)=>{"[object Object]"===Object.prototype.toString.call(nextHandlerOutput)&&(nextHandlerOutput.$metadata={...nextHandlerOutput.$metadata??{},attempts})},getSignedHeaders=headers=>Object.keys(headers).map((key=>key.toLowerCase())).sort().join(";"),AMZ_DATE_HEADER="X-Amz-Date".toLowerCase(),TOKEN_HEADER="X-Amz-Security-Token".toLowerCase(),SHA256_ALGORITHM_IDENTIFIER="AWS4-HMAC-SHA256";var KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],MAX_HASHABLE_LENGTH=Math.pow(2,53)-1,RawSha256=function(){function RawSha256(){this.state=Int32Array.from(INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return RawSha256.prototype.update=function(data){if(this.finished)throw new Error("Attempted to update an already finished hash.");var position=0,byteLength=data.byteLength;if(this.bytesHashed+=byteLength,8*this.bytesHashed>MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;byteLength>0;)this.buffer[this.bufferLength++]=data[position++],byteLength--,64===this.bufferLength&&(this.hashBuffer(),this.bufferLength=0)},RawSha256.prototype.digest=function(){if(!this.finished){var bitsHashed=8*this.bytesHashed,bufferView=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),undecoratedLength=this.bufferLength;if(bufferView.setUint8(this.bufferLength++,128),undecoratedLength%64>=56){for(var i=this.bufferLength;i<64;i++)bufferView.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(i=this.bufferLength;i<56;i++)bufferView.setUint8(i,0);bufferView.setUint32(56,Math.floor(bitsHashed/4294967296),!0),bufferView.setUint32(60,bitsHashed),this.hashBuffer(),this.finished=!0}var out=new Uint8Array(32);for(i=0;i<8;i++)out[4*i]=this.state[i]>>>24&255,out[4*i+1]=this.state[i]>>>16&255,out[4*i+2]=this.state[i]>>>8&255,out[4*i+3]=this.state[i]>>>0&255;return out},RawSha256.prototype.hashBuffer=function(){for(var buffer=this.buffer,state=this.state,state0=state[0],state1=state[1],state2=state[2],state3=state[3],state4=state[4],state5=state[5],state6=state[6],state7=state[7],i=0;i<64;i++){if(i<16)this.temp[i]=(255&buffer[4*i])<<24|(255&buffer[4*i+1])<<16|(255&buffer[4*i+2])<<8|255&buffer[4*i+3];else{var u=this.temp[i-2],t1_1=(u>>>17|u<<15)^(u>>>19|u<<13)^u>>>10,t2_1=((u=this.temp[i-15])>>>7|u<<25)^(u>>>18|u<<14)^u>>>3;this.temp[i]=(t1_1+this.temp[i-7]|0)+(t2_1+this.temp[i-16]|0)}var t1=(((state4>>>6|state4<<26)^(state4>>>11|state4<<21)^(state4>>>25|state4<<7))+(state4&state5^~state4&state6)|0)+(state7+(KEY[i]+this.temp[i]|0)|0)|0,t2=((state0>>>2|state0<<30)^(state0>>>13|state0<<19)^(state0>>>22|state0<<10))+(state0&state1^state0&state2^state1&state2)|0;state7=state6,state6=state5,state5=state4,state4=state3+t1|0,state3=state2,state2=state1,state1=state0,state0=t1+t2|0}state[0]+=state0,state[1]+=state1,state[2]+=state2,state[3]+=state3,state[4]+=state4,state[5]+=state5,state[6]+=state6,state[7]+=state7},RawSha256}();var Buffer=__webpack_require__("./node_modules/node-polyfill-webpack-plugin/node_modules/buffer/index.js").hp,convertToBuffer_fromUtf8=void 0!==Buffer&&Buffer.from?function(input){return Buffer.from(input,"utf8")}:input=>(new TextEncoder).encode(input);function convertToBuffer(data){return data instanceof Uint8Array?data:"string"==typeof data?convertToBuffer_fromUtf8(data):ArrayBuffer.isView(data)?new Uint8Array(data.buffer,data.byteOffset,data.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(data)}var Sha256=function(){function Sha256(secret){this.secret=secret,this.hash=new RawSha256,this.reset()}return Sha256.prototype.update=function(toHash){if(!function isEmptyData(data){return"string"==typeof data?0===data.length:0===data.byteLength}(toHash)&&!this.error)try{this.hash.update(convertToBuffer(toHash))}catch(e){this.error=e}},Sha256.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},Sha256.prototype.digest=function(){return(0,tslib_es6.sH)(this,void 0,void 0,(function(){return(0,tslib_es6.YH)(this,(function(_a){return[2,this.digestSync()]}))}))},Sha256.prototype.reset=function(){if(this.hash=new RawSha256,this.secret){this.outer=new RawSha256;var inner=function bufferFromSecret(secret){var input=convertToBuffer(secret);if(input.byteLength>64){var bufferHash=new RawSha256;bufferHash.update(input),input=bufferHash.digest()}var buffer=new Uint8Array(64);return buffer.set(input),buffer}(this.secret),outer=new Uint8Array(64);outer.set(inner);for(var i=0;i<64;i++)inner[i]^=54,outer[i]^=92;this.hash.update(inner),this.outer.update(outer);for(i=0;i<inner.byteLength;i++)inner[i]=0}},Sha256}();const SHORT_TO_HEX={},HEX_TO_SHORT={};for(let i=0;i<256;i++){let encodedByte=i.toString(16).toLowerCase();1===encodedByte.length&&(encodedByte=`0${encodedByte}`),SHORT_TO_HEX[i]=encodedByte,HEX_TO_SHORT[encodedByte]=i}const getHashedData=(key,data)=>{const sha256=new Sha256(key??void 0);sha256.update(data);return sha256.digestSync()},getHashedDataAsHex=(key,data)=>function toHex(bytes){let out="";for(let i=0;i<bytes.byteLength;i++)out+=SHORT_TO_HEX[bytes[i]];return out}(getHashedData(key,data)),getCanonicalHeaders=headers=>Object.entries(headers).map((([key,value])=>({key:key.toLowerCase(),value:value?.trim().replace(/\s+/g," ")??""}))).sort(((a,b)=>a.key<b.key?-1:1)).map((entry=>`${entry.key}:${entry.value}\n`)).join(""),escapeUri=uri=>encodeURIComponent(uri).replace(/[!'()*]/g,hexEncode),hexEncode=c=>`%${c.charCodeAt(0).toString(16).toUpperCase()}`,getCanonicalUri=(pathname,uriEscapePath=!0)=>pathname?uriEscapePath?encodeURIComponent(pathname).replace(/%2F/g,"/"):pathname:"/",getHashedPayload=body=>{if(null==body)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(isSourceData(body)){return getHashedDataAsHex(null,body)}return"UNSIGNED-PAYLOAD"},isSourceData=body=>"string"==typeof body||ArrayBuffer.isView(body)||isArrayBuffer(body),isArrayBuffer=arg=>"function"==typeof ArrayBuffer&&arg instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(arg),getSignature=(request,{credentialScope,longDate,secretAccessKey,shortDate,signingRegion,signingService,uriEscapePath})=>{const canonicalRequest=(({body,headers,method,url},uriEscapePath=!0)=>{return[method,getCanonicalUri(url.pathname,uriEscapePath),(searchParams=url.searchParams,Array.from(searchParams).sort((([keyA,valA],[keyB,valB])=>keyA===keyB?valA<valB?-1:1:keyA<keyB?-1:1)).map((([key,val])=>`${escapeUri(key)}=${escapeUri(val)}`)).join("&")),getCanonicalHeaders(headers),getSignedHeaders(headers),getHashedPayload(body)].join("\n");var searchParams})(request,uriEscapePath),stringToSign=((date,credentialScope,hashedRequest)=>[SHA256_ALGORITHM_IDENTIFIER,date,credentialScope,hashedRequest].join("\n"))(longDate,credentialScope,getHashedDataAsHex(null,canonicalRequest)),signature=getHashedDataAsHex(((secretAccessKey,date,region,service)=>{const dateKey=getHashedData(`AWS4${secretAccessKey}`,date),regionKey=getHashedData(dateKey,region),serviceKey=getHashedData(regionKey,service);return getHashedData(serviceKey,"aws4_request")})(secretAccessKey,shortDate,signingRegion,signingService),stringToSign);return signature},signRequest=(request,options)=>{const signingValues=(({credentials,signingDate=new Date,signingRegion,signingService,uriEscapePath=!0})=>{const{accessKeyId,secretAccessKey,sessionToken}=credentials,{longDate,shortDate}=(date=>{const longDate=date.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate,shortDate:longDate.slice(0,8)}})(signingDate);return{accessKeyId,credentialScope:`${shortDate}/${signingRegion}/${signingService}/aws4_request`,longDate,secretAccessKey,sessionToken,shortDate,signingRegion,signingService,uriEscapePath}})(options),{accessKeyId,credentialScope,longDate,sessionToken}=signingValues,headers={...request.headers};headers.host=request.url.host,headers[AMZ_DATE_HEADER]=longDate,sessionToken&&(headers[TOKEN_HEADER]=sessionToken);const requestToSign={...request,headers},signature=getSignature(requestToSign,signingValues),credentialEntry=`Credential=${accessKeyId}/${credentialScope}`,signedHeadersEntry=`SignedHeaders=${getSignedHeaders(headers)}`,signatureEntry=`Signature=${signature}`;return headers.authorization=`${SHA256_ALGORITHM_IDENTIFIER} ${credentialEntry}, ${signedHeadersEntry}, ${signatureEntry}`,requestToSign},getSkewCorrectedDate=systemClockOffset=>new Date(Date.now()+systemClockOffset),getUpdatedSystemClockOffset=(clockTimeInMilliseconds,currentSystemClockOffset)=>((clockTimeInMilliseconds,clockOffsetInMilliseconds)=>Math.abs(getSkewCorrectedDate(clockOffsetInMilliseconds).getTime()-clockTimeInMilliseconds)>=3e5)(clockTimeInMilliseconds,currentSystemClockOffset)?clockTimeInMilliseconds-Date.now():currentSystemClockOffset,getDateHeader=({headers}={})=>headers?.date??headers?.Date??headers?.["x-amz-date"],userAgentMiddlewareFactory=({userAgentHeader="x-amz-user-agent",userAgentValue=""})=>next=>async function userAgentMiddleware(request){if(0===userAgentValue.trim().length){return await next(request)}{const headerName=userAgentHeader.toLowerCase();request.headers[headerName]=request.headers[headerName]?`${request.headers[headerName]} ${userAgentValue}`:userAgentValue;return await next(request)}},composeTransferHandler=(coreHandler,middleware)=>(request,options)=>{const context={};let composedHandler=composeHandlerRequest=>coreHandler(composeHandlerRequest,options);for(let i=middleware.length-1;i>=0;i--){composedHandler=(0,middleware[i])(options)(composedHandler,context)}return composedHandler(request)},withMemoization=payloadAccessor=>{let cached;return()=>(cached||(cached=payloadAccessor()),cached)},shouldSendBody=method=>!["HEAD","GET","DELETE"].includes(method.toUpperCase()),fetchTransferHandler=async({url,method,headers,body},{abortSignal,cache,withCrossDomainCredentials})=>{let resp;try{resp=await fetch(url,{method,headers,body:shouldSendBody(method)?body:void 0,signal:abortSignal,cache,credentials:withCrossDomainCredentials?"include":"same-origin"})}catch(e){if(e instanceof TypeError)throw new AmplifyError_AmplifyError({name:AmplifyErrorCode.NetworkError,message:"A network error has occurred.",underlyingError:e});throw e}const responseHeaders={};resp.headers?.forEach(((value,key)=>{responseHeaders[key.toLowerCase()]=value}));return{...{statusCode:resp.status,headers:responseHeaders,body:null},body:Object.assign(resp.body??{},{text:withMemoization((()=>resp.text())),blob:withMemoization((()=>resp.blob())),json:withMemoization((()=>resp.json()))})}},authenticatedHandler=composeTransferHandler(fetchTransferHandler,[userAgentMiddlewareFactory,retryMiddlewareFactory,({credentials,region,service,uriEscapePath=!0})=>{let currentSystemClockOffset;return next=>async function signingMiddleware(request){currentSystemClockOffset=currentSystemClockOffset??0;const signRequestOptions={credentials:"function"==typeof credentials?await credentials():credentials,signingDate:getSkewCorrectedDate(currentSystemClockOffset),signingRegion:region,signingService:service,uriEscapePath},signedRequest=await signRequest(request,signRequestOptions),response=await next(signedRequest),dateString=getDateHeader(response);return dateString&&(currentSystemClockOffset=getUpdatedSystemClockOffset(Date.parse(dateString),currentSystemClockOffset)),response}}]),unauthenticatedHandler=composeTransferHandler(fetchTransferHandler,[userAgentMiddlewareFactory,retryMiddlewareFactory]),DEFAULT_REST_IAM_SIGNING_SERVICE="execute-api",DEFAULT_IAM_SIGNING_REGION="us-east-1",APIG_HOSTNAME_PATTERN=/^.+\.([a-z0-9-]+)\.([a-z0-9-]+)\.amazonaws\.com/,handler_transferHandler=async(amplify,options,iamAuthApplicable,signingServiceInfo)=>{const{url,method,headers,body,withCredentials,abortSignal}=options,resolvedBody=body?body instanceof FormData?body:JSON.stringify(body??""):void 0,resolvedHeaders=((headers,body)=>{const normalizedHeaders={};for(const key in headers)normalizedHeaders[key.toLowerCase()]=headers[key];return body&&(normalizedHeaders["content-type"]="application/json; charset=UTF-8",body instanceof FormData&&delete normalizedHeaders["content-type"]),normalizedHeaders})(headers,body),request={url,headers:resolvedHeaders,method,body:resolvedBody},baseOptions={retryDecider:getRetryDecider(parseRestApiServiceError),computeDelay:jitteredBackoff_jitteredBackoff,withCrossDomainCredentials:withCredentials,abortSignal},isIamAuthApplicable=iamAuthApplicable(request,signingServiceInfo);let response;const credentials=await resolveCredentials(amplify);if(isIamAuthApplicable&&credentials){const signingInfoFromUrl=((url,restApiOptions)=>{const{service:signingService=DEFAULT_REST_IAM_SIGNING_SERVICE,region:signingRegion=DEFAULT_IAM_SIGNING_REGION}=restApiOptions?.amplify.getConfig()?.API?.REST?.[restApiOptions?.apiName]??{},{hostname}=url,[,service,region]=APIG_HOSTNAME_PATTERN.exec(hostname)??[];return service===DEFAULT_REST_IAM_SIGNING_SERVICE?{service,region:region??signingRegion}:"appsync-api"===service?{service:"appsync",region:region??signingRegion}:{service:signingService,region:signingRegion}})(url),signingService=signingServiceInfo?.service??signingInfoFromUrl.service,signingRegion=signingServiceInfo?.region??signingInfoFromUrl.region;response=await authenticatedHandler(request,{...baseOptions,credentials,region:signingRegion,service:signingService})}else response=await unauthenticatedHandler(request,{...baseOptions});return{statusCode:response.statusCode,headers:response.headers,body:response.body}},resolveCredentials=async amplify=>{try{const{credentials}=await amplify.Auth.fetchAuthSession();if(credentials)return credentials}catch(e){logger_logger.debug("No credentials available, the request will be unsigned.")}return null},isIamAuthApplicableForGraphQL=({headers},signingServiceInfo)=>!headers.authorization&&!headers["x-api-key"]&&!!signingServiceInfo,cancelTokenMap=new WeakMap,internalPost_post=(amplify,{url,options,abortController})=>{const controller=abortController??new AbortController,responsePromise=function createCancellableOperation_createCancellableOperation(handler,abortController){const isInternalPost=targetHandler=>!!abortController,publicApisAbortController=new AbortController,publicApisAbortSignal=publicApisAbortController.signal,internalPostAbortSignal=abortController?.signal;let abortReason;const job=async()=>{try{const response=await(isInternalPost()?handler():handler(publicApisAbortSignal));if(response.statusCode>=300)throw await parseRestApiServiceError(response);return response}catch(error){const abortSignal=internalPostAbortSignal??publicApisAbortSignal,message=abortReason??abortSignal.reason;if("AbortError"===error.name||!0===abortSignal?.aborted){const canceledError=new CanceledError({...message&&{message},underlyingError:error,recoverySuggestion:"The API request was explicitly canceled. If this is not intended, validate if you called the `cancel()` function on the API request erroneously."});throw logger_logger.debug(error),canceledError}throw logger_logger.debug(error),error}};if(isInternalPost())return job();{const cancel=abortMessage=>{!0!==publicApisAbortSignal.aborted&&(publicApisAbortController.abort(abortMessage),abortMessage&&publicApisAbortSignal.reason!==abortMessage&&(abortReason=abortMessage))};return{response:job(),cancel}}}((async()=>handler_transferHandler(amplify,{url,method:"POST",...options,abortSignal:controller.signal},isIamAuthApplicableForGraphQL,options?.signingServiceInfo)),controller),responseWithCleanUp=responsePromise.finally((()=>{cancelTokenMap.delete(responseWithCleanUp)}));return responseWithCleanUp},cancel=(promise,message)=>{const controller=cancelTokenMap.get(promise);return!!controller&&(controller.abort(message),message&&controller.signal.reason!==message&&(controller.signal.reason=message),!0)},updateRequestToBeCancellable=(promise,controller)=>{cancelTokenMap.set(promise,controller)},NON_RETRYABLE_CODES=[400,401,403],NON_RETRYABLE_ERROR_TYPES=["BadRequestException","UnauthorizedException"];var MESSAGE_TYPES,SUBSCRIPTION_STATUS,SOCKET_STATUS;!function(MESSAGE_TYPES){MESSAGE_TYPES.GQL_CONNECTION_INIT="connection_init",MESSAGE_TYPES.GQL_CONNECTION_ERROR="connection_error",MESSAGE_TYPES.GQL_CONNECTION_ACK="connection_ack",MESSAGE_TYPES.GQL_START="start",MESSAGE_TYPES.GQL_START_ACK="start_ack",MESSAGE_TYPES.DATA="data",MESSAGE_TYPES.GQL_CONNECTION_KEEP_ALIVE="ka",MESSAGE_TYPES.GQL_STOP="stop",MESSAGE_TYPES.GQL_COMPLETE="complete",MESSAGE_TYPES.GQL_ERROR="error",MESSAGE_TYPES.EVENT_SUBSCRIBE="subscribe",MESSAGE_TYPES.EVENT_PUBLISH="publish",MESSAGE_TYPES.EVENT_SUBSCRIBE_ACK="subscribe_success",MESSAGE_TYPES.EVENT_PUBLISH_ACK="publish_success",MESSAGE_TYPES.EVENT_STOP="unsubscribe",MESSAGE_TYPES.EVENT_COMPLETE="unsubscribe_success"}(MESSAGE_TYPES||(MESSAGE_TYPES={})),function(SUBSCRIPTION_STATUS){SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS.PENDING=0]="PENDING",SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS.CONNECTED=1]="CONNECTED",SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS.FAILED=2]="FAILED"}(SUBSCRIPTION_STATUS||(SUBSCRIPTION_STATUS={})),function(SOCKET_STATUS){SOCKET_STATUS[SOCKET_STATUS.CLOSED=0]="CLOSED",SOCKET_STATUS[SOCKET_STATUS.READY=1]="READY",SOCKET_STATUS[SOCKET_STATUS.CONNECTING=2]="CONNECTING"}(SOCKET_STATUS||(SOCKET_STATUS={}));const AWS_APPSYNC_REALTIME_HEADERS={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},DEFAULT_KEEP_ALIVE_TIMEOUT=3e5;class NonRetryableError extends Error{constructor(){super(...arguments),this.nonRetryable=!0}}const amplifyUuid=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js").A,isNonRetryableError=obj=>obj&&obj.nonRetryable;const base64Encoder={convert(input,options={urlSafe:!1,skipPadding:!1}){const inputStr="string"==typeof input?input:function bytesToString(input){return Array.from(input,(byte=>String.fromCodePoint(byte))).join("")}(input);let encodedStr=(()=>{if("undefined"!=typeof window&&"function"==typeof window.btoa)return window.btoa;if("function"==typeof btoa)return btoa;throw new AmplifyError_AmplifyError({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})})()(inputStr);return options.urlSafe&&(encodedStr=encodedStr.replace(/\+/g,"-").replace(/\//g,"_")),options.skipPadding&&(encodedStr=encodedStr.replace(/=/g,"")),encodedStr}},retry_logger=new ConsoleLogger("retryUtil");const jitteredExponentialRetry=(functionToRetry,args,maxDelayMs=3e5,onTerminate)=>async function retry(functionToRetry,args,delayFn,onTerminate){if("function"!=typeof functionToRetry)throw Error("functionToRetry must be a function");return new Promise((async(resolve,reject)=>{let timeout,lastError,attempt=0,terminated=!1,wakeUp=()=>{};for(onTerminate&&onTerminate.then((()=>{terminated=!0,clearTimeout(timeout),wakeUp()}));!terminated;){attempt++,retry_logger.debug(`${functionToRetry.name} attempt #${attempt} with this vars: ${JSON.stringify(args)}`);try{return void resolve(await functionToRetry(...args))}catch(err){if(lastError=err,retry_logger.debug(`error on ${functionToRetry.name}`,err),isNonRetryableError(err))return retry_logger.debug(`${functionToRetry.name} non retryable error`,err),void reject(err);const retryIn=delayFn(attempt,args,err);if(retry_logger.debug(`${functionToRetry.name} retrying in ${retryIn} ms`),!1===retryIn||terminated)return void reject(err);await new Promise((_resolve=>{wakeUp=_resolve,timeout=setTimeout(wakeUp,retryIn)}))}}reject(lastError)}))}(functionToRetry,args,jitteredBackoff(maxDelayMs),onTerminate);var CONTROL_MSG,ConnectionState;function executeSchedule(parentSubscription,scheduler,work,delay,repeat){void 0===delay&&(delay=0),void 0===repeat&&(repeat=!1);var scheduleSubscription=scheduler.schedule((function(){work(),repeat?parentSubscription.add(this.schedule(null,delay)):this.unsubscribe()}),delay);if(parentSubscription.add(scheduleSubscription),!repeat)return scheduleSubscription}function observeOn(scheduler,delay){return void 0===delay&&(delay=0),operate((function(source,subscriber){source.subscribe(createOperatorSubscriber(subscriber,(function(value){return executeSchedule(subscriber,scheduler,(function(){return subscriber.next(value)}),delay)}),(function(){return executeSchedule(subscriber,scheduler,(function(){return subscriber.complete()}),delay)}),(function(err){return executeSchedule(subscriber,scheduler,(function(){return subscriber.error(err)}),delay)})))}))}function subscribeOn(scheduler,delay){return void 0===delay&&(delay=0),operate((function(source,subscriber){subscriber.add(scheduler.schedule((function(){return source.subscribe(subscriber)}),delay))}))}function scheduleAsyncIterable(input,scheduler){if(!input)throw new Error("Iterable cannot be null");return new Observable((function(subscriber){executeSchedule(subscriber,scheduler,(function(){var iterator=input[Symbol.asyncIterator]();executeSchedule(subscriber,scheduler,(function(){iterator.next().then((function(result){result.done?subscriber.complete():subscriber.next(result.value)}))}),0,!0)}))}))}function scheduled(input,scheduler){if(null!=input){if(isInteropObservable(input))return function scheduleObservable(input,scheduler){return innerFrom(input).pipe(subscribeOn(scheduler),observeOn(scheduler))}(input,scheduler);if(isArrayLike(input))return function scheduleArray(input,scheduler){return new Observable((function(subscriber){var i=0;return scheduler.schedule((function(){i===input.length?subscriber.complete():(subscriber.next(input[i++]),subscriber.closed||this.schedule())}))}))}(input,scheduler);if(isPromise(input))return function schedulePromise(input,scheduler){return innerFrom(input).pipe(subscribeOn(scheduler),observeOn(scheduler))}(input,scheduler);if(isAsyncIterable(input))return scheduleAsyncIterable(input,scheduler);if(isIterable(input))return function scheduleIterable(input,scheduler){return new Observable((function(subscriber){var iterator;return executeSchedule(subscriber,scheduler,(function(){iterator=input[iterator_iterator](),executeSchedule(subscriber,scheduler,(function(){var _a,value,done;try{value=(_a=iterator.next()).value,done=_a.done}catch(err){return void subscriber.error(err)}done?subscriber.complete():subscriber.next(value)}),0,!0)})),function(){return isFunction(null==iterator?void 0:iterator.return)&&iterator.return()}}))}(input,scheduler);if(isReadableStreamLike(input))return function scheduleReadableStreamLike(input,scheduler){return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(input),scheduler)}(input,scheduler)}throw createInvalidObservableTypeError(input)}!function(CONTROL_MSG){CONTROL_MSG.CONNECTION_CLOSED="Connection closed",CONTROL_MSG.CONNECTION_FAILED="Connection failed",CONTROL_MSG.REALTIME_SUBSCRIPTION_INIT_ERROR="AppSync Realtime subscription init error",CONTROL_MSG.SUBSCRIPTION_ACK="Subscription ack",CONTROL_MSG.TIMEOUT_DISCONNECT="Timeout disconnect"}(CONTROL_MSG||(CONTROL_MSG={})),function(ConnectionState){ConnectionState.Connected="Connected",ConnectionState.ConnectedPendingNetwork="ConnectedPendingNetwork",ConnectionState.ConnectionDisrupted="ConnectionDisrupted",ConnectionState.ConnectionDisruptedPendingNetwork="ConnectionDisruptedPendingNetwork",ConnectionState.Connecting="Connecting",ConnectionState.ConnectedPendingDisconnect="ConnectedPendingDisconnect",ConnectionState.Disconnected="Disconnected",ConnectionState.ConnectedPendingKeepAlive="ConnectedPendingKeepAlive"}(ConnectionState||(ConnectionState={}));class Reachability{networkMonitor(_){const globalObj=(()=>{if("undefined"==typeof self)return!1;const selfContext=self;return void 0!==selfContext.WorkerGlobalScope&&self instanceof selfContext.WorkerGlobalScope})()?self:"undefined"!=typeof window&&window;return globalObj?new Observable((observer=>{observer.next({online:globalObj.navigator.onLine});const notifyOnline=()=>{observer.next({online:!0})},notifyOffline=()=>{observer.next({online:!1})};return globalObj.addEventListener("online",notifyOnline),globalObj.addEventListener("offline",notifyOffline),Reachability._observers.push(observer),()=>{globalObj.removeEventListener("online",notifyOnline),globalObj.removeEventListener("offline",notifyOffline),Reachability._observers=Reachability._observers.filter((_observer=>_observer!==observer))}})):function from(input,scheduler){return scheduler?scheduled(input,scheduler):innerFrom(input)}([{online:!0}])}static _observerOverride(status){for(const observer of this._observers)observer.closed?this._observers=this._observers.filter((_observer=>_observer!==observer)):observer?.next&&observer.next(status)}}Reachability._observers=[];const ReachabilityMonitor=()=>(new Reachability).networkMonitor(),CONNECTION_CHANGE={KEEP_ALIVE_MISSED:{keepAliveState:"unhealthy"},KEEP_ALIVE:{keepAliveState:"healthy"},CONNECTION_ESTABLISHED:{connectionState:"connected"},CONNECTION_FAILED:{intendedConnectionState:"disconnected",connectionState:"disconnected"},CLOSING_CONNECTION:{intendedConnectionState:"disconnected"},OPENING_CONNECTION:{intendedConnectionState:"connected",connectionState:"connecting"},CLOSED:{connectionState:"disconnected"},ONLINE:{networkState:"connected"},OFFLINE:{networkState:"disconnected"}};class ConnectionStateMonitor{constructor(){this._networkMonitoringSubscription=void 0,this._linkedConnectionState={networkState:"connected",connectionState:"disconnected",intendedConnectionState:"disconnected",keepAliveState:"healthy"},this._initialNetworkStateSubscription=ReachabilityMonitor().subscribe((({online})=>{this.record(online?CONNECTION_CHANGE.ONLINE:CONNECTION_CHANGE.OFFLINE),this._initialNetworkStateSubscription?.unsubscribe()})),this._linkedConnectionStateObservable=new Observable((connectionStateObserver=>{connectionStateObserver.next(this._linkedConnectionState),this._linkedConnectionStateObserver=connectionStateObserver}))}enableNetworkMonitoring(){this._initialNetworkStateSubscription?.unsubscribe(),void 0===this._networkMonitoringSubscription&&(this._networkMonitoringSubscription=ReachabilityMonitor().subscribe((({online})=>{this.record(online?CONNECTION_CHANGE.ONLINE:CONNECTION_CHANGE.OFFLINE)})))}disableNetworkMonitoring(){this._networkMonitoringSubscription?.unsubscribe(),this._networkMonitoringSubscription=void 0}get connectionStateObservable(){let previous;return this._linkedConnectionStateObservable.pipe(map((value=>this.connectionStatesTranslator(value)))).pipe(function filter(predicate,thisArg){return operate((function(source,subscriber){var index=0;source.subscribe(createOperatorSubscriber(subscriber,(function(value){return predicate.call(thisArg,value,index++)&&subscriber.next(value)})))}))}((current=>{const toInclude=current!==previous;return previous=current,toInclude})))}record(statusUpdates){"connected"===statusUpdates.intendedConnectionState?this.enableNetworkMonitoring():"disconnected"===statusUpdates.intendedConnectionState&&this.disableNetworkMonitoring();const newSocketStatus={...this._linkedConnectionState,...statusUpdates};this._linkedConnectionState={...newSocketStatus},this._linkedConnectionStateObserver?.next(this._linkedConnectionState)}connectionStatesTranslator({connectionState,networkState,intendedConnectionState,keepAliveState}){return"connected"===connectionState&&"disconnected"===networkState?ConnectionState.ConnectedPendingNetwork:"connected"===connectionState&&"disconnected"===intendedConnectionState?ConnectionState.ConnectedPendingDisconnect:"disconnected"===connectionState&&"connected"===intendedConnectionState&&"disconnected"===networkState?ConnectionState.ConnectionDisruptedPendingNetwork:"disconnected"===connectionState&&"connected"===intendedConnectionState?ConnectionState.ConnectionDisrupted:"connected"===connectionState&&"unhealthy"===keepAliveState?ConnectionState.ConnectedPendingKeepAlive:"connecting"===connectionState?ConnectionState.Connecting:"disconnected"===connectionState?ConnectionState.Disconnected:ConnectionState.Connected}}var ReconnectEvent;!function(ReconnectEvent){ReconnectEvent.START_RECONNECT="START_RECONNECT",ReconnectEvent.HALT_RECONNECT="HALT_RECONNECT"}(ReconnectEvent||(ReconnectEvent={}));class ReconnectionMonitor{constructor(){this.reconnectObservers=[]}addObserver(reconnectObserver){this.reconnectObservers.push(reconnectObserver)}record(event){event===ReconnectEvent.START_RECONNECT&&void 0===this.reconnectSetTimeoutId&&void 0===this.reconnectIntervalId&&(this.reconnectSetTimeoutId=setTimeout((()=>{this._triggerReconnect(),this.reconnectIntervalId=setInterval((()=>{this._triggerReconnect()}),6e4)}),5e3)),event===ReconnectEvent.HALT_RECONNECT&&(this.reconnectIntervalId&&(clearInterval(this.reconnectIntervalId),this.reconnectIntervalId=void 0),this.reconnectSetTimeoutId&&(clearTimeout(this.reconnectSetTimeoutId),this.reconnectSetTimeoutId=void 0))}close(){this.reconnectObservers.forEach((reconnectObserver=>{reconnectObserver.complete?.()}))}_triggerReconnect(){this.reconnectObservers.forEach((reconnectObserver=>{reconnectObserver.next?.()}))}}const standardDomainPattern=/^https:\/\/\w{26}\.appsync-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/graphql$/i,eventDomainPattern=/^https:\/\/\w{26}\.\w+-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/event$/i,getRealtimeEndpointUrl=appSyncGraphqlEndpoint=>{let realtimeEndpoint=appSyncGraphqlEndpoint??"";return realtimeEndpoint=null!==realtimeEndpoint.match(eventDomainPattern)?realtimeEndpoint.concat("/realtime").replace("ddpg-api","grt-gamma").replace("appsync-api","appsync-realtime-api"):(url=>null===url.match(standardDomainPattern))(realtimeEndpoint)?realtimeEndpoint.concat("/realtime"):realtimeEndpoint.replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta").replace("ddpg-api","grt-gamma"),realtimeEndpoint=realtimeEndpoint.replace("https://","wss://").replace("http://","wss://"),new amplifyUrl_AmplifyUrl(realtimeEndpoint)},additionalHeadersFromOptions=async options=>{const{appSyncGraphqlEndpoint,query,libraryConfigHeaders=()=>({}),additionalHeaders={},authToken}=options;let additionalCustomHeaders={};const _libraryConfigHeaders=await libraryConfigHeaders();if("function"==typeof additionalHeaders){const requestOptions={url:appSyncGraphqlEndpoint||"",queryString:query||""};additionalCustomHeaders=await additionalHeaders(requestOptions)}else additionalCustomHeaders=additionalHeaders;return authToken&&(additionalCustomHeaders={...additionalCustomHeaders,Authorization:authToken}),{additionalCustomHeaders,libraryConfigHeaders:_libraryConfigHeaders}},deepFreeze=object=>{const propNames=Reflect.ownKeys(object);for(const name of propNames){const value=object[name];(value&&"object"==typeof value||"function"==typeof value)&&deepFreeze(value)}return Object.freeze(object)},ADD_OAUTH_LISTENER=Symbol("oauth-listener"),parseAWSExports_logger=new ConsoleLogger("parseAWSExports"),authTypeMapping={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},getRedirectUrl=redirectStr=>redirectStr?.split(",")??[],getOAuthConfig=({domain,scope,redirectSignIn,redirectSignOut,responseType})=>({domain,scopes:scope,redirectSignIn:getRedirectUrl(redirectSignIn),redirectSignOut:getRedirectUrl(redirectSignOut),responseType}),parseSocialProviders=aws_cognito_social_providers=>aws_cognito_social_providers.map((provider=>{const updatedProvider=provider.toLowerCase();return updatedProvider.charAt(0).toUpperCase()+updatedProvider.slice(1)}));function parseAmplifyOutputs(amplifyOutputs){const resourcesConfig={};if(amplifyOutputs.storage&&(resourcesConfig.Storage=function parseStorage(amplifyOutputsStorageProperties){if(!amplifyOutputsStorageProperties)return;const{bucket_name,aws_region,buckets}=amplifyOutputsStorageProperties;return{S3:{bucket:bucket_name,region:aws_region,buckets:buckets&&createBucketInfoMap(buckets)}}}(amplifyOutputs.storage)),amplifyOutputs.auth&&(resourcesConfig.Auth=function parseAuth(amplifyOutputsAuthProperties){if(!amplifyOutputsAuthProperties)return;const{user_pool_id,user_pool_client_id,identity_pool_id,password_policy,mfa_configuration,mfa_methods,unauthenticated_identities_enabled,oauth,username_attributes,standard_required_attributes}=amplifyOutputsAuthProperties,authConfig={Cognito:{userPoolId:user_pool_id,userPoolClientId:user_pool_client_id}};return identity_pool_id&&(authConfig.Cognito={...authConfig.Cognito,identityPoolId:identity_pool_id}),password_policy&&(authConfig.Cognito.passwordFormat={requireLowercase:password_policy.require_lowercase,requireNumbers:password_policy.require_numbers,requireUppercase:password_policy.require_uppercase,requireSpecialCharacters:password_policy.require_symbols,minLength:password_policy.min_length??6}),mfa_configuration&&(authConfig.Cognito.mfa={status:getMfaStatus(mfa_configuration),smsEnabled:mfa_methods?.includes("SMS"),totpEnabled:mfa_methods?.includes("TOTP")}),unauthenticated_identities_enabled&&(authConfig.Cognito.allowGuestAccess=unauthenticated_identities_enabled),oauth&&(authConfig.Cognito.loginWith={oauth:{domain:oauth.domain,redirectSignIn:oauth.redirect_sign_in_uri,redirectSignOut:oauth.redirect_sign_out_uri,responseType:"token"===oauth.response_type?"token":"code",scopes:oauth.scopes,providers:getOAuthProviders(oauth.identity_providers)}}),username_attributes&&(authConfig.Cognito.loginWith={...authConfig.Cognito.loginWith,email:username_attributes.includes("email"),phone:username_attributes.includes("phone_number"),username:username_attributes.includes("username")}),standard_required_attributes&&(authConfig.Cognito.userAttributes=standard_required_attributes.reduce(((acc,curr)=>({...acc,[curr]:{required:!0}})),{})),authConfig}(amplifyOutputs.auth)),amplifyOutputs.analytics&&(resourcesConfig.Analytics=function parseAnalytics(amplifyOutputsAnalyticsProperties){if(!amplifyOutputsAnalyticsProperties?.amazon_pinpoint)return;const{amazon_pinpoint}=amplifyOutputsAnalyticsProperties;return{Pinpoint:{appId:amazon_pinpoint.app_id,region:amazon_pinpoint.aws_region}}}(amplifyOutputs.analytics)),amplifyOutputs.geo&&(resourcesConfig.Geo=function parseGeo(amplifyOutputsAnalyticsProperties){if(!amplifyOutputsAnalyticsProperties)return;const{aws_region,geofence_collections,maps,search_indices}=amplifyOutputsAnalyticsProperties;return{LocationService:{region:aws_region,searchIndices:search_indices,geofenceCollections:geofence_collections,maps}}}(amplifyOutputs.geo)),amplifyOutputs.data&&(resourcesConfig.API=function parseData(amplifyOutputsDataProperties){if(!amplifyOutputsDataProperties)return;const{aws_region,default_authorization_type,url,api_key,model_introspection}=amplifyOutputsDataProperties;return{GraphQL:{endpoint:url,defaultAuthMode:getGraphQLAuthMode(default_authorization_type),region:aws_region,apiKey:api_key,modelIntrospection:model_introspection}}}(amplifyOutputs.data)),amplifyOutputs.custom){const customConfig=function parseCustom(amplifyOutputsCustomProperties){if(!amplifyOutputsCustomProperties?.events)return;const{url,aws_region,api_key,default_authorization_type}=amplifyOutputsCustomProperties.events;return{Events:{endpoint:url,defaultAuthMode:getGraphQLAuthMode(default_authorization_type),region:aws_region,apiKey:api_key}}}(amplifyOutputs.custom);customConfig&&"Events"in customConfig&&(resourcesConfig.API={...resourcesConfig.API,...customConfig})}return amplifyOutputs.notifications&&(resourcesConfig.Notifications=function parseNotifications(amplifyOutputsNotificationsProperties){if(!amplifyOutputsNotificationsProperties)return;const{aws_region,channels,amazon_pinpoint_app_id}=amplifyOutputsNotificationsProperties,hasInAppMessaging=channels.includes("IN_APP_MESSAGING"),hasPushNotification=channels.includes("APNS")||channels.includes("FCM");if(!hasInAppMessaging&&!hasPushNotification)return;const notificationsConfig={};return hasInAppMessaging&&(notificationsConfig.InAppMessaging={Pinpoint:{appId:amazon_pinpoint_app_id,region:aws_region}}),hasPushNotification&&(notificationsConfig.PushNotification={Pinpoint:{appId:amazon_pinpoint_app_id,region:aws_region}}),notificationsConfig}(amplifyOutputs.notifications)),resourcesConfig}const authModeNames={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function getGraphQLAuthMode(authType){return authModeNames[authType]}const providerNames={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function getOAuthProviders(providers=[]){return providers.reduce(((oAuthProviders,provider)=>(void 0!==providerNames[provider]&&oAuthProviders.push(providerNames[provider]),oAuthProviders)),[])}function getMfaStatus(mfaConfiguration){return"OPTIONAL"===mfaConfiguration?"optional":"REQUIRED"===mfaConfiguration?"on":"off"}function createBucketInfoMap(buckets){const mappedBuckets={};return buckets.forEach((({name,bucket_name:bucketName,aws_region:region})=>{if(name in mappedBuckets)throw new Error(`Duplicate friendly name found: ${name}. Name must be unique.`);mappedBuckets[name]={bucketName,region}})),mappedBuckets}const parseAmplifyConfig=amplifyConfig=>Object.keys(amplifyConfig).some((key=>key.startsWith("aws_")))?((config={})=>{if(!Object.prototype.hasOwnProperty.call(config,"aws_project_region"))throw new AmplifyError_AmplifyError({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey,aws_appsync_authenticationType,aws_appsync_graphqlEndpoint,aws_appsync_region,aws_bots_config,aws_cognito_identity_pool_id,aws_cognito_sign_up_verification_method,aws_cognito_mfa_configuration,aws_cognito_mfa_types,aws_cognito_password_protection_settings,aws_cognito_verification_mechanisms,aws_cognito_signup_attributes,aws_cognito_social_providers,aws_cognito_username_attributes,aws_mandatory_sign_in,aws_mobile_analytics_app_id,aws_mobile_analytics_app_region,aws_user_files_s3_bucket,aws_user_files_s3_bucket_region,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing,aws_user_pools_id,aws_user_pools_web_client_id,geo,oauth,predictions,aws_cloud_logic_custom,Notifications,modelIntrospection}=config,amplifyConfig={};aws_mobile_analytics_app_id&&(amplifyConfig.Analytics={Pinpoint:{appId:aws_mobile_analytics_app_id,region:aws_mobile_analytics_app_region}});const{InAppMessaging,Push}=Notifications??{};if(InAppMessaging?.AWSPinpoint||Push?.AWSPinpoint){if(InAppMessaging?.AWSPinpoint){const{appId,region}=InAppMessaging.AWSPinpoint;amplifyConfig.Notifications={InAppMessaging:{Pinpoint:{appId,region}}}}if(Push?.AWSPinpoint){const{appId,region}=Push.AWSPinpoint;amplifyConfig.Notifications={...amplifyConfig.Notifications,PushNotification:{Pinpoint:{appId,region}}}}}if(Array.isArray(aws_bots_config)&&(amplifyConfig.Interactions={LexV1:Object.fromEntries(aws_bots_config.map((bot=>[bot.name,bot])))}),aws_appsync_graphqlEndpoint){const defaultAuthMode=authTypeMapping[aws_appsync_authenticationType];defaultAuthMode||parseAWSExports_logger.debug(`Invalid authentication type ${aws_appsync_authenticationType}. Falling back to IAM.`),amplifyConfig.API={GraphQL:{endpoint:aws_appsync_graphqlEndpoint,apiKey:aws_appsync_apiKey,region:aws_appsync_region,defaultAuthMode:defaultAuthMode??"iam"}},modelIntrospection&&(amplifyConfig.API.GraphQL.modelIntrospection=modelIntrospection)}const mfaConfig=aws_cognito_mfa_configuration?{status:aws_cognito_mfa_configuration&&aws_cognito_mfa_configuration.toLowerCase(),totpEnabled:aws_cognito_mfa_types?.includes("TOTP")??!1,smsEnabled:aws_cognito_mfa_types?.includes("SMS")??!1}:void 0,passwordFormatConfig=aws_cognito_password_protection_settings?{minLength:aws_cognito_password_protection_settings.passwordPolicyMinLength,requireLowercase:aws_cognito_password_protection_settings.passwordPolicyCharacters?.includes("REQUIRES_LOWERCASE")??!1,requireUppercase:aws_cognito_password_protection_settings.passwordPolicyCharacters?.includes("REQUIRES_UPPERCASE")??!1,requireNumbers:aws_cognito_password_protection_settings.passwordPolicyCharacters?.includes("REQUIRES_NUMBERS")??!1,requireSpecialCharacters:aws_cognito_password_protection_settings.passwordPolicyCharacters?.includes("REQUIRES_SYMBOLS")??!1}:void 0,userAttributes=Array.from(new Set([...aws_cognito_verification_mechanisms??[],...aws_cognito_signup_attributes??[]])).reduce(((attributes,key)=>({...attributes,[key.toLowerCase()]:{required:!0}})),{}),loginWithEmailEnabled=aws_cognito_username_attributes?.includes("EMAIL")??!1,loginWithPhoneEnabled=aws_cognito_username_attributes?.includes("PHONE_NUMBER")??!1;(aws_cognito_identity_pool_id||aws_user_pools_id)&&(amplifyConfig.Auth={Cognito:{identityPoolId:aws_cognito_identity_pool_id,allowGuestAccess:"enable"!==aws_mandatory_sign_in,signUpVerificationMethod:aws_cognito_sign_up_verification_method,userAttributes,userPoolClientId:aws_user_pools_web_client_id,userPoolId:aws_user_pools_id,mfa:mfaConfig,passwordFormat:passwordFormatConfig,loginWith:{username:!(loginWithEmailEnabled||loginWithPhoneEnabled),email:loginWithEmailEnabled,phone:loginWithPhoneEnabled}}});const hasOAuthConfig=!!oauth&&Object.keys(oauth).length>0,hasSocialProviderConfig=!!aws_cognito_social_providers&&aws_cognito_social_providers.length>0;if(amplifyConfig.Auth&&hasOAuthConfig&&(amplifyConfig.Auth.Cognito.loginWith={...amplifyConfig.Auth.Cognito.loginWith,oauth:{...getOAuthConfig(oauth),...hasSocialProviderConfig&&{providers:parseSocialProviders(aws_cognito_social_providers)}}}),aws_user_files_s3_bucket&&(amplifyConfig.Storage={S3:{bucket:aws_user_files_s3_bucket,region:aws_user_files_s3_bucket_region,dangerouslyConnectToHttpEndpointForTesting:aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing}}),geo){const{amazon_location_service}=geo;amplifyConfig.Geo={LocationService:{maps:amazon_location_service.maps,geofenceCollections:amazon_location_service.geofenceCollections,searchIndices:amazon_location_service.search_indices,region:amazon_location_service.region}}}if(aws_cloud_logic_custom&&(amplifyConfig.API={...amplifyConfig.API,REST:aws_cloud_logic_custom.reduce(((acc,api)=>{const{name,endpoint,region,service}=api;return{...acc,[name]:{endpoint,...service?{service}:void 0,...region?{region}:void 0}}}),{})}),predictions){const{VoiceId:voiceId}=predictions?.convert?.speechGenerator?.defaults??{};amplifyConfig.Predictions=voiceId?{...predictions,convert:{...predictions.convert,speechGenerator:{...predictions.convert.speechGenerator,defaults:{voiceId}}}}:predictions}return amplifyConfig})(amplifyConfig):function isAmplifyOutputs(config){const{version}=config;return!!version&&version.startsWith("1")}(amplifyConfig)?parseAmplifyOutputs(amplifyConfig):amplifyConfig;class AuthClass{configure(authResourcesConfig,authOptions){this.authConfig=authResourcesConfig,this.authOptions=authOptions}async fetchAuthSession(options={}){let credentialsAndIdentityId,userSub;const tokens=await this.getTokens(options);return tokens?(userSub=tokens.accessToken?.payload?.sub,credentialsAndIdentityId=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens,authenticated:!0,forceRefresh:options.forceRefresh}))):credentialsAndIdentityId=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:options.forceRefresh})),{tokens,credentials:credentialsAndIdentityId?.credentials,identityId:credentialsAndIdentityId?.identityId,userSub}}async clearCredentials(){await(this.authOptions?.credentialsProvider?.clearCredentialsAndIdentityId())}async getTokens(options){return await(this.authOptions?.tokenProvider?.getTokens(options))??void 0}}const Amplify_Amplify=new class AmplifyClass{constructor(){this.oAuthListener=void 0,this.resourcesConfig={},this.libraryOptions={},this.Auth=new AuthClass}configure(resourcesConfig,libraryOptions){const resolvedResourceConfig=parseAmplifyConfig(resourcesConfig);this.resourcesConfig=resolvedResourceConfig,libraryOptions&&(this.libraryOptions=libraryOptions),this.resourcesConfig=deepFreeze(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),Hub.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",AMPLIFY_SYMBOL),this.notifyOAuthListener()}getConfig(){return this.resourcesConfig}[ADD_OAUTH_LISTENER](listener){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth?listener(this.resourcesConfig.Auth?.Cognito):this.oAuthListener=listener}notifyOAuthListener(){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth&&this.oAuthListener&&(this.oAuthListener(this.resourcesConfig.Auth?.Cognito),this.oAuthListener=void 0)}},fetchAuthSession_fetchAuthSession=options=>((amplify,options)=>amplify.Auth.fetchAuthSession(options))(Amplify_Amplify,options),authHeaders_logger=new ConsoleLogger("AWSAppSyncRealTimeProvider Auth"),awsAuthTokenHeader=async({host})=>{const session=await fetchAuthSession_fetchAuthSession();return{Authorization:session?.tokens?.accessToken?.toString(),host}},awsRealTimeApiKeyHeader=async({apiKey,host})=>({host,"x-amz-date":(new Date).toISOString().replace(/[:-]|\.\d{3}/g,""),"x-api-key":apiKey}),awsRealTimeIAMHeader=async({payload,canonicalUri,appSyncGraphqlEndpoint,region})=>{const endpointInfo={region,service:"appsync"},creds=(await fetchAuthSession_fetchAuthSession()).credentials,request={url:`${appSyncGraphqlEndpoint}${canonicalUri}`,data:payload,method:"POST",headers:{...AWS_APPSYNC_REALTIME_HEADERS}};return signRequest({headers:request.headers,method:request.method,url:new amplifyUrl_AmplifyUrl(request.url),body:request.data},{credentials:creds,signingRegion:endpointInfo.region,signingService:endpointInfo.service}).headers},customAuthHeader=async({host,additionalCustomHeaders})=>{if(!additionalCustomHeaders?.Authorization)throw new Error("No auth token specified");return{Authorization:additionalCustomHeaders.Authorization,host}},awsRealTimeHeaderBasedAuth=async({apiKey,authenticationType,canonicalUri,appSyncGraphqlEndpoint,region,additionalCustomHeaders,payload})=>{const headerHandler={apiKey:awsRealTimeApiKeyHeader,iam:awsRealTimeIAMHeader,oidc:awsAuthTokenHeader,userPool:awsAuthTokenHeader,lambda:customAuthHeader,none:customAuthHeader};if(authenticationType&&headerHandler[authenticationType]){const handler=headerHandler[authenticationType],host=appSyncGraphqlEndpoint?new amplifyUrl_AmplifyUrl(appSyncGraphqlEndpoint).host:void 0,resolvedApiKey="apiKey"===authenticationType?apiKey:void 0;authHeaders_logger.debug(`Authenticating with ${JSON.stringify(authenticationType)}`);return await handler({payload,canonicalUri,appSyncGraphqlEndpoint,apiKey:resolvedApiKey,region,host,additionalCustomHeaders})}authHeaders_logger.debug(`Authentication type ${authenticationType} not supported`)},dispatchApiEvent=payload=>{Hub.dispatch("api",payload,"PubSub",AMPLIFY_SYMBOL)};class AWSWebSocketProvider{constructor(args){this.subscriptionObserverMap=new Map,this.socketStatus=SOCKET_STATUS.CLOSED,this.keepAliveTimeout=DEFAULT_KEEP_ALIVE_TIMEOUT,this.promiseArray=[],this.connectionStateMonitor=new ConnectionStateMonitor,this.reconnectionMonitor=new ReconnectionMonitor,this._establishConnection=async(awsRealTimeUrl,subprotocol)=>{this.logger.debug(`Establishing WebSocket connection to ${awsRealTimeUrl}`);try{await this._openConnection(awsRealTimeUrl,subprotocol),await this._initiateHandshake()}catch(err){const{errorType,errorCode}=err;throw NON_RETRYABLE_CODES.includes(errorCode)||NON_RETRYABLE_ERROR_TYPES.includes(errorType)?new NonRetryableError(errorType):errorType?new Error(errorType):err}},this.logger=new ConsoleLogger(args.providerName),this.wsProtocolName=args.wsProtocolName,this.wsConnectUri=args.connectUri,this.connectionStateMonitorSubscription=this._startConnectionStateMonitoring()}close(){return this.socketStatus=SOCKET_STATUS.CLOSED,this.connectionStateMonitor.record(CONNECTION_CHANGE.CONNECTION_FAILED),this.connectionStateMonitorSubscription.unsubscribe(),this.reconnectionMonitor.close(),new Promise(((resolve,reject)=>{this.awsRealTimeSocket?(this.awsRealTimeSocket.onclose=_=>{this.subscriptionObserverMap=new Map,this.awsRealTimeSocket=void 0,resolve()},this.awsRealTimeSocket.onerror=err=>{reject(err)},this.awsRealTimeSocket.close()):resolve()}))}subscribe(options,customUserAgentDetails){return new Observable((observer=>{if(!options?.appSyncGraphqlEndpoint)return observer.error({errors:[{...new GraphQLError("Subscribe only available for AWS AppSync endpoint")}]}),void observer.complete();let subscriptionStartInProgress=!1;const subscriptionId=amplifyUuid(),startSubscription=()=>{subscriptionStartInProgress||(subscriptionStartInProgress=!0,this._startSubscriptionWithAWSAppSyncRealTime({options,observer,subscriptionId,customUserAgentDetails}).catch((err=>{this.logger.debug(`${CONTROL_MSG.REALTIME_SUBSCRIPTION_INIT_ERROR}: ${err}`),this.connectionStateMonitor.record(CONNECTION_CHANGE.CLOSED)})).finally((()=>{subscriptionStartInProgress=!1})))},reconnectSubscription=new Observable((reconnectSubscriptionObserver=>{this.reconnectionMonitor.addObserver(reconnectSubscriptionObserver)})).subscribe((()=>{startSubscription()}));return startSubscription(),async()=>{await this._cleanupSubscription(subscriptionId,reconnectSubscription)}}))}async connect(options){this.socketStatus!==SOCKET_STATUS.READY&&await this._connectWebSocket(options)}async publish(options,customUserAgentDetails){if(this.socketStatus!==SOCKET_STATUS.READY)throw new Error("Subscription has not been initialized");return this._publishMessage(options,customUserAgentDetails)}async _connectWebSocket(options){const{apiKey,appSyncGraphqlEndpoint,authenticationType,region}=options,{additionalCustomHeaders}=await additionalHeadersFromOptions(options);this.connectionStateMonitor.record(CONNECTION_CHANGE.OPENING_CONNECTION),await this._initializeWebSocketConnection({apiKey,appSyncGraphqlEndpoint,authenticationType,region,additionalCustomHeaders})}async _publishMessage(options,customUserAgentDetails){const subscriptionId=amplifyUuid(),{additionalCustomHeaders,libraryConfigHeaders}=await additionalHeadersFromOptions(options),serializedSubscriptionMessage=await this._prepareSubscriptionPayload({options,subscriptionId,customUserAgentDetails,additionalCustomHeaders,libraryConfigHeaders,publish:!0});return new Promise(((resolve,reject)=>{if(this.awsRealTimeSocket){const publishListener=event=>{const data=JSON.parse(event.data);data.id===subscriptionId&&"publish_success"===data.type&&(this.awsRealTimeSocket&&this.awsRealTimeSocket.removeEventListener("message",publishListener),resolve()),data.erroredEvents&&data.erroredEvents.length};this.awsRealTimeSocket.addEventListener("message",publishListener),this.awsRealTimeSocket.addEventListener("close",(()=>{reject(new Error("WebSocket is closed"))})),this.awsRealTimeSocket.send(serializedSubscriptionMessage)}}))}async _cleanupSubscription(subscriptionId,reconnectSubscription){reconnectSubscription?.unsubscribe();try{await this._waitForSubscriptionToBeConnected(subscriptionId);const{subscriptionState}=this.subscriptionObserverMap.get(subscriptionId)||{};if(!subscriptionState)return;if(subscriptionState!==SUBSCRIPTION_STATUS.CONNECTED)throw new Error("Subscription never connected");this._sendUnsubscriptionMessage(subscriptionId)}catch(err){this.logger.debug(`Error while unsubscribing ${err}`)}finally{this._removeSubscriptionObserver(subscriptionId)}}_startConnectionStateMonitoring(){return this.connectionStateMonitor.connectionStateObservable.subscribe((connectionState=>{dispatchApiEvent({event:"ConnectionStateChange",data:{provider:this,connectionState},message:`Connection state is ${connectionState}`}),this.connectionState=connectionState,connectionState===ConnectionState.ConnectionDisrupted&&this.reconnectionMonitor.record(ReconnectEvent.START_RECONNECT),[ConnectionState.Connected,ConnectionState.ConnectedPendingDisconnect,ConnectionState.ConnectedPendingKeepAlive,ConnectionState.ConnectedPendingNetwork,ConnectionState.ConnectionDisruptedPendingNetwork,ConnectionState.Disconnected].includes(connectionState)&&this.reconnectionMonitor.record(ReconnectEvent.HALT_RECONNECT)}))}async _startSubscriptionWithAWSAppSyncRealTime({options,observer,subscriptionId,customUserAgentDetails}){const{query,variables}=options,{additionalCustomHeaders,libraryConfigHeaders}=await additionalHeadersFromOptions(options);this.subscriptionObserverMap.set(subscriptionId,{observer,query:query??"",variables:variables??{},subscriptionState:SUBSCRIPTION_STATUS.PENDING,startAckTimeoutId:void 0});const serializedSubscriptionMessage=await this._prepareSubscriptionPayload({options,subscriptionId,customUserAgentDetails,additionalCustomHeaders,libraryConfigHeaders});try{await this._connectWebSocket(options)}catch(err){return void this._logStartSubscriptionError(subscriptionId,observer,err)}const{subscriptionFailedCallback,subscriptionReadyCallback}=this.subscriptionObserverMap.get(subscriptionId)??{};this.subscriptionObserverMap.set(subscriptionId,{observer,subscriptionState:SUBSCRIPTION_STATUS.PENDING,query:query??"",variables:variables??{},subscriptionReadyCallback,subscriptionFailedCallback,startAckTimeoutId:setTimeout((()=>{this._timeoutStartSubscriptionAck(subscriptionId)}),15e3)}),this.awsRealTimeSocket&&this.awsRealTimeSocket.send(serializedSubscriptionMessage)}_logStartSubscriptionError(subscriptionId,observer,err){this.logger.debug({err});const message=String(err.message??"");if(this.connectionStateMonitor.record(CONNECTION_CHANGE.CLOSED),this.connectionState!==ConnectionState.ConnectionDisruptedPendingNetwork){isNonRetryableError(err)?observer.error({errors:[{...new GraphQLError(`${CONTROL_MSG.CONNECTION_FAILED}: ${message}`)}]}):this.logger.debug(`${CONTROL_MSG.CONNECTION_FAILED}: ${message}`);const{subscriptionFailedCallback}=this.subscriptionObserverMap.get(subscriptionId)||{};"function"==typeof subscriptionFailedCallback&&subscriptionFailedCallback()}}async _waitForSubscriptionToBeConnected(subscriptionId){const subscriptionObserver=this.subscriptionObserverMap.get(subscriptionId);if(subscriptionObserver){const{subscriptionState}=subscriptionObserver;if(subscriptionState===SUBSCRIPTION_STATUS.PENDING)return new Promise(((resolve,reject)=>{const{observer,subscriptionState:observedSubscriptionState,variables,query}=subscriptionObserver;this.subscriptionObserverMap.set(subscriptionId,{observer,subscriptionState:observedSubscriptionState,variables,query,subscriptionReadyCallback:resolve,subscriptionFailedCallback:reject})}))}}_sendUnsubscriptionMessage(subscriptionId){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===SOCKET_STATUS.READY){const unsubscribeMessage=this._unsubscribeMessage(subscriptionId),stringToAWSRealTime=JSON.stringify(unsubscribeMessage);this.awsRealTimeSocket.send(stringToAWSRealTime)}}catch(err){this.logger.debug({err})}}_removeSubscriptionObserver(subscriptionId){this.subscriptionObserverMap.delete(subscriptionId),setTimeout(this._closeSocketIfRequired.bind(this),1e3)}_closeSocketIfRequired(){if(!(this.subscriptionObserverMap.size>0))if(this.awsRealTimeSocket)if(this.connectionStateMonitor.record(CONNECTION_CHANGE.CLOSING_CONNECTION),this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{this.logger.debug("closing WebSocket..."),this.keepAliveTimeoutId&&clearTimeout(this.keepAliveTimeoutId),this.keepAliveAlertTimeoutId&&clearTimeout(this.keepAliveAlertTimeoutId);const tempSocket=this.awsRealTimeSocket;tempSocket.onclose=null,tempSocket.onerror=null,tempSocket.close(1e3),this.awsRealTimeSocket=void 0,this.socketStatus=SOCKET_STATUS.CLOSED,this.connectionStateMonitor.record(CONNECTION_CHANGE.CLOSED)}else this.socketStatus=SOCKET_STATUS.CLOSED}_handleIncomingSubscriptionMessage(message){if("string"!=typeof message.data)return;const[isData,data]=this._handleSubscriptionData(message);if(isData)return;const{type,id,payload}=data,{observer=null,query="",variables={},startAckTimeoutId,subscriptionReadyCallback,subscriptionFailedCallback}=this.subscriptionObserverMap.get(id)||{};if(type===MESSAGE_TYPES.GQL_START_ACK||type===MESSAGE_TYPES.EVENT_SUBSCRIBE_ACK){this.logger.debug(`subscription ready for ${JSON.stringify({query,variables})}`),"function"==typeof subscriptionReadyCallback&&subscriptionReadyCallback(),startAckTimeoutId&&clearTimeout(startAckTimeoutId),dispatchApiEvent({event:CONTROL_MSG.SUBSCRIPTION_ACK,data:{query,variables},message:"Connection established for subscription"});const subscriptionState=SUBSCRIPTION_STATUS.CONNECTED;return observer&&this.subscriptionObserverMap.set(id,{observer,query,variables,startAckTimeoutId:void 0,subscriptionState,subscriptionReadyCallback,subscriptionFailedCallback}),void this.connectionStateMonitor.record(CONNECTION_CHANGE.CONNECTION_ESTABLISHED)}if(type===MESSAGE_TYPES.GQL_CONNECTION_KEEP_ALIVE)return this.keepAliveTimeoutId&&clearTimeout(this.keepAliveTimeoutId),this.keepAliveAlertTimeoutId&&clearTimeout(this.keepAliveAlertTimeoutId),this.keepAliveTimeoutId=setTimeout((()=>{this._errorDisconnect(CONTROL_MSG.TIMEOUT_DISCONNECT)}),this.keepAliveTimeout),this.keepAliveAlertTimeoutId=setTimeout((()=>{this.connectionStateMonitor.record(CONNECTION_CHANGE.KEEP_ALIVE_MISSED)}),65e3),void this.connectionStateMonitor.record(CONNECTION_CHANGE.KEEP_ALIVE);if(type===MESSAGE_TYPES.GQL_ERROR){const subscriptionState=SUBSCRIPTION_STATUS.FAILED;observer&&(this.subscriptionObserverMap.set(id,{observer,query,variables,startAckTimeoutId,subscriptionReadyCallback,subscriptionFailedCallback,subscriptionState}),this.logger.debug(`${CONTROL_MSG.CONNECTION_FAILED}: ${JSON.stringify(payload??data)}`),observer.error({errors:[{...new GraphQLError(`${CONTROL_MSG.CONNECTION_FAILED}: ${JSON.stringify(payload??data)}`)}]}),startAckTimeoutId&&clearTimeout(startAckTimeoutId),"function"==typeof subscriptionFailedCallback&&subscriptionFailedCallback())}}_errorDisconnect(msg){this.logger.debug(`Disconnect error: ${msg}`),this.awsRealTimeSocket&&(this.connectionStateMonitor.record(CONNECTION_CHANGE.CLOSED),this.awsRealTimeSocket.close()),this.socketStatus=SOCKET_STATUS.CLOSED}_timeoutStartSubscriptionAck(subscriptionId){const subscriptionObserver=this.subscriptionObserverMap.get(subscriptionId);if(subscriptionObserver){const{observer,query,variables}=subscriptionObserver;if(!observer)return;this.subscriptionObserverMap.set(subscriptionId,{observer,query,variables,subscriptionState:SUBSCRIPTION_STATUS.FAILED}),this.connectionStateMonitor.record(CONNECTION_CHANGE.CLOSED),this.logger.debug("timeoutStartSubscription",JSON.stringify({query,variables}))}}_initializeWebSocketConnection({appSyncGraphqlEndpoint,authenticationType,apiKey,region,additionalCustomHeaders}){if(this.socketStatus!==SOCKET_STATUS.READY)return new Promise((async(resolve,reject)=>{if(this.promiseArray.push({res:resolve,rej:reject}),this.socketStatus===SOCKET_STATUS.CLOSED)try{this.socketStatus=SOCKET_STATUS.CONNECTING;const payloadString="{}",authHeader=await awsRealTimeHeaderBasedAuth({authenticationType,payload:payloadString,canonicalUri:this.wsConnectUri,apiKey,appSyncGraphqlEndpoint,region,additionalCustomHeaders}),headerString=authHeader?JSON.stringify(authHeader):"",authTokenSubprotocol=`header-${base64Encoder.convert(headerString,{urlSafe:!0,skipPadding:!0})}`,queryParams=(headers=>{const nonAuthHeaders=(headers=>{if(!headers)return{};if("Authorization"in headers){const{Authorization:_,...nonAuthHeaders}=headers;return nonAuthHeaders}return headers})(headers),params=new amplifyUrl_AmplifyUrlSearchParams;return Object.entries(nonAuthHeaders).forEach((([k,v])=>{params.append(k,v)})),params})(additionalCustomHeaders),awsRealTimeUrl=((appSyncGraphqlEndpoint,urlParams)=>{const realtimeEndpointUrl=getRealtimeEndpointUrl(appSyncGraphqlEndpoint),existingParams=new amplifyUrl_AmplifyUrlSearchParams(realtimeEndpointUrl.search);for(const[k,v]of urlParams.entries())existingParams.append(k,v);return realtimeEndpointUrl.search=existingParams.toString(),realtimeEndpointUrl.toString()})(appSyncGraphqlEndpoint,queryParams);await this._establishRetryableConnection(awsRealTimeUrl,authTokenSubprotocol),this.promiseArray.forEach((({res})=>{this.logger.debug("Notifying connection successful"),res()})),this.socketStatus=SOCKET_STATUS.READY,this.promiseArray=[]}catch(err){this.logger.debug("Connection exited with",err),this.promiseArray.forEach((({rej})=>{rej(err)})),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=void 0,this.socketStatus=SOCKET_STATUS.CLOSED}}))}async _establishRetryableConnection(awsRealTimeUrl,subprotocol){this.logger.debug("Establishing retryable connection"),await jitteredExponentialRetry(this._establishConnection.bind(this),[awsRealTimeUrl,subprotocol],5e3)}async _openConnection(awsRealTimeUrl,subprotocol){return new Promise(((resolve,reject)=>{const newSocket=this._getNewWebSocket(awsRealTimeUrl,[this.wsProtocolName,subprotocol]);newSocket.onerror=()=>{this.logger.debug("WebSocket connection error")},newSocket.onclose=()=>{reject(new Error("Connection handshake error"))},newSocket.onopen=()=>{this.awsRealTimeSocket=newSocket,resolve()}}))}_getNewWebSocket(url,protocol){return new WebSocket(url,protocol)}async _initiateHandshake(){return new Promise(((resolve,reject)=>{if(!this.awsRealTimeSocket)return void reject(new Error("awsRealTimeSocket undefined"));let ackOk=!1;this.awsRealTimeSocket.onerror=error=>{this.logger.debug(`WebSocket error ${JSON.stringify(error)}`)},this.awsRealTimeSocket.onclose=event=>{this.logger.debug(`WebSocket closed ${event.reason}`),reject(new Error(JSON.stringify(event)))},this.awsRealTimeSocket.onmessage=message=>{if("string"!=typeof message.data)return;this.logger.debug(`subscription message from AWS AppSyncRealTime: ${message.data} `);const data=JSON.parse(message.data),{type}=data,connectionTimeoutMs=this._extractConnectionTimeout(data);if(type===MESSAGE_TYPES.GQL_CONNECTION_ACK)return ackOk=!0,this._registerWebsocketHandlers(connectionTimeoutMs),void resolve("Connected to AWS AppSyncRealTime");if(type===MESSAGE_TYPES.GQL_CONNECTION_ERROR){const{errorType,errorCode}=this._extractErrorCodeAndType(data);reject({errorType,errorCode})}};const gqlInit={type:MESSAGE_TYPES.GQL_CONNECTION_INIT};this.awsRealTimeSocket.send(JSON.stringify(gqlInit));const checkAckOk=targetAckOk=>{targetAckOk||(this.connectionStateMonitor.record(CONNECTION_CHANGE.CONNECTION_FAILED),reject(new Error("Connection timeout: ack from AWSAppSyncRealTime was not received after 15000 ms")))};setTimeout((()=>{checkAckOk(ackOk)}),15e3)}))}_registerWebsocketHandlers(connectionTimeoutMs){this.awsRealTimeSocket&&(this.keepAliveTimeout=connectionTimeoutMs,this.awsRealTimeSocket.onmessage=this._handleIncomingSubscriptionMessage.bind(this),this.awsRealTimeSocket.onerror=err=>{this.logger.debug(err),this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED)},this.awsRealTimeSocket.onclose=event=>{this.logger.debug(`WebSocket closed ${event.reason}`),this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED)})}}class AWSAppSyncRealTimeProvider extends AWSWebSocketProvider{constructor(){super({providerName:"AWSAppSyncRealTimeProvider",wsProtocolName:"graphql-ws",connectUri:"/connect"})}getProviderName(){return"AWSAppSyncRealTimeProvider"}subscribe(options,customUserAgentDetails){return super.subscribe(options,customUserAgentDetails)}async _prepareSubscriptionPayload({options,subscriptionId,customUserAgentDetails,additionalCustomHeaders,libraryConfigHeaders}){const{appSyncGraphqlEndpoint,authenticationType,query,variables,apiKey,region}=options,data={query,variables},serializedData=JSON.stringify(data),subscriptionMessage={id:subscriptionId,payload:{data:serializedData,extensions:{authorization:{...{...await awsRealTimeHeaderBasedAuth({apiKey,appSyncGraphqlEndpoint,authenticationType,payload:serializedData,canonicalUri:"",region,additionalCustomHeaders}),...libraryConfigHeaders,...additionalCustomHeaders,[USER_AGENT_HEADER]:getAmplifyUserAgent(customUserAgentDetails)}}}},type:MESSAGE_TYPES.GQL_START};return JSON.stringify(subscriptionMessage)}_handleSubscriptionData(message){this.logger.debug(`subscription message from AWS AppSync RealTime: ${message.data}`);const{id="",payload,type}=JSON.parse(String(message.data)),{observer=null,query="",variables={}}=this.subscriptionObserverMap.get(id)||{};return this.logger.debug({id,observer,query,variables}),type===MESSAGE_TYPES.DATA&&payload&&payload.data?(observer?observer.next(payload):this.logger.debug(`observer not found for id: ${id}`),[!0,{id,type,payload}]):[!1,{id,type,payload}]}_unsubscribeMessage(subscriptionId){return{id:subscriptionId,type:MESSAGE_TYPES.GQL_STOP}}_extractConnectionTimeout(data){const{payload:{connectionTimeoutMs=DEFAULT_KEEP_ALIVE_TIMEOUT}={}}=data;return connectionTimeoutMs}_extractErrorCodeAndType(data){const{payload:{errors:[{errorType="",errorCode=0}={}]=[]}={}}=data;return{errorCode,errorType}}}class GraphQLApiError extends AmplifyError_AmplifyError{constructor(params){super(params),this.constructor=GraphQLApiError,Object.setPrototypeOf(this,GraphQLApiError.prototype)}}var APIValidationErrorCode;!function(APIValidationErrorCode){APIValidationErrorCode.NoAuthSession="NoAuthSession",APIValidationErrorCode.NoRegion="NoRegion",APIValidationErrorCode.NoCustomEndpoint="NoCustomEndpoint"}(APIValidationErrorCode||(APIValidationErrorCode={}));const errors_validation_validationErrorMap={[APIValidationErrorCode.NoAuthSession]:{message:"Auth session should not be empty."},[APIValidationErrorCode.NoRegion]:{message:"Missing region."},[APIValidationErrorCode.NoCustomEndpoint]:{message:"Custom endpoint region is present without custom endpoint."}};const resolveConfig_logger=new ConsoleLogger("GraphQLAPI resolveConfig"),resolveConfig=amplify=>{const config=amplify.getConfig();config.API?.GraphQL||resolveConfig_logger.warn("The API configuration is missing. This is likely due to Amplify.configure() not being called prior to generateClient().");const{apiKey,customEndpoint,customEndpointRegion,defaultAuthMode,endpoint,region}=config.API?.GraphQL??{};return function assertValidationError_assertValidationError(assertion,name){const{message,recoverySuggestion}=errors_validation_validationErrorMap[name];if(!assertion)throw new GraphQLApiError({name,message,recoverySuggestion})}(!(!customEndpoint&&customEndpointRegion),APIValidationErrorCode.NoCustomEndpoint),{apiKey,customEndpoint,customEndpointRegion,defaultAuthMode,endpoint,region}},resolveLibraryOptions=amplify=>{const headers=amplify.libraryOptions?.API?.GraphQL?.headers,withCredentials=amplify.libraryOptions?.API?.GraphQL?.withCredentials;return{headers,withCredentials}};function repackageUnauthorizedError(content){return content.errors&&Array.isArray(content.errors)&&content.errors.forEach((e=>{(function isUnauthorizedError(error){if(error?.originalError?.name?.startsWith("UnauthorizedException"))return!0;if(error.message?.startsWith("Connection failed:")&&error.message?.includes("Permission denied"))return!0;return!1})(e)&&(e.message="Unauthorized",e.recoverySuggestion="If you're calling an Amplify-generated API, make sure to set the \"authMode\" in generateClient({ authMode: '...' }) to the backend authorization rule's auth provider ('apiKey', 'userPool', 'iam', 'oidc', 'lambda')")})),content}const NO_API_KEY={name:"NoApiKey",message:GraphQLAuthError.NO_API_KEY,recoverySuggestion:'The API request was made with `authMode: "apiKey"` but no API Key was passed into `Amplify.configure()`. Review if your API key is passed into the `Amplify.configure()` function.'},NO_VALID_CREDENTIALS={name:"NoCredentials",message:GraphQLAuthError.NO_CREDENTIALS,recoverySuggestion:'The API request was made with `authMode: "iam"` but no authentication credentials are available.\n\nIf you intended to make a request using an authenticated role, review if your user is signed in before making the request.\n\nIf you intend to make a request using an unauthenticated role or also known as "guest access", verify if "Auth.Cognito.allowGuestAccess" is set to "true" in the `Amplify.configure()` function.'},NO_VALID_AUTH_TOKEN={name:"NoValidAuthTokens",message:GraphQLAuthError.NO_FEDERATED_JWT,recoverySuggestion:"If you intended to make an authenticated API request, review if the current user is signed in."},NO_SIGNED_IN_USER={name:"NoSignedUser",message:GraphQLAuthError.NO_CURRENT_USER,recoverySuggestion:"Review the underlying exception field for more details. If you intended to make an authenticated API request, review if the current user is signed in."},NO_AUTH_TOKEN_HEADER={name:"NoAuthorizationHeader",message:GraphQLAuthError.NO_AUTH_TOKEN,recoverySuggestion:'The API request was made with `authMode: "lambda"` but no `authToken` is set. Review if a valid authToken is passed into the request options or in the `Amplify.configure()` function.'},NO_ENDPOINT={name:"NoEndpoint",message:"No GraphQL endpoint configured in `Amplify.configure()`.",recoverySuggestion:"Review if the GraphQL API endpoint is set in the `Amplify.configure()` function."},createGraphQLResultWithError=error=>({data:{},errors:[new GraphQLError(error.message,null,null,null,null,error)]});const InternalGraphQLAPI_USER_AGENT_HEADER="x-amz-user-agent";class InternalGraphQLAPIClass{constructor(){this.appSyncRealTime=new AWSAppSyncRealTimeProvider,this._api={post:internalPost_post,cancelREST:cancel,isCancelErrorREST:isCancelError,updateRequestToBeCancellable}}getModuleName(){return"InternalGraphQLAPI"}getGraphqlOperationType(operation){const definitions=parse(operation).definitions,[{operation:operationType}]=definitions;return operationType}graphql(amplify,{query:paramQuery,variables={},authMode,authToken},additionalHeaders,customUserAgentDetails){const query=parse("string"==typeof paramQuery?paramQuery:print(paramQuery)),[operationDef={}]=query.definitions.filter((def=>"OperationDefinition"===def.kind)),{operation:operationType}=operationDef,headers=additionalHeaders||{};switch(operationType){case"query":case"mutation":{const abortController=new AbortController;let responsePromise;if((amplify=>"function"!=typeof amplify)(amplify))responsePromise=this._graphql(amplify,{query,variables,authMode},headers,abortController,customUserAgentDetails,authToken);else{responsePromise=amplify((async amplifyInstance=>await this._graphql(amplifyInstance,{query,variables,authMode},headers,abortController,customUserAgentDetails,authToken)))}return this._api.updateRequestToBeCancellable(responsePromise,abortController),responsePromise}case"subscription":return this._graphqlSubscribe(amplify,{query,variables,authMode},headers,customUserAgentDetails,authToken);default:throw new Error(`invalid operation type: ${operationType}`)}}async _graphql(amplify,{query,variables,authMode:explicitAuthMode},additionalHeaders={},abortController,customUserAgentDetails,authToken){const{apiKey,region,endpoint:appSyncGraphqlEndpoint,customEndpoint,customEndpointRegion,defaultAuthMode}=resolveConfig(amplify),initialAuthMode=explicitAuthMode||defaultAuthMode||"iam",authMode="identityPool"===initialAuthMode?"iam":initialAuthMode,{headers:customHeaders,withCredentials}=resolveLibraryOptions(amplify);let additionalCustomHeaders;if("function"==typeof additionalHeaders){const requestOptions={method:"POST",url:new amplifyUrl_AmplifyUrl(customEndpoint||appSyncGraphqlEndpoint||"").toString(),queryString:print(query)};additionalCustomHeaders=await additionalHeaders(requestOptions)}else additionalCustomHeaders=additionalHeaders;authToken&&(additionalCustomHeaders={...additionalCustomHeaders,Authorization:authToken});const authHeaders=await async function headerBasedAuth(amplify,authMode,apiKey,additionalHeaders={}){let headers={};switch(authMode){case"apiKey":if(!apiKey)throw new GraphQLApiError(NO_API_KEY);headers={"X-Api-Key":apiKey};break;case"iam":if(void 0===(await amplify.Auth.fetchAuthSession()).credentials)throw new GraphQLApiError(NO_VALID_CREDENTIALS);break;case"oidc":case"userPool":{let token;try{token=(await amplify.Auth.fetchAuthSession()).tokens?.accessToken.toString()}catch(e){throw new GraphQLApiError({...NO_SIGNED_IN_USER,underlyingError:e})}if(!token)throw new GraphQLApiError(NO_VALID_AUTH_TOKEN);headers={Authorization:token};break}case"lambda":if("object"==typeof additionalHeaders&&!additionalHeaders.Authorization)throw new GraphQLApiError(NO_AUTH_TOKEN_HEADER);headers={Authorization:additionalHeaders.Authorization}}return headers}(amplify,authMode,apiKey,additionalCustomHeaders),headers={...!customEndpoint&&authHeaders,...customEndpoint&&(customEndpointRegion?authHeaders:{})||{},...customHeaders&&await customHeaders({query:print(query),variables}),...additionalCustomHeaders,...!customEndpoint&&{[InternalGraphQLAPI_USER_AGENT_HEADER]:getAmplifyUserAgent(customUserAgentDetails)}},body={query:print(query),variables:variables||null};let signingServiceInfo;signingServiceInfo=customEndpoint&&!customEndpointRegion||"oidc"!==authMode&&"userPool"!==authMode&&"iam"!==authMode&&"lambda"!==authMode?void 0:{service:customEndpointRegion?"execute-api":"appsync",region:customEndpointRegion||region};const endpoint=customEndpoint||appSyncGraphqlEndpoint;if(!endpoint)throw createGraphQLResultWithError(new GraphQLApiError(NO_ENDPOINT));let response;try{const{body:responseBody}=await this._api.post(amplify,{url:new amplifyUrl_AmplifyUrl(endpoint),options:{headers,body,signingServiceInfo,withCredentials},abortController});response=await responseBody.json()}catch(error){if(this.isCancelError(error))throw error;response=createGraphQLResultWithError(error)}if(function isGraphQLResponseWithErrors(response){if(!response)return!1;const r=response;return Array.isArray(r.errors)&&r.errors.length>0}(response))throw repackageUnauthorizedError(response);return response}isCancelError(error){return this._api.isCancelErrorREST(error)}cancel(request,message){return this._api.cancelREST(request,message)}_graphqlSubscribe(amplify,{query,variables,authMode:explicitAuthMode},additionalHeaders={},customUserAgentDetails,authToken){const config=resolveConfig(amplify),initialAuthMode=explicitAuthMode||config?.defaultAuthMode||"iam",authMode="identityPool"===initialAuthMode?"iam":initialAuthMode,{headers:libraryConfigHeaders}=resolveLibraryOptions(amplify);return this.appSyncRealTime.subscribe({query:print(query),variables,appSyncGraphqlEndpoint:config?.endpoint,region:config?.region,authenticationType:authMode,apiKey:config?.apiKey,additionalHeaders,authToken,libraryConfigHeaders},customUserAgentDetails).pipe(catchError((e=>{if(e.errors)throw repackageUnauthorizedError(e);throw e})))}}new InternalGraphQLAPIClass;const GraphQLAPI=new class GraphQLAPIClass extends InternalGraphQLAPIClass{getModuleName(){return"GraphQLAPI"}graphql(amplify,options,additionalHeaders){const userAgentDetails={category:Category.API,action:ApiAction.GraphQl};if(function isGraphQLOptionsWithOverride(options){return INTERNAL_USER_AGENT_OVERRIDE in options}(options)){const{[INTERNAL_USER_AGENT_OVERRIDE]:internalUserAgentOverride,...cleanOptions}=options;return super.graphql(amplify,cleanOptions,additionalHeaders,{...userAgentDetails,...internalUserAgentOverride})}return super.graphql(amplify,options,additionalHeaders,{...userAgentDetails})}isCancelError(error){return super.isCancelError(error)}cancel(request,message){return super.cancel(request,message)}};function graphql(options,additionalHeaders){const internals=getInternals(this);options.authMode=options.authMode||internals.authMode,options.authToken=options.authToken||internals.authToken;const headers=additionalHeaders||internals.headers;return GraphQLAPI.graphql(internals.amplify,options,headers)}function v6_cancel(promise,message){return GraphQLAPI.cancel(promise,message)}function v6_isCancelError(error){return GraphQLAPI.isCancelError(error)}const generateModelsPropertyOnAmplifyConfigure=clientRef=>{Hub.listen("core",(coreEvent=>{if(!function isConfigureEventWithResourceConfig(payload){return"configure"===payload.event}(coreEvent.payload))return;const apiGraphQLConfig=coreEvent.payload.data.API?.GraphQL;isApiGraphQLProviderConfig_isApiGraphQLConfig(apiGraphQLConfig)&&addSchemaToClient(clientRef,apiGraphQLConfig,getInternals)}))},emptyProperty=new Proxy({},{get(){throw new Error("Client could not be generated. This is likely due to `Amplify.configure()` not being called prior to `generateClient()` or because the configuration passed to `Amplify.configure()` is missing GraphQL provider configuration.")}});function API_generateClient(options={}){return function generateClient(params){const client={[__amplify]:params.amplify,[__authMode]:params.authMode,[__authToken]:params.authToken,[__headers]:params.headers,graphql,cancel:v6_cancel,isCancelError:v6_isCancelError,models:emptyProperty,enums:emptyProperty,queries:emptyProperty,mutations:emptyProperty,subscriptions:emptyProperty},apiGraphqlConfig=params.amplify.getConfig().API?.GraphQL;return isApiGraphQLProviderConfig_isApiGraphQLConfig(apiGraphqlConfig)?addSchemaToClient(client,apiGraphqlConfig,getInternals):generateModelsPropertyOnAmplifyConfigure(client),client}({...options,amplify:Amplify_Amplify})}}}]);